<!-- markdownlint-disable MD033 MD003 MD053 -->
<!-- cspell:ignore devkit zcvf zxvf noded secondfile filesize sedemo eudemo webmail csum eascp loglevel cronfile magick keepalive inotify eastus bluemix trev sshfp struct genkey passout ibmaspera unpermitted schtasks taskschd dascli -->
<h1 data-number="1" id="introduction"><span
class="header-section-number">1</span> Introduction</h1>
<p>Version : 4.15.0.pre</p>
<p>Laurent/2016-2023</p>
<p>This gem provides the <code>ascli</code> CLI (Command Line Interface)
to IBM Aspera software.</p>
<p><code>ascli</code> is a also great tool to learn Aspera APIs.</p>
<p>Ruby Gem: <a
href="https://rubygems.org/gems/aspera-cli">https://rubygems.org/gems/aspera-cli</a></p>
<p>Ruby Doc: <a
href="https://www.rubydoc.info/gems/aspera-cli">https://www.rubydoc.info/gems/aspera-cli</a></p>
<p>Minimum required Ruby version: &gt;= 2.6.</p>
<blockquote>
<p><strong>Deprecation notice</strong>: the minimum Ruby version will be
3.0 in a future version.</p>
</blockquote>
<p><a
href="https://developer.ibm.com/?size=30&amp;q=aspera&amp;DWContentType%5B0%5D=APIs&amp;sort=title_asc">Aspera
APIs on IBM developer</a> <a
href="https://developer.ibm.com/apis/catalog/?search=aspera">Link
2</a></p>
<p>Release notes: see <a href="CHANGELOG.md">CHANGELOG.md</a></p>
<p><a
href="https://bestpractices.coreinfrastructure.org/projects/5861"><img
src="https://bestpractices.coreinfrastructure.org/projects/5861/badge"
alt="CII Best Practices" /></a></p>
<p>A PDF version of this documentation is available here: <a
href="docs/Manual.pdf">docs/Manual.pdf</a>.</p>
<h2 data-number="1.1" id="bugs-features-contribution"><span
class="header-section-number">1.1</span> BUGS, FEATURES,
CONTRIBUTION</h2>
<p>Refer to <a href="BUGS.md">BUGS.md</a> and <a
href="CONTRIBUTING.md">CONTRIBUTING.md</a>.</p>
<p>One can also <a href="#createownplugin">create one’s own
plugin</a>.</p>
<h2 data-number="1.2" id="when-to-use-and-when-not-to-use"><span
class="header-section-number">1.2</span> <a id="when_to_use"></a>When to
use and when not to use</h2>
<p><code>ascli</code> is designed to be used as a command line tool
to:</p>
<ul>
<li>Execute commands remotely on Aspera products</li>
<li>Transfer to/from Aspera products</li>
</ul>
<p>So it is designed for:</p>
<ul>
<li>Interactive operations on a text terminal (typically, VT100
compatible), e.g. for maintenance</li>
<li>Scripting, e.g. batch operations in (shell) scripts (e.g. cron
job)</li>
</ul>
<p><code>ascli</code> can be seen as a command line tool
integrating:</p>
<ul>
<li>A configuration file (config.yaml)</li>
<li>Advanced command line options</li>
<li>cURL (for REST calls)</li>
<li>Aspera transfer (<code>ascp</code>)</li>
</ul>
<p>If the need is to perform operations programmatically in languages
such as: C, Go, Python, nodejs, … then it is better to directly use <a
href="https://ibm.biz/aspera_api">Aspera APIs</a></p>
<ul>
<li>Product APIs (REST) : e.g. AoC, Faspex, node</li>
<li>Transfer SDK : with gRPC interface and language stubs (C, C++,
Python, .NET/C#, java, Ruby, etc…)</li>
</ul>
<p>Using APIs (application REST API and transfer SDK) will prove to be
easier to develop and maintain.</p>
<p>For scripting and ad’hoc command line operations, <code>ascli</code>
is perfect.</p>
<h2 data-number="1.3" id="notations-shell-examples"><span
class="header-section-number">1.3</span> Notations, Shell, Examples</h2>
<p>Command line operations examples are shown using a shell such:
<code>bash</code> or <code>zsh</code>.</p>
<p>Command line parameters in examples beginning with <code>my_</code>,
like <code>my_param_value</code> are user-provided value and not fixed
value commands.</p>
<p><code>ascli</code> is an API <strong>Client</strong> toward the
remote Aspera application <strong>Server</strong> (Faspex, HSTS,
etc…)</p>
<p>Some commands will start an Aspera-based transfer
(e.g. <code>upload</code>). The transfer is not directly implemented in
<code>ascli</code>, rather <code>ascli</code> uses an external Aspera
Client called <strong><a href="#agents">Transfer
Agents</a></strong>.</p>
<blockquote>
<p><strong>Note:</strong> The transfer agent is a client for the remote
Transfer Server (HSTS). The transfer agent may be local or remote… For
example a remote Aspera Server may be used as a transfer agent (using
node API). i.e. using option <code>--transfer=node</code></p>
</blockquote>
<h1 data-number="2" id="quick-start"><span
class="header-section-number">2</span> Quick Start</h1>
<p>This section guides you from installation, first use and advanced
use.</p>
<p>First, follow the section: <a href="#installation">Installation</a>
(Ruby, Gem, FASP) to start using <code>ascli</code>.</p>
<p>Once the gem is installed, <code>ascli</code> shall be
accessible:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">--version</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">4.15.0.pre</span></span></code></pre></div>
<h2 data-number="2.1" id="first-use"><span
class="header-section-number">2.1</span> First use</h2>
<p>Once installation is completed, you can proceed to the first use with
a demo server:</p>
<p>If you want to test with Aspera on Cloud, jump to section: <a
href="#aocwizard">Wizard</a></p>
<p>To test with Aspera demo transfer server, setup the environment and
then test:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config initdemo</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server browse /</span></code></pre></div>
<pre class="output"><code>+------------+--------+-----------+-------+---------------------------+-----------------------+
| zmode      | zuid   | zgid      | size  | mtime                     | name                  |
+------------+--------+-----------+-------+---------------------------+-----------------------+
| drwxr-xr-x | aspera | asperaweb | 90112 | 2023-04-05 15:31:21 +0200 | Upload                |
| dr-xr-xr-x | aspera | asperaweb | 4096  | 2022-10-27 16:08:16 +0200 | aspera-test-dir-large |
| dr-xr-xr-x | aspera | asperaweb | 4096  | 2022-10-27 16:08:17 +0200 | aspera-test-dir-small |
| dr-xr-xr-x | aspera | asperaweb | 4096  | 2022-10-27 16:08:17 +0200 | aspera-test-dir-tiny  |
+------------+--------+-----------+-------+---------------------------+-----------------------+</code></pre>
<p>If you want to use <code>ascli</code> with another server, and in
order to make further calls more convenient, it is advised to define a
<a href="#lprt">option preset</a> for the server’s authentication
options. The following example will:</p>
<ul>
<li>create a <a href="#lprt">option preset</a></li>
<li>define it as default for <code>server</code> plugin</li>
<li>list files in a folder</li>
<li>download a file</li>
</ul>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update myserver <span class="at">--url</span><span class="op">=</span>ssh://demo.asperasoft.com:33001 <span class="at">--username</span><span class="op">=</span>asperaweb <span class="at">--password</span><span class="op">=</span>my_password_here</span></code></pre></div>
<pre class="output"><code>updated: myserver</code></pre>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default server myserver</span></code></pre></div>
<pre class="output"><code>updated: default &amp;rarr; server to myserver</code></pre>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server browse /aspera-test-dir-large</span></code></pre></div>
<pre class="output"><code>+------------+-----------+-----------+--------------+---------------------------+-------+
| zmode      | zuid      | zgid      | size         | mtime                     | name  |
+------------+-----------+-----------+--------------+---------------------------+-------+
| -r-xr-x--- | asperaweb | asperaweb | 104857600    | 2022-10-27 16:06:38 +0200 | 100MB |
| -r-xr-x--- | asperaweb | asperaweb | 10737418240  | 2022-10-27 16:08:12 +0200 | 10GB  |
| -r-xr-x--- | asperaweb | asperaweb | 500000000000 | 2022-10-27 16:06:26 +0200 | 500GB |
| -r-xr-x--- | asperaweb | asperaweb | 524288000    | 2022-10-27 14:53:00 +0200 | 500MB |
| -r-xr-x--- | asperaweb | asperaweb | 1048576000   | 2022-10-27 16:06:37 +0200 | 1GB   |
| -r-xr-x--- | asperaweb | asperaweb | 5368709120   | 2022-10-27 14:53:47 +0200 | 5GB   |
| -r-xr-x--- | asperaweb | asperaweb | 209715200    | 2022-10-27 14:52:56 +0200 | 200MB |
+------------+-----------+-----------+--------------+---------------------------+-------+</code></pre>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server download /aspera-test-dir-large/200MB</span></code></pre></div>
<pre class="output"><code>Time: 00:00:02 ============================================= 100% 100 Mbps Time: 00:00:00
complete</code></pre>
<h2 data-number="2.2" id="going-further"><span
class="header-section-number">2.2</span> Going further</h2>
<p>Get familiar with configuration, options, commands : <a
href="#cli">Command Line Interface</a>.</p>
<p>Then, follow the section relative to the product you want to interact
with ( Aspera on Cloud, Faspex, …) : <a href="plugins">Application
Plugins</a></p>
<h1 data-number="3" id="installation"><span
class="header-section-number">3</span>
<a id="installation"></a>Installation</h1>
<p>It is possible to install <strong>either</strong> directly on the
host operating system (Linux, macOS, Windows) or as a container
(<code>docker</code>).</p>
<p>The direct installation is recommended and consists in
installing:</p>
<ul>
<li><a href="#ruby">Ruby</a></li>
<li><a href="#the_gem">aspera-cli</a></li>
<li><a href="#fasp_prot">Aspera SDK (<code>ascp</code>)</a></li>
</ul>
<p>Ruby version: &gt;= 2.6.</p>
<blockquote>
<p><strong>Deprecation notice</strong>: the minimum Ruby version will be
3.0 in a future version.</p>
</blockquote>
<p>The following sections provide information on the various
installation methods.</p>
<p>An internet connection is required for the installation. If you don’t
have internet for the installation, refer to section <a
href="#offline_install">Installation without internet access</a>.</p>
<h2 data-number="3.1" id="container"><span
class="header-section-number">3.1</span> Container</h2>
<p>The container image is: <a
href="https://hub.docker.com/r/martinlaurent/ascli">martinlaurent/ascli</a>.
The container contains: Ruby, <code>ascli</code> and the Aspera Transfer
SDK. To use the container, ensure that you have <code>podman</code> (or
<code>docker</code>) installed.</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">podman</span> <span class="at">--version</span></span></code></pre></div>
<h3 data-number="3.1.1" id="container-quick-start"><span
class="header-section-number">3.1.1</span> Container: quick start</h3>
<p><strong>Wanna start quickly ?</strong> With an interactive shell ?
Execute this:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">podman</span> run <span class="at">--tty</span> <span class="at">--interactive</span> <span class="at">--entrypoint</span> bash martinlaurent/ascli:latest</span></code></pre></div>
<p>Then, execute individual <code>ascli</code> commands such as:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf init</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset overview</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf ascp info</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server ls /</span></code></pre></div>
<p>That is simple, but there are limitations:</p>
<ul>
<li>Everything happens in the container</li>
<li>Any generated file in the container will be lost on container
(shell) exit. Including configuration files and downloaded files.</li>
<li>No possibility to upload files located on the host system</li>
</ul>
<h3 data-number="3.1.2" id="container-details"><span
class="header-section-number">3.1.2</span> Container: Details</h3>
<p>The container image is built from this <a
href="Dockerfile.tmpl.erb">Dockerfile</a>: the entry point is
<code>ascli</code> and the default command is <code>help</code>.</p>
<p>If you want to run the image with a shell, execute with option:
<code>--entrypoint bash</code>, and give argument <code>-l</code>
(<code>bash</code> login option to override the <code>help</code>
default argument)</p>
<p>The container can also be executed for individual commands like this:
(add <code>ascli</code> commands and options at the end of the command
line, e.g. <code>-v</code> to display the version)</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">podman</span> run <span class="at">--rm</span> <span class="at">--tty</span> <span class="at">--interactive</span> martinlaurent/ascli:latest</span></code></pre></div>
<p>For more convenience, you may define a shell alias:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> ascli=<span class="st">&#39;podman run --rm --tty --interactive martinlaurent/ascli:latest&#39;</span></span></code></pre></div>
<p>Then, you can execute the container like a local command:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">-v</span></span></code></pre></div>
<pre class="text"><code>4.15.0.pre</code></pre>
<p>In order to keep persistency of configuration on the host, you should
specify your user’s config folder as a volume for the container. To
enable write access, a possibility is to run as <code>root</code> in the
container (and set the default configuration folder to
<code>/home/cliuser/.aspera/ascli</code>). Add options:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--user</span> root <span class="at">--env</span> ASCLI_HOME=/home/cliuser/.aspera/ascli <span class="at">--volume</span> <span class="va">$HOME</span>/.aspera/ascli:/home/cliuser/.aspera/ascli</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> if you are using a
<code>podman machine</code>, e.g. on macOS , make sure that the folder
is also shared between the VM and the host, so that sharing is:
container → VM → Host:
<code>podman machine init ... --volume="/Users:/Users"</code></p>
</blockquote>
<p>As shown in the quick start, if you prefer to keep a running
container with a shell and <code>ascli</code> available, you can change
the entry point, add option:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--entrypoint</span> bash</span></code></pre></div>
<p>You may also probably want that files downloaded in the container are
directed to the host. In this case you need also to specify the shared
transfer folder as a volume:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--volume</span> <span class="va">$HOME</span>/xferdir:/xferfiles</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> ascli is run inside the container, so
transfers are also executed inside the container and do not have access
to host storage by default.</p>
</blockquote>
<p>And if you want all the above, simply use all the options:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> asclish=<span class="st">&quot;podman run --rm --tty --interactive --user root --env ASCLI_HOME=/home/cliuser/.aspera/ascli --volume </span><span class="va">$HOME</span><span class="st">/.aspera/ascli:/home/cliuser/.aspera/ascli --volume </span><span class="va">$HOME</span><span class="st">/xferdir:/xferfiles --entrypoint bash martinlaurent/ascli:latest&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">xferdir</span><span class="op">=</span><span class="va">$HOME</span>/xferdir</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$xferdir</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> <span class="at">-R</span> 777 <span class="va">$xferdir</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$HOME</span>/.aspera/ascli</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="ex">asclish</span></span></code></pre></div>
<h3 data-number="3.1.3" id="container-sample-start-script"><span
class="header-section-number">3.1.3</span> Container: Sample start
script</h3>
<p>A convenience sample script is also provided: download the script <a
href="../examples/dascli"><code>dascli</code></a> from <a
href="https://raw.githubusercontent.com/IBM/aspera-cli/main/examples/dascli">the
GIT repo</a> :</p>
<blockquote>
<p><strong>Note:</strong> If you have installed <code>ascli</code>, the
script <code>dascli</code> can also be found:
<code>cp $(ascli conf gem path)/../examples/dascli ascli</code></p>
</blockquote>
<p>Some environment variables can be set for this script to adapt its
behavior:</p>
<table>
<colgroup>
<col style="width: 13%" />
<col style="width: 35%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>env var</th>
<th>description</th>
<th>default</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ASCLI_HOME</td>
<td>configuration folder (persistency)</td>
<td><code>$HOME/.aspera/ascli</code></td>
<td><code>$HOME/.ascli_config</code></td>
</tr>
<tr class="even">
<td>docker_args</td>
<td>additional options to <code>podman</code></td>
<td>&lt;empty&gt;</td>
<td><code>--volume /Users:/Users</code></td>
</tr>
<tr class="odd">
<td>image</td>
<td>container image name</td>
<td>martinlaurent/ascli</td>
<td></td>
</tr>
<tr class="even">
<td>version</td>
<td>container image version</td>
<td>latest</td>
<td><code>4.8.0.pre</code></td>
</tr>
</tbody>
</table>
<p>The wrapping script maps the folder <code>$ASCLI_HOME</code> on host
to <code>/home/cliuser/.aspera/ascli</code> in the container. (value
expected in the container). This allows having persistent configuration
on the host.</p>
<p>To add local storage as a volume, you can use the env var
<code>docker_args</code>:</p>
<p>Example of use:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-o</span> ascli https://raw.githubusercontent.com/IBM/aspera-cli/main/examples/dascli</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> a+x ascli</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">xferdir</span><span class="op">=</span><span class="va">$HOME</span>/xferdir</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$xferdir</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> <span class="at">-R</span> 777 <span class="va">$xferdir</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">docker_args</span><span class="op">=</span><span class="st">&quot;--volume </span><span class="va">$xferdir</span><span class="st">:/xferfiles&quot;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="ex">./ascli</span> conf init</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;Local file to transfer&#39;</span> <span class="op">&gt;</span> <span class="va">$xferdir</span>/samplefile.txt</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="ex">./ascli</span> server upload /xferfiles/samplefile.txt <span class="at">--to-folder</span><span class="op">=</span>/Upload</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> The local file (<code>samplefile.txt</code>)
is specified relative to storage view from container
(<code>/xferfiles</code>) mapped to the host folder
<code>$HOME/xferdir</code></p>
<p><strong>Note:</strong> Do not use too many volumes, as the AUFS
limits the number.</p>
</blockquote>
<h3 data-number="3.1.4" id="container-offline-installation"><span
class="header-section-number">3.1.4</span> Container: Offline
installation</h3>
<ul>
<li>First create the image archive:</li>
</ul>
<div class="sourceCode" id="cb27"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="ex">podman</span> pull martinlaurent/ascli</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="ex">podman</span> save martinlaurent/ascli<span class="kw">|</span><span class="fu">gzip</span><span class="op">&gt;</span>ascli_image_latest.tar.gz</span></code></pre></div>
<ul>
<li>Then, on air-gapped system:</li>
</ul>
<div class="sourceCode" id="cb28"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">podman</span> load <span class="at">-i</span> ascli_image_latest.tar.gz</span></code></pre></div>
<h3 data-number="3.1.5" id="container-aspera.conf"><span
class="header-section-number">3.1.5</span> Container:
<code>aspera.conf</code></h3>
<p><code>ascp</code>’s configuration file <code>aspera.conf</code> is
located in the container at: <code>/aspera_sdk/aspera.conf</code> (see
Dockerfile). As the container is immutable, it is not recommended to
modify this file. If one wants to change the content, it is possible to
tell <code>ascp</code> to use another file using <code>ascp</code>
option <code>-f</code>, e.g. by locating it on the host folder
<code>$HOME/.aspera/ascli</code> mapped to the container folder
<code>/home/cliuser/.aspera/ascli</code>:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&#39;&lt;CONF/&gt;&#39;</span> <span class="op">&gt;</span> <span class="va">$HOME</span>/.aspera/ascli/aspera.conf</span></code></pre></div>
<p>Then, tell <code>ascp</code> to use that other configuration
file:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--transfer-info=@json:</span><span class="st">&#39;{&quot;ascp_args&quot;:[&quot;-f&quot;,&quot;/home/cliuser/.aspera/ascli/aspera.conf&quot;]}&#39;</span></span></code></pre></div>
<h3 data-number="3.1.6" id="container-singularity"><span
class="header-section-number">3.1.6</span> Container: Singularity</h3>
<p>Singularity is another type of use of container.</p>
<p>On Linux install:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> install singularity-ce</span></code></pre></div>
<p>Build an image like this:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> build ascli.sif docker://martinlaurent/ascli</span></code></pre></div>
<p>The use like this:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> run ascli.sif</span></code></pre></div>
<p>Or get a shell with access to <code>ascli</code> like this:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="ex">singularity</span> shell ascli.sif</span></code></pre></div>
<h2 data-number="3.2" id="ruby"><span
class="header-section-number">3.2</span> <a id="ruby"></a>Ruby</h2>
<p>Use this method to install on the native host.</p>
<p>A Ruby interpreter is required to run <code>ascli</code> or to use
the gem and tool.</p>
<p>Required Ruby version: &gt;= 2.6.</p>
<blockquote>
<p><strong>Deprecation notice</strong>: the minimum Ruby version will be
3.0 in a future version.</p>
</blockquote>
<p><strong>Ruby can be installed using any method</strong> : rpm, yum,
dnf, rvm, brew, Windows installer, … .</p>
<p>In priority, refer to the official Ruby documentation:</p>
<ul>
<li><a href="https://www.ruby-lang.org/en/downloads/">Download
Ruby</a></li>
<li><a
href="https://www.ruby-lang.org/en/documentation/installation/">Installation
Guide</a></li>
</ul>
<p>Else, refer to the following sections for a proposed method for
specific operating systems.</p>
<p>The recommended installation method is <code>rvm</code> for Unix-like
systems (Linux, AIX, macOS, Windows with cygwin, etc…). If the generic
install is not suitable (e.g. Windows, no cygwin), you can use one of
OS-specific install method. If you have a simpler better way to install
Ruby : use it !</p>
<h3 data-number="3.2.1"
id="generic-rvm-single-user-installation-not-root"><span
class="header-section-number">3.2.1</span> Generic: RVM: single user
installation (not root)</h3>
<p>Use this method which provides more flexibility.</p>
<p>Install <code>rvm</code>: follow <a
href="https://rvm.io/">https://rvm.io/</a> :</p>
<p>Execute the shell/curl command. As regular user, it install in the
user’s home: <code>~/.rvm</code> .</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="ex">\curl</span> <span class="at">-sSL</span> https://get.rvm.io <span class="kw">|</span> <span class="fu">bash</span> <span class="at">-s</span> stable</span></code></pre></div>
<p>Follow on-screen instructions to install keys, and then re-execute
the command.</p>
<p>If you keep the same terminal (not needed if re-login):</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.rvm/scripts/rvm</span></code></pre></div>
<p>It is advised to get one of the pre-compiled Ruby version, you can
list with:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="ex">rvm</span> list <span class="at">--remote</span></span></code></pre></div>
<p>Install the chosen pre-compiled Ruby version:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">rvm</span> install 3.2.2</span></code></pre></div>
<p>Ruby is now installed for the user, go to <a href="#the_gem">Gem
installation</a>.</p>
<h3 data-number="3.2.2"
id="generic-rvm-global-installation-as-root"><span
class="header-section-number">3.2.2</span> Generic: RVM: global
installation (as root)</h3>
<p>Follow the same method as single user install, but execute as
“root”.</p>
<p>As root, it installs by default in /usr/local/rvm for all users and
creates <code>/etc/profile.d/rvm.sh</code>. One can install in another
location with :</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-sSL</span> https://get.rvm.io <span class="kw">|</span> <span class="fu">bash</span> <span class="at">-s</span> <span class="at">--</span> <span class="at">--path</span> /usr/local</span></code></pre></div>
<p>As root, make sure this will not collide with other application using
Ruby (e.g. Faspex). If so, one can rename the login script:
<code>mv /etc/profile.d/rvm.sh /etc/profile.d/rvm.sh.ok</code>. To
activate Ruby (and ascli) later, source it:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> /etc/profile.d/rvm.sh.ok</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="ex">rvm</span> version</span></code></pre></div>
<h3 data-number="3.2.3" id="windows-installer"><span
class="header-section-number">3.2.3</span> Windows: Installer</h3>
<p>Manual installation:</p>
<ul>
<li>Navigate to <a
href="https://rubyinstaller.org/">https://rubyinstaller.org/</a> →
<strong>Downloads</strong>.</li>
<li>Download the latest Ruby installer <strong>with devkit</strong>.
(Msys2 is needed to install some native extensions, such as
<code>grpc</code>)</li>
<li>Execute the installer which installs by default in:
<code>C:\RubyVV-x64</code> (VV is the version number)</li>
<li>At the end of the installation procedure, the Msys2 installer is
automatically executed, select option 3 (msys and mingw)</li>
<li>then install the aspera-cli gem and Aspera SDK (see next
sections)</li>
</ul>
<p>Automated installation, with internet access:</p>
<p>The ruby installer supports silent installation, to see the options,
execute it with <code>/help</code>, or refer to the <a
href="https://github.com/oneclick/rubyinstaller2/wiki/FAQ">Ruby
Installer FAQ</a></p>
<p>Download the <code>exe</code> ruby installer from <a
href="https://rubyinstaller.org/downloads/"
class="uri">https://rubyinstaller.org/downloads/</a> and then
install:</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>rubyinstaller-devkit-3.2.2-1-x64.exe <span class="at">/silent</span> <span class="at">/currentuser</span> <span class="at">/noicons</span> <span class="at">/dir</span>=C:\aspera-cli</span></code></pre></div>
<p>Installation without network:</p>
<p>It is essentially the same procedure, but instead of retrieving files
from internet, one copies the files from a machine with internet access,
and then install from those archives:</p>
<ul>
<li><p>Download the <code>exe</code> ruby installer from <a
href="https://rubyinstaller.org/downloads/"
class="uri">https://rubyinstaller.org/downloads/</a></p></li>
<li><p>Create an archive with necessary gems: <a
href="https://help.rubygems.org/kb/rubygems/installing-gems-with-no-network"
class="uri">https://help.rubygems.org/kb/rubygems/installing-gems-with-no-network</a></p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gem install aspera<span class="at">-cli</span> <span class="at">-N</span> <span class="at">-i</span> my_gems</span></code></pre></div>
<p>Zip the files <code>*.gem</code> from folder
<code>repo/my_gems</code></p></li>
<li><p>Download the SDK from: <a href="https://ibm.biz/aspera_sdk"
class="uri">https://ibm.biz/aspera_sdk</a></p></li>
</ul>
<p>Create a Zip with all those files, and transfer to the target
system.</p>
<p>Then, on the target system:</p>
<ul>
<li>Unzip the archive</li>
<li>Execute the installer:</li>
</ul>
<div class="sourceCode" id="cb44"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>rubyinstaller-devkit-3.2.2-1-x64.exe <span class="at">/silent</span> <span class="at">/currentuser</span> <span class="at">/noicons</span> <span class="at">/dir</span>=C:\aspera-cli</span></code></pre></div>
<ul>
<li>Install the gems:</li>
</ul>
<div class="sourceCode" id="cb45"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>gem install -<span class="at">-force</span> -<span class="at">-local</span> *.gem</span></code></pre></div>
<ul>
<li>install the SDK</li>
</ul>
<div class="sourceCode" id="cb46"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf ascp install <span class="at">--sdk-url</span><span class="op">=</span>file:///sdk.zip</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> An example of installation script is provided:
<a href="docs/install.bat">docs/install.bat</a></p>
</blockquote>
<h3 data-number="3.2.4" id="macos-pre-installed-or-brew"><span
class="header-section-number">3.2.4</span> macOS: pre-installed or
<code>brew</code></h3>
<p>macOS 10.13+ (High Sierra) comes with a recent Ruby. So you can use
it directly. You will need to install aspera-cli using <code>sudo</code>
:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> gem install aspera-cli <span class="at">--pre</span></span></code></pre></div>
<p>Alternatively, if you use <a href="https://brew.sh/">Homebrew</a>
already you can install Ruby with it:</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install ruby</span></code></pre></div>
<h3 data-number="3.2.5" id="linux-package"><span
class="header-section-number">3.2.5</span> Linux: package</h3>
<p>If your Linux distribution provides a standard Ruby package, you can
use it provided that the version supported.</p>
<p><strong>Example:</strong> RHEL 8+, Rocky Linux 8+, Centos 8 Stream:
with extensions to compile native gems</p>
<ul>
<li><p>Check available ruby versions:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> module list ruby</span></code></pre></div></li>
<li><p>If ruby was already installed with an older version, remove
it:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> module <span class="at">-y</span> reset ruby</span></code></pre></div></li>
<li><p>Install packages needed to build native gems:</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> install <span class="at">-y</span> make automake gcc gcc-c++ kernel-devel</span></code></pre></div></li>
<li><p>Enable the Ruby version you want:</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> module <span class="at">-y</span> enable ruby:3.1</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> install <span class="at">-y</span> ruby-devel</span></code></pre></div></li>
</ul>
<p><strong>Other examples:</strong></p>
<div class="sourceCode" id="cb53"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="ex">yum</span> install <span class="at">-y</span> ruby ruby-devel rubygems ruby-json</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="ex">apt</span> install <span class="at">-y</span> ruby ruby-dev rubygems ruby-json</span></code></pre></div>
<p>One can cleanup the whole yum-installed Ruby environment like this to
uninstall:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gem</span> uninstall <span class="at">-axI</span> <span class="va">$(</span><span class="fu">ls</span> <span class="va">$(</span><span class="ex">gem</span> env gemdir<span class="va">)</span>/gems/<span class="kw">|</span><span class="fu">sed</span> <span class="at">-e</span> <span class="st">&#39;s/-[^-]*$//&#39;</span><span class="kw">|</span><span class="fu">sort</span> <span class="at">-u</span><span class="va">)</span></span></code></pre></div>
<h3 data-number="3.2.6" id="other-unixes-aix"><span
class="header-section-number">3.2.6</span> Other Unixes (AIX)</h3>
<p>Ruby is sometimes made available as installable package through third
party providers. For example for AIX, one can look at:</p>
<p><a
href="https://www.ibm.com/support/pages/aix-toolbox-open-source-software-downloads-alpha#R"
class="uri">https://www.ibm.com/support/pages/aix-toolbox-open-source-software-downloads-alpha#R</a></p>
<p>If your Unix does not provide a pre-built Ruby, you can get it using
one of those <a
href="https://www.ruby-lang.org/en/documentation/installation/">methods</a>.</p>
<p>For instance to build from source, and install in
<code>/opt/ruby</code> :</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.2.tar.gz</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gzip</span> <span class="at">-d</span> ruby-2.7.2.tar.gz</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> xvf ruby-2.7.2.tar</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ruby-2.7.2</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="ex">./configure</span> <span class="at">--prefix</span><span class="op">=</span>/opt/ruby</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> ruby.imp</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="fu">make</span> install</span></code></pre></div>
<p>If you already have a Java JVM on your system (<code>java</code>), it
is possible to use <code>jruby</code>:</p>
<p><a href="https://www.jruby.org/download"
class="uri">https://www.jruby.org/download</a></p>
<blockquote>
<p><strong>Note:</strong> Using <code>jruby</code>, the startup time is
longer than the native Ruby, but transfer speed is not impacted
(executed by <code>ascp</code> binary).</p>
</blockquote>
<h2 data-number="3.3" id="aspera-cli-gem"><span
class="header-section-number">3.3</span>
<a id="the_gem"></a><code>aspera-cli</code> gem</h2>
<p>Once you have Ruby and rights to install gems: Install the gem and
its dependencies:</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gem</span> install aspera-cli <span class="at">--pre</span></span></code></pre></div>
<p>To upgrade to the latest version:</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gem</span> update aspera-cli</span></code></pre></div>
<p><code>ascli</code> checks every week if a new version is available
and notify the user in a WARN log. To de-activate this feature, globally
set the option <code>version_check_days</code> to <code>0</code>, or
specify a different period in days.</p>
<p>To check if a new version is available (independently of
<code>version_check_days</code>):</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf check_update</span></code></pre></div>
<h2 data-number="3.4" id="fasp-protocol"><span
class="header-section-number">3.4</span> <a id="fasp_prot"></a>FASP
Protocol</h2>
<p>Most file transfers will be done using the FASP protocol, using
<code>ascp</code>. Only two additional files are required to perform an
Aspera Transfer, which are part of Aspera SDK:</p>
<ul>
<li><code>ascp</code></li>
<li>aspera-license (in same folder, or ../etc)</li>
</ul>
<p>This can be installed either be installing an Aspera transfer
software, or using an embedded command:</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf ascp install</span></code></pre></div>
<p>If a local SDK installation is preferred instead of fetching from
internet: one can specify the location of the SDK file:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-Lso</span> sdk.zip https://ibm.biz/aspera_sdk</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf ascp install <span class="at">--sdk-url</span><span class="op">=</span>file:///sdk.zip</span></code></pre></div>
<p>The format is: <code>file:///&lt;path&gt;</code>, where
<code>&lt;path&gt;</code> can be either a relative path (not starting
with <code>/</code>), or an absolute path.</p>
<p>If the embedded method is not used, the following packages are also
suitable:</p>
<ul>
<li>IBM Aspera Connect Client (Free)</li>
<li>IBM Aspera Desktop Client (Free)</li>
<li>IBM Aspera High Speed Transfer Server (Licensed)</li>
<li>IBM Aspera High Speed Transfer EndPoint (Licensed)</li>
</ul>
<p>For instance, Aspera Connect Client can be installed by visiting the
page: <a
href="https://www.ibm.com/aspera/connect/">https://www.ibm.com/aspera/connect/</a>.</p>
<p><code>ascli</code> will detect most of Aspera transfer products in
standard locations and use the first one found. Refer to section <a
href="#client">FASP</a> for details on how to select a client or set
path to the FASP protocol.</p>
<p>Several methods are provided to start a transfer. Use of a local
client (<a href="#agt_direct"><code>direct</code></a> transfer agent) is
one of them, but other methods are available. Refer to section: <a
href="#agents">Transfer Agents</a></p>
<h2 data-number="3.5" id="installation-in-air-gapped-environment"><span
class="header-section-number">3.5</span>
<a id="offline_install"></a>Installation in air gapped environment</h2>
<blockquote>
<p><strong>Note:</strong> no pre-packaged version is provided.</p>
</blockquote>
<p>A method to build one is provided here:</p>
<p>The procedure:</p>
<ul>
<li>Follow the non-root installation procedure with RVM, including
gem</li>
<li>Archive (zip, tar) the main RVM folder (includes ascli):</li>
</ul>
<div class="sourceCode" id="cb63"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="va">$HOME</span> <span class="kw">&amp;&amp;</span> <span class="fu">tar</span> zcvf rvm-ascli.tgz .rvm</span></code></pre></div>
<ul>
<li>Get the Aspera SDK.</li>
</ul>
<div class="sourceCode" id="cb64"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf <span class="at">--show-config</span> <span class="at">--fields</span><span class="op">=</span>sdk_url</span></code></pre></div>
<ul>
<li>Download the SDK archive from that URL.</li>
</ul>
<div class="sourceCode" id="cb65"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-Lso</span> sdk.zip https://ibm.biz/aspera_sdk</span></code></pre></div>
<ul>
<li><p>Transfer those 2 files to the target system</p></li>
<li><p>On target system</p></li>
</ul>
<div class="sourceCode" id="cb66"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> <span class="va">$HOME</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> zxvf rvm-ascli.tgz</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.rvm/scripts/rvm</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf ascp install <span class="at">--sdk-url</span><span class="op">=</span>file:///sdk.zip</span></code></pre></div>
<ul>
<li>Add those lines to shell init (<code>.profile</code>)</li>
</ul>
<div class="sourceCode" id="cb67"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">source</span> ~/.rvm/scripts/rvm</span></code></pre></div>
<h1 data-number="4" id="command-line-interface-ascli"><span
class="header-section-number">4</span> <a id="cli"></a>Command Line
Interface: <code>ascli</code></h1>
<p>The <code>aspera-cli</code> Gem provides a command line interface
(CLI) which interacts with Aspera Products (mostly using REST APIs):</p>
<ul>
<li>IBM Aspera High Speed Transfer Server (FASP and Node)</li>
<li>IBM Aspera on Cloud (including ATS)</li>
<li>IBM Aspera Faspex</li>
<li>IBM Aspera Shares</li>
<li>IBM Aspera Console</li>
<li>IBM Aspera Orchestrator</li>
<li>and more…</li>
</ul>
<p><code>ascli</code> provides the following features:</p>
<ul>
<li>Supports most Aspera server products (on-premise and SaaS)</li>
<li>Any command line options (products URL, credentials or any option)
can be provided on command line, in configuration file, in env var, in
files</li>
<li>Supports Commands, Option values and Parameters shortcuts</li>
<li>FASP <a href="#agents">Transfer Agents</a> can be: local
<code>ascp</code>, or Connect Client, or any transfer node</li>
<li>Transfer parameters can be altered by modification of <a
href="#transferspec"><em>transfer-spec</em></a>, this includes requiring
multi-session</li>
<li>Allows transfers from products to products, essentially at node
level (using the node transfer agent)</li>
<li>Supports FaspStream creation (using Node API)</li>
<li>Supports Watchfolder creation (using Node API)</li>
<li>Additional command plugins can be written by the user</li>
<li>Supports download of faspex and Aspera on Cloud “external”
links</li>
<li>Supports “legacy” ssh based FASP transfers and remote commands
(ascmd)</li>
</ul>
<p>Basic usage is displayed by executing:</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">-h</span></span></code></pre></div>
<p>Refer to sections: <a href="#usage">Usage</a>.</p>
<p>Not all <code>ascli</code> features are fully documented here, the
user may explore commands on the command line.</p>
<h2 data-number="4.1" id="ascp-command-line"><span
class="header-section-number">4.1</span> <code>ascp</code> command
line</h2>
<p>If you want to use <code>ascp</code> directly as a command line,
refer to IBM Aspera documentation of either <a
href="https://www.ibm.com/docs/en/asdc">Desktop Client</a>, <a
href="https://www.ibm.com/docs/en/ahte">Endpoint</a> or <a
href="https://www.ibm.com/docs/en/ahts">Transfer Server</a> where <a
href="https://www.ibm.com/docs/en/ahts/4.4?topic=linux-ascp-transferring-from-command-line">a
section on <code>ascp</code> can be found</a>.</p>
<p>Using <code>ascli</code> with plugin <code>server</code> for command
line gives advantages over <code>ascp</code>:</p>
<ul>
<li>automatic resume on error</li>
<li>configuration file</li>
<li>choice of transfer agents</li>
<li>integrated support of multi-session</li>
</ul>
<p>Moreover all <code>ascp</code> options are supported either through
transfer spec parameters and with the possibility to provide
<code>ascp</code> arguments directly when the <code>direct</code> agent
is used (<code>ascp_args</code>).</p>
<h2 data-number="4.2" id="command-line-parsing-special-characters"><span
class="header-section-number">4.2</span> <a id="parsing"></a>Command
line parsing, Special Characters</h2>
<p><code>ascli</code> is typically executed in a shell, either
interactively or in a script. <code>ascli</code> receives its arguments
from this shell (through Operating System).</p>
<h3 data-number="4.2.1"
id="shell-parsing-for-unix-like-systems-linux-macos-aix"><span
class="header-section-number">4.2.1</span> Shell parsing for Unix-like
systems: Linux, macOS, AIX</h3>
<p>Linux command line parsing is easy: It is fully documented in the
shell’s documentation.</p>
<p>On Unix-like environments, this is typically a POSIX shell (bash,
zsh, ksh, sh). In this environment the shell parses the command line,
possibly replacing variables, etc… See <a
href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Operation">bash
shell operation</a>. The shell builds the list of arguments and then
<code>fork</code>/<code>exec</code> Ruby with that list. Ruby receives a
list parameters from shell and gives it to <code>ascli</code>. So
special character handling (quotes, spaces, env vars, …) is handled by
the shell for any command executed.</p>
<h3 data-number="4.2.2" id="shell-parsing-for-windows"><span
class="header-section-number">4.2.2</span> Shell parsing for
Windows</h3>
<p>MS Windows command line parsing is not handled by the shell
(<code>cmd.exe</code>), not handled by the operating system, but it is
handled by the executable. Typically, Windows executables use the <a
href="https://learn.microsoft.com/en-us/cpp/cpp/main-function-command-line-args">microsoft
library for this parsing</a>.</p>
<p>As far as <code>ascli</code> is concerned: the executable is Ruby. It
has its own parsing algorithm, close to a Linux shell parsing.</p>
<p>Thanksfully, <code>ascli</code> provides a command to check the value
of an argument after parsing: <code>config echo</code>. One can also run
<code>ascli</code> with option <code>--log-level=debug</code> to display
the command line after parsing.</p>
<p>The following examples give the same result on Windows:</p>
<ul>
<li><p>single quote protects the double quote</p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a> conf echo @json:&#39;{<span class="st">&quot;url&quot;</span>:<span class="st">&quot;https://...&quot;</span>}&#39;</span></code></pre></div></li>
<li><p>triple double quotes are replaced with a single double quote</p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a> conf echo @json:{<span class="st">&quot;&quot;&quot;url&quot;&quot;&quot;</span>:<span class="st">&quot;&quot;&quot;https://...&quot;&quot;&quot;</span>}</span></code></pre></div></li>
<li><p>double quote is escaped with backslash within double quotes</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a> conf echo @json:<span class="st">&quot;{</span><span class="sc">\&quot;</span><span class="st">url</span><span class="sc">\&quot;</span><span class="st">:</span><span class="sc">\&quot;</span><span class="st">https://...</span><span class="sc">\&quot;</span><span class="st">}&quot;</span></span></code></pre></div></li>
</ul>
<p>More details: on Windows, <code>cmd.exe</code> is typically used to
start . <code>cmd.exe</code> handles some special characters:
<code>^"&lt;&gt;|%&amp;</code>. Basically it handles I/O redirections
(<code>&lt;&gt;|</code>), shell variables (<code>%</code>), multiple
commands (<code>&amp;</code>) and handles those special characters from
the command line. Eventually, all those special characters are removed
from the command line unless escaped with <code>^</code> or
<code>"</code>. <code>"</code> are kept and given to the program.</p>
<p>Then, Windows <code>CreateProcess</code> is called with just the
whole command line as a single string, unlike Unix-like systems where
the command line is split into arguments by the shell.</p>
<p>It’s up to the program to split arguments:</p>
<ul>
<li><a
href="https://daviddeley.com/autohotkey/parameters/parameters.htm#RUBY">Windows:
How Command Line Parameters Are Parsed</a></li>
<li><a
href="https://web.archive.org/web/20190316094059/http://www.windowsinspired.com/understanding-the-command-line-string-and-arguments-received-by-a-windows-program/">Understand
Quoting and Escaping of Windows Command Line Arguments</a></li>
</ul>
<p>is a Ruby program, so Ruby parses the command line into arguments and
provides them to the program. Ruby vaguely follows the Microsoft C/C++
parameter parsing rules. (See <code>w32_cmdvector</code> in Ruby source
<a
href="https://github.com/ruby/ruby/blob/master/win32/win32.c#L1766"><code>win32.c</code></a>)
: <!--cspell:disable-line--></p>
<ul>
<li>space characters: split arguments (space, tab, newline)</li>
<li>backslash: <code>\</code> escape single special character</li>
<li>globbing characters: <code>*?[]{}</code> for file globbing</li>
<li>double quotes: <code>"</code></li>
<li>single quotes: <code>'</code></li>
</ul>
<h3 data-number="4.2.3" id="extended-values-json-ruby"><span
class="header-section-number">4.2.3</span> Extended Values (JSON, Ruby,
…)</h3>
<p>Some of the <code>ascli</code> parameters are expected to be <a
href="#extended">Extended Values</a>, i.e. not a simple strings, but a
complex structure (Hash, Array). Typically, the <code>@json:</code>
modifier is used, it expects a JSON string. JSON itself has some special
syntax: for example <code>"</code> is used to denote strings.</p>
<h3 data-number="4.2.4" id="testing-extended-values"><span
class="header-section-number">4.2.4</span> Testing Extended Values</h3>
<p>In case of doubt of argument values after parsing, one can test using
command <code>config echo</code>. <code>config echo</code> takes exactly
<strong>one</strong> argument which can use the <a
href="#extended">Extended Value</a> syntax. Unprocessed command line
arguments are shown in the error message.</p>
<p>Example: The shell parses three arguments (as strings:
<code>1</code>, <code>2</code> and <code>3</code>), so the additional
two arguments are not processed by the <code>echo</code> command.</p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo 1 2 3</span></code></pre></div>
<div class="sourceCode" id="cb73"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;1&quot;</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="cn">ERROR</span>: <span class="dt">Argument</span>: unprocessed <span class="wa">values: </span><span class="kw">[</span><span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span><span class="kw">]</span></span></code></pre></div>
<p><code>config echo</code> displays the value of the
<strong>first</strong> argument using Ruby syntax: it surrounds a string
with <code>"</code> and add <code>\</code> before special
characters.</p>
<blockquote>
<p><strong>Note:</strong> It gets its value after shell command line
parsing and <code>ascli</code> extended value parsing.</p>
</blockquote>
<p>In the following examples (using a POSIX shell, such as
<code>bash</code>), several sample commands are provided when
equivalent. For all example, most of special character handling is not
specific to <code>ascli</code>: It depends on the underlying syntax:
shell , JSON, etc… Depending on the case, a different
<code>format</code> is used to display the actual value.</p>
<p>For example, in the simple string <code>Hello World</code>, the space
character is special for the shell, so it must be escaped so that a
single value is represented.</p>
<p>Double quotes are processed by the shell to create a single string
argument. For <strong>POSIX shells</strong>, single quotes can also be
used in this case, or protect the special character <code></code>
(space) with a backslash. <!-- markdownlint-disable-line --></p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo <span class="st">&quot;Hello World&quot;</span> <span class="at">--format</span><span class="op">=</span>text</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo <span class="st">&#39;Hello World&#39;</span> <span class="at">--format</span><span class="op">=</span>text</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo Hello<span class="dt">\ </span>World <span class="at">--format</span><span class="op">=</span>text</span></code></pre></div>
<pre class="output"><code>Hello World</code></pre>
<h3 data-number="4.2.5"
id="using-a-shell-variable-parsed-by-shell-in-an-extended-value"><span
class="header-section-number">4.2.5</span> Using a shell variable,
parsed by shell, in an extended value</h3>
<p>To be evaluated by shell, the shell variable must not be in single
quotes. Even if the variable contains spaces it makes only one argument
to <code>ascli</code> because word parsing is made before variable
expansion by shell.</p>
<blockquote>
<p><strong>Note:</strong> we use a shell variable here: the variable is
not necessarily an environment variable (<code>export</code>).</p>
</blockquote>
<div class="sourceCode" id="cb76"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="va">MYVAR</span><span class="op">=</span><span class="st">&quot;Hello World&quot;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @json:<span class="st">&#39;{&quot;title&quot;:&quot;&#39;</span><span class="va">$MYVAR</span><span class="st">&#39;&quot;}&#39;</span> <span class="at">--format</span><span class="op">=</span>json</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @json:{<span class="dt">\&quot;</span>title<span class="dt">\&quot;</span>:<span class="dt">\&quot;</span><span class="va">$MYVAR</span><span class="dt">\&quot;</span>} <span class="at">--format</span><span class="op">=</span>json</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;title&quot;</span><span class="fu">:</span><span class="st">&quot;Hello World&quot;</span><span class="fu">}</span></span></code></pre></div>
<h3 data-number="4.2.6"
id="double-quote-in-strings-in-command-line"><span
class="header-section-number">4.2.6</span> Double quote in strings in
command line</h3>
<p>Double quote is a shell special character. Like any shell special
character, it can be protected either by preceding with a backslash or
by enclosing in a single quote.</p>
<div class="sourceCode" id="cb78"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo <span class="dt">\&quot;</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo <span class="st">&#39;&quot;&#39;</span></span></code></pre></div>
<pre class="output"><code>&quot;</code></pre>
<p>Double quote in JSON is a little tricky because <code>"</code> is
special both for the shell and JSON. Both shell and JSON syntax allow to
protect <code>"</code>, but only the shell allows protection using
single quote.</p>
<div class="sourceCode" id="cb80"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @json:<span class="st">&#39;&quot;\&quot;&quot;&#39;</span> <span class="at">--format</span><span class="op">=</span>text</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @json:<span class="dt">\&quot;\\\&quot;\&quot;</span> <span class="at">--format</span><span class="op">=</span>text</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @ruby:<span class="dt">\&#39;\&quot;\&#39;</span> <span class="at">--format</span><span class="op">=</span>text</span></code></pre></div>
<pre class="output"><code>&quot;</code></pre>
<p>Here a single quote or a backslash protects the double quote to avoid
shell processing, and then an additional <code>\</code> is added to
protect the <code>"</code> for JSON. But as <code>\</code> is also shell
special, then it is protected by another <code>\</code>.</p>
<h3 data-number="4.2.7"
id="shell-and-json-or-ruby-special-characters-in-extended-value"><span
class="header-section-number">4.2.7</span> Shell and JSON or Ruby
special characters in extended value</h3>
<p>Construction of values with special characters is done like this:</p>
<ul>
<li><p>First select a syntax to represent the extended value, e.g. JSON
or Ruby</p></li>
<li><p>Write the expression using this syntax, for example, using
JSON:</p></li>
</ul>
<div class="sourceCode" id="cb82"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;title&quot;</span><span class="fu">:</span><span class="st">&quot;Test </span><span class="ch">\&quot;</span><span class="st"> &#39; &amp; </span><span class="ch">\\</span><span class="st">&quot;</span><span class="fu">}</span></span></code></pre></div>
<p>or using Ruby:</p>
<div class="sourceCode" id="cb83"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="st">&quot;title&quot;</span><span class="kw">=&gt;</span><span class="st">&quot;Test \&quot; &#39; &amp; \\&quot;</span><span class="kw">}</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span><span class="vs">&#39;title&#39;</span><span class="kw">=&gt;</span><span class="ot">%q{</span><span class="vs">Test &quot; &#39; &amp; \\</span><span class="ot">}</span><span class="kw">}</span></span></code></pre></div>
<p>Both <code>"</code> and <code>\</code> are special characters for
JSON and Ruby and can be protected with <code>\</code> (unless Ruby’s
extended single quote notation <code>%q</code> is used).</p>
<ul>
<li>Then, since the value will be evaluated by shell, any shell special
characters must be protected, either using preceding <code>\</code> for
each character to protect, or by enclosing in single quote:</li>
</ul>
<div class="sourceCode" id="cb84"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @json:{<span class="dt">\&quot;</span>title<span class="dt">\&quot;</span>:<span class="dt">\&quot;</span>Test<span class="dt">\ \\\&quot;\ \&#39;\ \&amp;\ \\\\\&quot;</span>} <span class="at">--format</span><span class="op">=</span>json</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @json:<span class="st">&#39;{&quot;title&quot;:&quot;Test \&quot; &#39;</span><span class="dt">\&#39;</span><span class="st">&#39; &amp; \\&quot;}&#39;</span> <span class="at">--format</span><span class="op">=</span>json</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @ruby:<span class="st">&quot;{&#39;title&#39;=&gt;%q{Test </span><span class="dt">\&quot;</span><span class="st"> &#39; &amp; </span><span class="dt">\\\\</span><span class="st">}}&quot;</span> <span class="at">--format</span><span class="op">=</span>json</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;title&quot;</span><span class="fu">:</span><span class="st">&quot;Test </span><span class="ch">\&quot;</span><span class="st"> &#39; &amp; </span><span class="ch">\\</span><span class="st">&quot;</span><span class="fu">}</span></span></code></pre></div>
<h3 data-number="4.2.8"
id="reading-special-characters-interactively"><span
class="header-section-number">4.2.8</span> Reading special characters
interactively</h3>
<p>If <code>ascli</code> is used interactively (a user typing on
terminal), it is easy to require the user to type values:</p>
<div class="sourceCode" id="cb86"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @ruby:<span class="st">&quot;{&#39;title&#39;=&gt;gets.chomp}&quot;</span> <span class="at">--format</span><span class="op">=</span>json</span></code></pre></div>
<p><code>gets</code> is Ruby’s method of terminal input (terminated by
<code>\n</code>), and <code>chomp</code> removes the trailing
<code>\n</code>.</p>
<h3 data-number="4.2.9" id="command-line-arguments-from-a-file"><span
class="header-section-number">4.2.9</span> Command line arguments from a
file</h3>
<p>If you need to provide a list of command line argument from lines
that are in a file, on Linux you can use the <code>xargs</code>
command:</p>
<div class="sourceCode" id="cb87"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xargs</span> <span class="at">-a</span> lines.txt <span class="at">-d</span> <span class="dt">\\</span>n ascli conf echo</span></code></pre></div>
<p>This is equivalent to execution of:</p>
<div class="sourceCode" id="cb88"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo <span class="pp">[</span><span class="ss">line1</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">line2</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">line3</span><span class="pp">]</span> ...</span></code></pre></div>
<p>If there are spaces in the lines, those are not taken as separator,
as we provide option <code>-d \\n</code> to <code>xargs</code>.</p>
<h3 data-number="4.2.10"
id="extended-value-using-special-characters-read-from-environmental-variables-or-files"><span
class="header-section-number">4.2.10</span> Extended value using special
characters read from environmental variables or files</h3>
<p>Using a text editor or shell: create a file <code>title.txt</code>
(and env var) that contains exactly the text required:
<code>Test " ' &amp; \</code> :</p>
<div class="sourceCode" id="cb89"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">MYTITLE</span><span class="op">=</span><span class="st">&#39;Test &quot; &#39;</span><span class="dt">\&#39;</span><span class="st">&#39; &amp; \&#39;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="at">-n</span> <span class="va">$MYTITLE</span> <span class="op">&gt;</span> title.txt</span></code></pre></div>
<p>Using those values will not require any escaping of characters since
values do not go through shell or JSON parsing.</p>
<p>If the value is to be assigned directly to an option of ascli, then
you can directly use the content of the file or env var using the
<code>@file:</code> or <code>@env:</code> readers:</p>
<div class="sourceCode" id="cb90"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @file:title.txt <span class="at">--format</span><span class="op">=</span>text</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @env:MYTITLE <span class="at">--format</span><span class="op">=</span>text</span></code></pre></div>
<pre class="output"><code>Test &quot; &#39; &amp; \</code></pre>
<p>If the value to be used is in a more complex structure, then the
<code>@ruby:</code> modifier can be used: it allows any Ruby code in
expression, including reading from file or env var. In those cases,
there is no character to protect because values are not parsed by the
shell, or JSON or even Ruby.</p>
<div class="sourceCode" id="cb92"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @ruby:<span class="st">&quot;{&#39;title&#39;=&gt;File.read(&#39;title.txt&#39;)}&quot;</span> <span class="at">--format</span><span class="op">=</span>json</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @ruby:<span class="st">&quot;{&#39;title&#39;=&gt;ENV[&#39;MYTITLE&#39;]}&quot;</span> <span class="at">--format</span><span class="op">=</span>json</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;title&quot;</span><span class="fu">:</span><span class="st">&quot;Test </span><span class="ch">\&quot;</span><span class="st"> &#39; &amp; </span><span class="ch">\\</span><span class="st">&quot;</span><span class="fu">}</span></span></code></pre></div>
<h2 data-number="4.3" id="commands-options-positional-arguments"><span
class="header-section-number">4.3</span> Commands, Options, Positional
Arguments</h2>
<p>Command line arguments are the units of command line, as parsed by
the shell, typically separated by spaces (and called “argv”). Refer to
the previous section <a href="#parsing">Command Line Parsing</a>.</p>
<p><code>ascli</code> considers three types of command line
arguments:</p>
<ul>
<li>Commands</li>
<li>Options</li>
<li>Positional Arguments</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb94"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> command subcommand <span class="at">--option-name</span><span class="op">=</span>VAL1 VAL2</span></code></pre></div>
<ul>
<li>executes <strong>command</strong>:
<code>command subcommand</code></li>
<li>with one <strong>option</strong>: <code>option_name</code>and its
<em>value</em>: <code>VAL1</code></li>
<li>the command has one additional <strong>positional argument</strong>:
<code>VAL2</code></li>
</ul>
<p>If the value of a command, option or argument is constrained by a
fixed list of values, then it is possible to use the first letters of
the value only, provided that it uniquely identifies the value. For
example <code>ascli conf pre ov</code> is the same as
<code>ascli config preset overview</code>.</p>
<p>The value of options and arguments is evaluated with the <a
href="#extended">Extended Value Syntax</a>.</p>
<h3 data-number="4.3.1" id="commands"><span
class="header-section-number">4.3.1</span> Commands</h3>
<p>Commands are typically entity types or verbs to act on those
entities.</p>
<p>Example:</p>
<div class="sourceCode" id="cb95"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf ascp info</span></code></pre></div>
<ul>
<li><code>ascli</code> is the executable executed by the shell</li>
<li><code>conf</code> is the first level command, and is also the name f
the plugin to be used</li>
<li><code>ascp</code> is the second level command, and is also the name
of the component (singleton)</li>
<li><code>info</code> is the third level command, and is also the action
to be performed</li>
</ul>
<p>Typically, commands are located at the <strong>beginning</strong> of
the command line. Order is significant. The provided command must match
one of the supported commands in the given context. If wrong, or no
command is provided when expected, an error message is displayed and the
list of supported commands is displayed.</p>
<p>Some sub-commands appear after entity selection,
e.g. <code>ascli aoc admin res node do 8669 browse /</code>:
<code>browse</code> is a sub-command of <code>node</code>.</p>
<h3 data-number="4.3.2" id="options"><span
class="header-section-number">4.3.2</span> Options</h3>
<p>All options, e.g. <code>--log-level=debug</code>, are command line
arguments that:</p>
<ul>
<li>start with <code>--</code></li>
<li>have a name, in lowercase, using <code>-</code> as word separator in
name (e.g. <code>--log-level=debug</code>)</li>
<li>have a value, separated from name with a <code>=</code></li>
<li>can be used by prefix, provided that it is unique. E.g.
<code>--log-l=debug</code> is the same as <code>--log-level=debug</code>
(avoid)</li>
</ul>
<p>Exceptions:</p>
<ul>
<li>some options accept a short form, e.g. <code>-Ptoto</code> is
equivalent to <code>--preset=toto</code>, refer to the manual or
<code>-h</code>.</li>
<li>some options (flags) don’t take a value, e.g. <code>-r</code></li>
<li>the special option <code>--</code> stops option processing and is
ignored, following command line arguments are taken as arguments,
including the ones starting with a <code>-</code>. Example:</li>
</ul>
<div class="sourceCode" id="cb96"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config echo <span class="at">--</span> <span class="at">--sample</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;--sample&quot;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> Here, <code>--sample</code> is taken as an
argument, and not as an option, due to <code>--</code>.</p>
</blockquote>
<p>Options may have an (hardcoded) default value.</p>
<p>Options can be placed anywhere on command line and evaluated in
order.</p>
<p>Options are either:</p>
<ul>
<li>optional : to change the default behavior</li>
<li>mandatory : connection information are options that are mandatory
(so they can be placed in a config file)</li>
</ul>
<p>The value for <strong>any</strong> options can come from the
following locations (in this order, last value evaluated overrides
previous value):</p>
<ul>
<li><a href="#configfile">Configuration file</a>.</li>
<li>Environment variable</li>
<li>Command line</li>
</ul>
<p>Environment variable starting with prefix: ASCLI_ are taken as option
values, e.g. <code>ASCLI_OPTION_NAME</code> is for
<code>--option-name</code>.</p>
<p>Options values can be displayed for a given command by providing the
<code>--show-config</code> option:
<code>ascli node --show-config</code></p>
<p>Parameters are typically designed as options if:</p>
<ul>
<li>it is a mandatory parameters that would benefit from being set in a
config file or environment variable</li>
<li>it is optional</li>
</ul>
<h3 data-number="4.3.3" id="positional-arguments"><span
class="header-section-number">4.3.3</span> Positional Arguments</h3>
<p>Positional Arguments are typically mandatory values for a command,
such as entity creation data.</p>
<p>It could also be designed as an option, but since it is mandatory and
typically creation parameters need not be set in a configuration file,
then it is better to use a positional argument, and not define specific
options.</p>
<p>The advantages of using a positional argument instead of an option
for the same are that the command line is shorter(no option name, just
the position) and the value is clearly mandatory.</p>
<p>The disadvantage is that it is not possible to define a default value
in a config file or environment variable like for options. Nevertheless,
<a href="#extended">Extended Values</a> syntax is supported, so it is
possible to retrieve a value from the config file or environment
variable.</p>
<p>If a Positional Arguments begins with <code>-</code>, then either use
the <code>@val:</code> syntax (see <a href="#extended">Extended
Values</a>), or use the <code>--</code> separator (see above).</p>
<p>Very few positional arguments are optional, they are located at the
end of the command line.</p>
<h2 data-number="4.4" id="interactive-input"><span
class="header-section-number">4.4</span> Interactive Input</h2>
<p>Some options and parameters are mandatory and other optional. By
default, <code>ascli</code> will ask for missing mandatory options or
parameters for interactive execution.</p>
<p>The behavior can be controlled with:</p>
<ul>
<li><code>--interactive=&lt;yes|no&gt;</code> (default=yes if STDIN is a
terminal, else no)
<ul>
<li>yes : missing mandatory parameters/options are asked to the
user</li>
<li>no : missing mandatory parameters/options raise an error
message</li>
</ul></li>
<li><code>--ask-options=&lt;yes|no&gt;</code> (default=no)
<ul>
<li>optional parameters/options are asked to user</li>
</ul></li>
</ul>
<h2 data-number="4.5" id="output"><span
class="header-section-number">4.5</span> Output</h2>
<p>Command execution will result in output (terminal, stdout/stderr).
The information displayed depends on the action.</p>
<h3 data-number="4.5.1" id="types-of-output-data"><span
class="header-section-number">4.5.1</span> Types of output data</h3>
<p>Depending on action, the output will contain:</p>
<ul>
<li><code>single_object</code> : displayed as a 2 dimensional table: one
line per attribute, first column is attribute name, and second is
attribute value. Nested hashes are collapsed.</li>
<li><code>object_list</code> : displayed as a 2 dimensional table: one
line per item, one column per attribute.</li>
<li><code>value_list</code> : a table with one column.</li>
<li><code>empty</code> : nothing</li>
<li><code>status</code> : a message</li>
<li><code>other_struct</code> : a complex structure that cannot be
displayed as an array</li>
</ul>
<h3 data-number="4.5.2" id="format-of-output"><span
class="header-section-number">4.5.2</span> Format of output</h3>
<p>By default, result of type single_object and object_list are
displayed using format <code>table</code>. The table style can be
customized with parameter: <code>table_style</code> (horizontal,
vertical and intersection characters) and is <code>:.:</code> by
default.</p>
<p>In a table format, when displaying “objects” (single, or list), by
default, sub object are flattened (option <code>flat_hash</code>). So,
object <code>{"user":{"id":1,"name":"toto"}}</code> will have
attributes: <code>user.id</code> and <code>user.name</code>. Setting
<code>flat_hash</code> to <code>false</code> will only display one
field: <code>user</code> and value is the sub Hash table. When in
flatten mode, it is possible to filter fields by “dotted” field
name.</p>
<p>Object lists are displayed one per line, with attributes as columns.
Single objects are transposed: one attribute per line. If transposition
of single object is not desired, use option:
<code>transpose_single</code> set to <code>no</code>.</p>
<p>The style of output can be set using the <code>format</code>
parameter, supporting:</p>
<ul>
<li><code>text</code> : Value as String</li>
<li><code>table</code> : Text table</li>
<li><code>ruby</code> : Ruby code</li>
<li><code>json</code> : JSON code</li>
<li><code>jsonpp</code> : JSON pretty printed</li>
<li><code>yaml</code> : YAML</li>
<li><code>csv</code> : Comma Separated Values</li>
</ul>
<h3 data-number="4.5.3"
id="option-select-filter-on-columns-values-for-object_list"><span
class="header-section-number">4.5.3</span>
<a id="option_select"></a>Option: <code>select</code>: Filter on columns
values for <code>object_list</code></h3>
<p>Table output can be filtered using the <code>select</code> parameter.
Example:</p>
<div class="sourceCode" id="cb98"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--fields</span><span class="op">=</span>name,email,ats_admin <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;sort&quot;:&quot;name&quot;}&#39;</span> <span class="at">--select</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;ats_admin&quot;:true}&#39;</span></span></code></pre></div>
<pre class="output"><code>+-------------------------------+----------------------------------+-----------+
|             name              |              email               | ats_admin |
+-------------------------------+----------------------------------+-----------+
| John Curtis                   | john@example.com                 | true      |
| Laurent Martin                | laurent@example.com              | true      |
+-------------------------------+----------------------------------+-----------+</code></pre>
<blockquote>
<p><strong>Note:</strong> <code>select</code> filters selected elements
from the result of API calls, while the <code>query</code> parameters
gives filtering parameters to the API when listing elements.</p>
</blockquote>
<h3 data-number="4.5.4" id="entity-identifier"><span
class="header-section-number">4.5.4</span> Entity identifier</h3>
<p>When a command is executed on a single entity, the entity is
identified by a unique identifier that follows the command:
e.g. <code>ascli aoc admin res user show 1234</code> where
<code>1234</code> is the user’s identifier.</p>
<blockquote>
<p><strong>Note:</strong> The legacy option <code>id</code> is
deprecated: <code>--id=1234</code> as it does not provide the
possibility to have sub-entities.</p>
</blockquote>
<p>Only some commands provide the following capability: If the entity
can also be uniquely identified by a name, then the name can be used
instead of the identifier, using the <strong>percent selector</strong>:
<code>ascli aoc admin res user show %name:john</code> where
<code>john</code> is the user name.</p>
<p>Syntax: <code>%&lt;field&gt;:&lt;value&gt;</code></p>
<h3 data-number="4.5.5" id="verbosity-of-output"><span
class="header-section-number">4.5.5</span> Verbosity of output</h3>
<p>Output messages are categorized in 3 types:</p>
<ul>
<li><code>info</code> output contain additional information, such as
number of elements in a table</li>
<li><code>data</code> output contain the actual output of the command
(object, or list of objects)</li>
<li><code>error</code>output contain error messages</li>
</ul>
<p>The option <code>display</code> controls the level of output:</p>
<ul>
<li><code>info</code> displays all messages: <code>info</code>,
<code>data</code>, and <code>error</code></li>
<li><code>data</code> display <code>data</code> and <code>error</code>
messages</li>
<li><code>error</code> display only error messages.</li>
</ul>
<p>By default, secrets are removed from output: option
<code>show_secrets</code> defaults to <code>no</code>, unless
<code>display</code> is <code>data</code>, to allows piping results. To
hide secrets from output, set option <code>show_secrets</code> to
<code>no</code>.</p>
<h3 data-number="4.5.6" id="selection-of-output-object-properties"><span
class="header-section-number">4.5.6</span> Selection of output object
properties</h3>
<p>By default, a table output will display one line per entry, and
columns for each properties. Depending on the command, columns may
include by default all properties, or only some selected properties. It
is possible to define specific columns to be displayed, by setting the
<code>fields</code> option.</p>
<p>The <code>fields</code> option can be either a comma separated list,
or an extended value array.</p>
<p>Elements of the list can be:</p>
<ul>
<li>DEF : default display of columns (that’s the default, when not
set)</li>
<li>ALL : all columns available</li>
<li>-property : remove property from the current list</li>
<li>property : add property to the current list</li>
</ul>
<p>Examples:</p>
<ul>
<li><code>a,b,c</code> : the list of attributes specified as a comma
separated list</li>
<li>Array extended value: for instance,
<code>@json:'["a","b","c"]'</code> same as above</li>
<li><code>DEF,-a,b</code> : default property list, remove <code>a</code>
and add <code>b</code></li>
</ul>
<h2 data-number="4.6" id="extended-value-syntax"><span
class="header-section-number">4.6</span> <a id="extended"></a>Extended
Value Syntax</h2>
<p>Some options and arguments are specified by a simple string. But
sometime it is convenient to read a value from a file, or decode it, or
have a value more complex than a string (e.g. Hash table).</p>
<p>The extended value syntax is:</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>0 <span class="ex">or</span> more decoders<span class="op">&gt;&lt;</span>some text value or nothing<span class="op">&gt;</span></span></code></pre></div>
<p>Decoders act like a function with its parameter on right hand side.
Decoders are recognized by the prefix: <code>@</code> and suffix
<code>:</code></p>
<p>The following decoders are supported:</p>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 26%" />
<col style="width: 21%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="header">
<th>decoder</th>
<th>parameter</th>
<th>returns</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>base64</td>
<td>String</td>
<td>String</td>
<td>decode a base64 encoded string</td>
</tr>
<tr class="even">
<td>csvt</td>
<td>String</td>
<td>Array</td>
<td>decode a titled CSV value</td>
</tr>
<tr class="odd">
<td>env</td>
<td>String</td>
<td>String</td>
<td>read from a named env var name, e.g.–password=<span class="citation"
data-cites="env:MYPASSVAR">@env:MYPASSVAR</span></td>
</tr>
<tr class="even">
<td>file</td>
<td>String</td>
<td>String</td>
<td>read value from specified file (prefix <code>~/</code> is replaced
with the users home folder),
e.g. <code>--key=@file:~/.ssh/mykey</code></td>
</tr>
<tr class="odd">
<td>json</td>
<td>String</td>
<td>any</td>
<td>decode JSON values (convenient to provide complex structures)</td>
</tr>
<tr class="even">
<td>lines</td>
<td>String</td>
<td>Array</td>
<td>split a string in multiple lines and return an array</td>
</tr>
<tr class="odd">
<td>list</td>
<td>String</td>
<td>Array</td>
<td>split a string in multiple items taking first character as separator
and return an array</td>
</tr>
<tr class="even">
<td>path</td>
<td>String</td>
<td>String</td>
<td>performs path expansion on specified path (prefix <code>~/</code> is
replaced with the users home folder),
e.g. <code>--config-file=@path:~/sample_config.yml</code></td>
</tr>
<tr class="odd">
<td>preset</td>
<td>String</td>
<td>Hash</td>
<td>get whole option preset value by name. Sub-values can also be used
using <code>.</code> as separator. e.g. <code>foo.bar</code> is
<code>conf[foo][bar]</code></td>
</tr>
<tr class="even">
<td>extend</td>
<td>String</td>
<td>String</td>
<td>evaluates embedded extended value syntax in string</td>
</tr>
<tr class="odd">
<td>ruby</td>
<td>String</td>
<td>any</td>
<td>execute specified Ruby code</td>
</tr>
<tr class="even">
<td>secret</td>
<td>None</td>
<td>String</td>
<td>Ask password interactively (hides input)</td>
</tr>
<tr class="odd">
<td>stdin</td>
<td>None</td>
<td>String</td>
<td>read from stdin (no value on right)</td>
</tr>
<tr class="even">
<td>uri</td>
<td>String</td>
<td>String</td>
<td>read value from specified URL,
e.g. <code>--fpac=@uri:http://serv/f.pac</code></td>
</tr>
<tr class="odd">
<td>val</td>
<td>String</td>
<td>String</td>
<td>prevent decoders on the right to be decoded.
e.g. <code>--key=@val:@file:foo</code> sets the option <code>key</code>
to value <code>@file:foo</code>.</td>
</tr>
<tr class="even">
<td>zlib</td>
<td>String</td>
<td>String</td>
<td>un-compress data</td>
</tr>
</tbody>
</table>
<p>To display the result of an extended value, use the
<code>config echo</code> command.</p>
<p>The <code>extend</code> decoder is useful to evaluate embedded
extended value syntax in a string. It expects a <code>@</code> to close
the embedded extended value syntax.</p>
<p>Example: read the content of the specified file, then, base64 decode,
then unzip:</p>
<div class="sourceCode" id="cb101"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config echo @zlib:@base64:@file:myfile.dat</span></code></pre></div>
<p>Example: Create a value as a Hash, with one key and the value is read
from a file:</p>
<div class="sourceCode" id="cb102"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config echo @ruby:<span class="st">&#39;{&quot;token_verification_key&quot;=&gt;File.read(&quot;mykey.txt&quot;)}&#39;</span></span></code></pre></div>
<p>Example: read a csv file and create a list of Hash for bulk
provisioning:</p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> test.csv</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="ex">name,email</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="ex">lolo,laurent@example.com</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="ex">toto,titi@tutu.tata</span></span></code></pre></div>
<div class="sourceCode" id="cb105"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config echo @csvt:@file:test.csv</span></code></pre></div>
<pre class="output"><code>+------+---------------------+
| name |        email        |
+------+---------------------+
| lolo | laurent@example.com |
| toto | titi@tutu.tata      |
+------+---------------------+</code></pre>
<p>Example: create a JSON with values coming from a preset named
“config” of config file</p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config echo @json:@extend:<span class="st">&#39;{&quot;hello&quot;:true,&quot;version&quot;:&quot;@preset:config.version@&quot;}&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb108"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">+---------+-----------+</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> key     <span class="kw">|</span> value     <span class="kw">|</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="kw">+---------+-----------+</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> hello   <span class="kw">|</span> <span class="dv">true</span>      <span class="kw">|</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="kw">|</span> version <span class="kw">|</span> <span class="fl">4.14</span><span class="kw">.</span><span class="dv">0</span>    <span class="kw">|</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="kw">+---------+-----------+</span></span></code></pre></div>
<h2 data-number="4.7" id="structured-value"><span
class="header-section-number">4.7</span> <a id="native"></a>Structured
Value</h2>
<p>Some options and parameters expect a <a href="#extended">Extended
Value</a>, i.e. a value more complex than a simple string. This is
usually a Hash table or an Array, which could also contain sub
structures.</p>
<p>For instance, a <a href="#transferspec"><em>transfer-spec</em></a> is
expected to be a <a href="#extended">Extended Value</a>.</p>
<p>Structured values shall be described using the <a
href="#extended">Extended Value Syntax</a>. A convenient way to specify
a <a href="#extended">Extended Value</a> is to use the
<code>@json:</code> decoder, and describe the value in JSON format. The
<code>@ruby:</code> decoder can also be used. For an Array of Hash
tables, the <code>@csvt:</code> decoder can be used.</p>
<p>It is also possible to provide a <a href="#extended">Extended
Value</a> in a file using <code>@json:@file:&lt;path&gt;</code></p>
<h2 data-number="4.8" id="configuration-and-persistency-folder"><span
class="header-section-number">4.8</span>
<a id="conffolder"></a>Configuration and Persistency Folder</h2>
<p><code>ascli</code> configuration and other runtime files (token
cache, file lists, persistency files, SDK) are stored
<code>[config folder]</code>:
<code>[User's home folder]/.aspera/ascli</code>.</p>
<blockquote>
<p><strong>Note:</strong> <code>[User's home folder]</code> is found
using Ruby’s <code>Dir.home</code> (<code>rb_w32_home_dir</code>). It
uses the <code>HOME</code> env var primarily, and on MS Windows it also
looks at <code>%HOMEDRIVE%%HOMEPATH%</code> and
<code>%USERPROFILE%</code>. <code>ascli</code> sets the env var
<code>%HOME%</code> to the value of <code>%USERPROFILE%</code> if set
and exists. So, on Windows <code>%USERPROFILE%</code> is used as it is
more reliable than <code>%HOMEDRIVE%%HOMEPATH%</code>.</p>
</blockquote>
<p>The [config folder] can be displayed using :</p>
<div class="sourceCode" id="cb109"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config folder</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/Users/kenji/.aspera/ascli</span></span></code></pre></div>
<p>It can be overridden using the environment variable
<code>ASCLI_HOME</code>.</p>
<p>Example (Windows):</p>
<pre class="output"><code>set ASCLI_HOME=C:\Users\Kenji\.aspera\ascli

ascli config folder

C:\Users\Kenji\.aspera\ascli</code></pre>
<p>When OAuth is used (AoC, Faspex4 api v4, Faspex5) <code>ascli</code>
keeps a cache of generated bearer tokens in
<code>[config folder]/persist_store</code> by default. Option
<code>cache_tokens</code> (<strong>yes</strong>/no) allows to control if
Oauth tokens are cached on file system, or generated for each request.
The command <code>config flush_tokens</code> deletes all existing
tokens. Tokens are kept on disk for a maximum of 30 minutes
(<code>TOKEN_CACHE_EXPIRY_SEC</code>) and garbage collected after that.
Tokens that can be refreshed are refreshed. Else tokens are re-generated
if expired.</p>
<h2 data-number="4.9" id="configuration-file"><span
class="header-section-number">4.9</span>
<a id="configfile"></a>Configuration file</h2>
<p>On the first execution of <code>ascli</code>, an empty configuration
file is created in the configuration folder. Nevertheless, there is no
mandatory information required in this file, the use of it is optional
as any option can be provided on the command line.</p>
<p>Although the file is a standard YAML file, <code>ascli</code>
provides commands to read and modify it using the <code>config</code>
command.</p>
<p>All options for <code>ascli</code> can be set on command line, or by
env vars, or using <a href="#lprt">option presets</a> in the
configuration file.</p>
<p>A configuration file provides a way to define default values,
especially for authentication parameters, thus avoiding to always having
to specify those parameters on the command line.</p>
<p>The default configuration file is:
<code>$HOME/.aspera/ascli/config.yaml</code> (this can be overridden
with option <code>--config-file=path</code> or equivalent env var).</p>
<p>The configuration file is simply a catalog of pre-defined lists of
options, called: <a href="#lprt">option presets</a>. Then, instead of
specifying some common options on the command line (e.g. address,
credentials), it is possible to invoke the ones of a <a
href="#lprt">option preset</a> (e.g. <code>mypreset</code>) using the
option: <code>-Pmypreset</code> or <code>--preset=mypreset</code>.</p>
<h3 data-number="4.9.1" id="option-preset"><span
class="header-section-number">4.9.1</span> <a id="lprt"></a>Option
preset</h3>
<p>A <a href="#lprt">option preset</a> is simply a collection of
parameters and their associated values in a named section in the
configuration file.</p>
<p>A named <a href="#lprt">option preset</a> can be modified directly
using <code>ascli</code>, which will update the configuration file :</p>
<div class="sourceCode" id="cb112"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set<span class="kw">|</span><span class="ex">delete</span><span class="kw">|</span><span class="ex">show</span><span class="kw">|</span><span class="ex">initialize</span><span class="kw">|</span><span class="ex">update</span> <span class="op">&lt;</span>option preset<span class="op">&gt;</span></span></code></pre></div>
<p>The command <code>update</code> allows the easy creation of <a
href="#lprt">option preset</a> by simply providing the options in their
command line format, e.g. :</p>
<div class="sourceCode" id="cb113"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update demo_server <span class="at">--url</span><span class="op">=</span>ssh://demo.asperasoft.com:33001 <span class="at">--username</span><span class="op">=</span>asperaweb <span class="at">--password</span><span class="op">=</span>my_password_here <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;precalculate_job_size&quot;:true}&#39;</span></span></code></pre></div>
<ul>
<li>This creates a <a href="#lprt">option preset</a>
<code>demo_server</code> with all provided options.</li>
</ul>
<p>The command <code>set</code> allows setting individual options in a
<a href="#lprt">option preset</a>.</p>
<div class="sourceCode" id="cb114"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set demo_server password my_password_here</span></code></pre></div>
<p>The command <code>initialize</code>, like <code>update</code> allows
to set several parameters at once, but it deletes an existing
configuration instead of updating it, and expects a <a
href="#native"><em>Structured Value</em></a>.</p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset initialize demo_server @json:<span class="st">&#39;{&quot;url&quot;:&quot;ssh://demo.asperasoft.com:33001&quot;,&quot;username&quot;:&quot;asperaweb&quot;,&quot;password&quot;:&quot;my_pass_here&quot;,&quot;ts&quot;:{&quot;precalculate_job_size&quot;:true}}&#39;</span></span></code></pre></div>
<p>A full terminal based overview of the configuration can be displayed
using:</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset over</span></code></pre></div>
<p>A list of <a href="#lprt">option preset</a> can be displayed
using:</p>
<div class="sourceCode" id="cb117"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset list</span></code></pre></div>
<p>A good practice is to not manually edit the configuration file and
use modification commands instead. If necessary, the configuration file
can opened in a text editor with:</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config open</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> this starts the editor specified by env var
<code>EDITOR</code> if defined.</p>
</blockquote>
<p>Older format for commands are still supported:</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set<span class="kw">|</span><span class="ex">delete</span><span class="kw">|</span><span class="ex">show</span><span class="kw">|</span><span class="ex">initialize</span><span class="kw">|</span><span class="ex">update</span> <span class="op">&lt;</span>name<span class="op">&gt;</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset over</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset list</span></code></pre></div>
<h3 data-number="4.9.2" id="special-option-preset-config"><span
class="header-section-number">4.9.2</span> <a id="lprtconf"></a>Special
Option preset: config</h3>
<p>This preset name is reserved and contains a single key:
<code>version</code>. This is the version of <code>ascli</code> which
created the file.</p>
<h3 data-number="4.9.3" id="special-option-preset-default"><span
class="header-section-number">4.9.3</span> <a id="lprtdef"></a>Special
Option preset: default</h3>
<p>This preset name is reserved and contains an array of key-value ,
where the key is the name of a plugin, and the value is the name of
another preset.</p>
<p>When a plugin is invoked, the preset associated with the name of the
plugin is loaded, unless the option –no-default (or -N) is used.</p>
<blockquote>
<p><strong>Note:</strong> Special plugin name: <code>config</code> can
be associated with a preset that is loaded initially, typically used for
default values.</p>
</blockquote>
<p>Operations on this preset are done using regular <code>config</code>
operations:</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default _plugin_name_ _default_preset_for_plugin_</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset get default _plugin_name_</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;_default_preset_for_plugin_&quot;</span></span></code></pre></div>
<h3 data-number="4.9.4" id="plugin-config-configuration"><span
class="header-section-number">4.9.4</span> <a id="config"></a>Plugin:
<code>config</code>: Configuration</h3>
<p>Plugin <code>config</code> provides general commands for
<code>ascli</code>:</p>
<ul>
<li>Option preset, config file operations</li>
<li>wizard</li>
<li>vault</li>
<li>ascp</li>
</ul>
<p>The default preset for <code>config</code> is read for any plugin
invocation, this allows setting global options, such as
<code>--log-level</code> or <code>--interactive</code>. When
<code>ascli</code> starts, it looks for the <code>default</code> Option
preset and checks the value for <code>config</code>. If set, it loads
the options independently of the plugin used.</p>
<blockquote>
<p><strong>Note:</strong> If no global default is set by the user,
<code>ascli</code> will use <code>global_common_defaults</code> when
setting global parameters (e.g. <code>conf ascp use</code>)</p>
<p><strong>Note:</strong> If you don’t know the name of the global
preset, you can use <code>GLOBAL</code> to refer to it.</p>
</blockquote>
<p>Show current default (global) Option preset (<code>config</code>
plugin):</p>
<pre class="console"><code>$ ascli conf preset get default config
global_common_defaults</code></pre>
<div class="sourceCode" id="cb124"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset set GLOBAL version_check_days 0</span></code></pre></div>
<p>If the default global Option preset is not set, and you want to use a
different name:</p>
<div class="sourceCode" id="cb125"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset set my_common_defaults version_check_days 0</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset set default config my_common_defaults</span></code></pre></div>
<h3 data-number="4.9.5" id="config-sample-commands"><span
class="header-section-number">4.9.5</span> Config sample commands</h3>
<div class="sourceCode" id="cb126"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp connect info <span class="st">&#39;Aspera Connect for Windows&#39;</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp connect list</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp connect version <span class="st">&#39;Aspera Connect for Windows&#39;</span> download <span class="st">&#39;Windows Installer&#39;</span> <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp connect version <span class="st">&#39;Aspera Connect for Windows&#39;</span> list</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp connect version <span class="st">&#39;Aspera Connect for Windows&#39;</span> open documentation</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp errors</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp info <span class="at">--sdk-folder</span><span class="op">=</span>Tsdk_test_dir</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp install</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp install <span class="at">--sdk-folder</span><span class="op">=</span>Tsdk_test_dir</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp products list</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp products use <span class="st">&#39;Aspera Connect&#39;</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp show</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp spec</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> ascp use /usr/bin/ascp</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> check_update</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> coffee</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> coffee <span class="at">--ui</span><span class="op">=</span>text</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> detect https://faspex4.example.com/path</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> detect https://faspex5_jwt.example.com/path</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> detect https://node_simple.example.com/path</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> detect https://shares.example.com/path shares</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> detect my_aoc_org aoc</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> doc</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> doc transfer-parameters</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @base64:SGVsbG8gV29ybGQK</span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @csvt:@stdin:</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @env:USER</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @lines:@stdin:</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @list:,1,2,3</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @secret:</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @uri:/etc/hosts</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @uri:file:/etc/hosts</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @uri:http://ifconfig.me</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @uri:https://ifconfig.me</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @vault:mypreset.password</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo @zlib:@stdin:</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> echo hello</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> email_test <span class="at">--notif-to</span><span class="op">=</span>my_email_external</span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> flush_tokens</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> folder</span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> gem name</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> gem path</span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> gem version</span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> genkey mykey</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> genkey mykey 4096</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> initdemo</span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> open</span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> plugin create mycommand T</span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> plugin list</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset delete conf_name</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset initialize conf_name @json:<span class="st">&#39;{&quot;p1&quot;:&quot;v1&quot;,&quot;p2&quot;:&quot;v2&quot;}&#39;</span></span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset list</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset overview</span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset set conf_name param value</span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset set default shares conf_name</span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset show conf_name</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset unset conf_name param</span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> preset update conf_name <span class="at">--p1</span><span class="op">=</span>v1 <span class="at">--p2</span><span class="op">=</span>v2</span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> proxy_check <span class="at">--fpac</span><span class="op">=</span>@file:examples/proxy.pac https://eudemo.asperademo.com <span class="at">--proxy-credentials</span><span class="op">=</span>@list:,user,pass</span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> vault create mylabel @json:<span class="st">&#39;{&quot;password&quot;:&quot;my_password_here&quot;,&quot;description&quot;:&quot;my secret&quot;}&#39;</span></span>
<span id="cb126-61"><a href="#cb126-61" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> vault delete mylabel</span>
<span id="cb126-62"><a href="#cb126-62" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> vault list</span>
<span id="cb126-63"><a href="#cb126-63" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> vault show mylabel</span>
<span id="cb126-64"><a href="#cb126-64" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard https://console.example.com/path console <span class="at">-Ptst_console</span></span>
<span id="cb126-65"><a href="#cb126-65" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard https://faspex4.example.com/path faspex <span class="at">--username</span><span class="op">=</span>test <span class="at">--password</span><span class="op">=</span>test</span>
<span id="cb126-66"><a href="#cb126-66" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard https://faspex5_jwt.example.com/path faspex5 <span class="at">--pkeypath</span><span class="op">=</span>my_ssh_keys <span class="at">-Ptst_faspex5_jwt</span></span>
<span id="cb126-67"><a href="#cb126-67" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard https://node_simple.example.com/path node <span class="at">--username</span><span class="op">=</span>test <span class="at">--password</span><span class="op">=</span>test</span>
<span id="cb126-68"><a href="#cb126-68" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard https://orch.example.com/path orchestrator <span class="at">--username</span><span class="op">=</span>test <span class="at">--password</span><span class="op">=</span>test</span>
<span id="cb126-69"><a href="#cb126-69" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard https://shares.example.com/path shares <span class="at">--username</span><span class="op">=</span>test <span class="at">--password</span><span class="op">=</span>test</span>
<span id="cb126-70"><a href="#cb126-70" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard my_aoc_org aoc <span class="at">--pkeypath</span><span class="op">=</span> <span class="at">--username</span><span class="op">=</span>my_aoc_user_email</span>
<span id="cb126-71"><a href="#cb126-71" aria-hidden="true" tabindex="-1"></a><span class="ex">config</span> wizard my_aoc_org aoc <span class="at">--pkeypath</span><span class="op">=</span> <span class="at">--username</span><span class="op">=</span>my_aoc_user_email <span class="at">--use-generic-client</span><span class="op">=</span>yes</span></code></pre></div>
<h3 data-number="4.9.6" id="format-of-file"><span
class="header-section-number">4.9.6</span> Format of file</h3>
<p>The configuration file is a Hash in a YAML file. Example:</p>
<div class="sourceCode" id="cb127"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">config</span><span class="kw">:</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.3.7</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">config</span><span class="kw">:</span><span class="at"> cli_default</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">server</span><span class="kw">:</span><span class="at"> demo_server</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cli_default</span><span class="kw">:</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">interactive</span><span class="kw">:</span><span class="at"> </span><span class="ch">no</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="fu">demo_server</span><span class="kw">:</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ssh://demo.asperasoft.com:33001</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">username</span><span class="kw">:</span><span class="at"> asperaweb</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> my_password_here</span></span></code></pre></div>
<p>We can see here:</p>
<ul>
<li>The configuration was created with <code>ascli</code> version
0.3.7</li>
<li>the default <a href="#lprt">option preset</a> to load for
<code>server</code> plugin is : <code>demo_server</code></li>
<li>the <a href="#lprt">option preset</a> <code>demo_server</code>
defines some parameters: the URL and credentials</li>
<li>the default <a href="#lprt">option preset</a> to load in any case is
: <code>cli_default</code></li>
</ul>
<p>Two <a href="#lprt">option presets</a> are reserved:</p>
<ul>
<li><code>config</code> contains a single value: <code>version</code>
showing the version used to create the configuration file. It is used to
check compatibility.</li>
<li><code>default</code> is reserved to define the default <a
href="#lprt">option preset</a> name used for known plugins.</li>
</ul>
<p>The user may create as many <a href="#lprt">option presets</a> as
needed. For instance, a particular <a href="#lprt">option preset</a> can
be created for a particular application instance and contain URL and
credentials.</p>
<p>Values in the configuration also follow the <a
href="#extended">Extended Value Syntax</a>.</p>
<blockquote>
<p><strong>Note:</strong> if the user wants to use the <a
href="#extended">Extended Value Syntax</a> inside the configuration
file, using the <code>config preset update</code> command, the user
shall use the <code>@val:</code> prefix. Example:</p>
</blockquote>
<div class="sourceCode" id="cb128"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set my_aoc_org private_key @val:@file:<span class="st">&quot;</span><span class="va">$HOME</span><span class="st">/.aspera/ascli/my_private_key&quot;</span></span></code></pre></div>
<p>This creates the <a href="#lprt">option preset</a>:</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">...</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co">my_aoc_org:</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">  private_key: @file:&quot;/Users/laurent/.aspera/ascli/my_private_key&quot;</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">...</span></span></code></pre></div>
<p>So, the key file will be read only at execution time, but not be
embedded in the configuration file.</p>
<h3 data-number="4.9.7" id="evaluation-order-of-options"><span
class="header-section-number">4.9.7</span> Evaluation order of
options</h3>
<p>Some options are global, some options are available only for some
plugins. (the plugin is the first level command).</p>
<p>Options are loaded using this algorithm:</p>
<ul>
<li>If option <code>--no-default</code> (or <code>-N</code>) is
specified, then no default value is loaded for the plugin</li>
<li>else it looks for the name of the plugin as key in section
<code>default</code>, the value is the name of the default <a
href="#lprt">option preset</a> for it, and loads it.</li>
<li>If option <code>--preset=&lt;name or extended value hash&gt;</code>
is specified (or <code>-Pxxxx</code>), this reads the <a
href="#lprt">option preset</a> specified from the configuration file, or
of the value is a Hash, it uses it as options values.</li>
<li>Environment variables are evaluated</li>
<li>Command line options are evaluated</li>
</ul>
<p>Parameters are evaluated in the order of command line.</p>
<p>To avoid loading the default <a href="#lprt">option preset</a> for a
plugin, use: <code>-N</code></p>
<p>On command line, words in parameter names are separated by a dash, in
configuration file, separator is an underscore. E.g. –xxx-yyy on command
line gives xxx_yyy in configuration file.</p>
<p>The main plugin name is <code>config</code>, so it is possible to
define a default <a href="#lprt">option preset</a> for the main plugin
with:</p>
<div class="sourceCode" id="cb130"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set cli_default interactive no</span></code></pre></div>
<div class="sourceCode" id="cb131"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default config cli_default</span></code></pre></div>
<p>A <a href="#lprt">option preset</a> value can be removed with
<code>unset</code>:</p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset unset cli_default interactive</span></code></pre></div>
<p>Example: Define options using command line:</p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">-N</span> <span class="at">--url</span><span class="op">=</span>_url_here_ <span class="at">--password</span><span class="op">=</span>my_password_here <span class="at">--username</span><span class="op">=</span>_name_here_ node <span class="at">--show-config</span></span></code></pre></div>
<p>Example: Define options using a Hash:</p>
<div class="sourceCode" id="cb134"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">-N</span> <span class="at">--preset</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;url&quot;:&quot;_url_here_&quot;,&quot;password&quot;:&quot;my_password_here&quot;,&quot;username&quot;:&quot;_name_here_&quot;}&#39;</span> node <span class="at">--show-config</span></span></code></pre></div>
<h3 data-number="4.9.8" id="wizard"><span
class="header-section-number">4.9.8</span> Wizard</h3>
<p>The wizard is a command that asks the user for information and
creates a <a href="#lprt">option preset</a> with the provided
information.</p>
<p>It takes an optional argument: the URL of the application, and an
<strong>option</strong>: <code>query</code> which allows limiting the
detection to a given plugin.</p>
<p>The simplest invication is:</p>
<div class="sourceCode" id="cb135"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config wizard</span></code></pre></div>
<h3 data-number="4.9.9" id="example-of-configuration-for-a-plugin"><span
class="header-section-number">4.9.9</span> Example of configuration for
a plugin</h3>
<p>For Faspex, Shares, Node (including ATS, Aspera Transfer Service),
Console, only username/password and url are required (either on command
line, or from config file). Those can usually be provided on the command
line:</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> shares repo browse / <span class="at">--url</span><span class="op">=</span>https://10.25.0.6 <span class="at">--username</span><span class="op">=</span>john <span class="at">--password</span><span class="op">=</span>my_password_here</span></code></pre></div>
<p>This can also be provisioned in a config file:</p>
<ul>
<li>Build <a href="#lprt">option preset</a></li>
</ul>
<div class="sourceCode" id="cb137"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set shares06 url https://10.25.0.6</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set shares06 username john</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set shares06 password my_password_here</span></code></pre></div>
<p>This can also be done with one single command:</p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset init shares06 @json:<span class="st">&#39;{&quot;url&quot;:&quot;https://10.25.0.6&quot;,&quot;username&quot;:&quot;john&quot;,&quot;password&quot;:&quot;my_password_here&quot;}&#39;</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update shares06 <span class="at">--url</span><span class="op">=</span>https://10.25.0.6 <span class="at">--username</span><span class="op">=</span>john <span class="at">--password</span><span class="op">=</span>my_password_here</span></code></pre></div>
<ul>
<li>Define this <a href="#lprt">option preset</a> as the default <a
href="#lprt">option preset</a> for the specified plugin
(<code>shares</code>)</li>
</ul>
<div class="sourceCode" id="cb140"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default shares shares06</span></code></pre></div>
<ul>
<li>Display the content of configuration file in table format</li>
</ul>
<div class="sourceCode" id="cb141"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset overview</span></code></pre></div>
<ul>
<li>Execute a command on the shares application using default
parameters</li>
</ul>
<div class="sourceCode" id="cb142"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> shares repo browse /</span></code></pre></div>
<h2 data-number="4.10" id="secret-vault"><span
class="header-section-number">4.10</span> <a id="vault"></a>Secret
Vault</h2>
<p>Password and secrets are command options. They can be provided on
command line, env vars, files etc. A more secure option is to retrieve
values from a secret vault.</p>
<p>The vault is used with options <code>vault</code> and
<code>vault_password</code>.</p>
<p><code>vault</code> defines the vault to be used and shall be a Hash,
example:</p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;system&quot;</span><span class="fu">,</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;ascli&quot;</span><span class="fu">}</span></span></code></pre></div>
<p><code>vault_password</code> specifies the password for the vault.
Although it can be specified on command line, for security reason you
can hide the value. For example it can be securely specified on command
line like this:</p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">ASCLI_VAULT_PASSWORD</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="bu">read</span> <span class="at">-s</span> <span class="va">ASCLI_VAULT_PASSWORD</span></span></code></pre></div>
<h3 data-number="4.10.1" id="vault-system-key-chain"><span
class="header-section-number">4.10.1</span> Vault: System key chain</h3>
<blockquote>
<p><strong>Note:</strong> <strong>macOS only</strong></p>
</blockquote>
<p>It is possible to manage secrets in macOS key chain (only read
supported currently).</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--vault=@json:</span><span class="st">&#39;{&quot;type&quot;:&quot;system&quot;,&quot;name&quot;:&quot;ascli&quot;}&#39;</span></span></code></pre></div>
<h3 data-number="4.10.2" id="vault-encrypted-file"><span
class="header-section-number">4.10.2</span> Vault: Encrypted file</h3>
<p>It is possible to store and use secrets encrypted in a file.</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--vault=@json:</span><span class="st">&#39;{&quot;type&quot;:&quot;file&quot;,&quot;name&quot;:&quot;vault.bin&quot;}&#39;</span></span></code></pre></div>
<p><code>name</code> is the file path, absolute or relative to the
config folder <code>ASCLI_HOME</code>.</p>
<h3 data-number="4.10.3" id="vault-operations"><span
class="header-section-number">4.10.3</span> Vault: Operations</h3>
<p>For this use the <code>config vault</code> command.</p>
<p>Then secrets can be manipulated using commands:</p>
<ul>
<li><code>create</code></li>
<li><code>show</code></li>
<li><code>list</code></li>
<li><code>delete</code></li>
</ul>
<div class="sourceCode" id="cb147"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf vault create mylabel @json:<span class="st">&#39;{&quot;password&quot;:&quot;my_password_here&quot;,&quot;description&quot;:&quot;for this account&quot;}&#39;</span></span></code></pre></div>
<h3 data-number="4.10.4" id="configuration-finder"><span
class="header-section-number">4.10.4</span>
<a id="config_finder"></a>Configuration Finder</h3>
<p>When a secret is needed by a sub command, the command can search for
existing configurations in the config file.</p>
<p>The lookup is done by comparing the service URL and username (or
access key).</p>
<h3 data-number="4.10.5" id="securing-passwords-and-secrets"><span
class="header-section-number">4.10.5</span> Securing passwords and
secrets</h3>
<p>A passwords can be saved in clear in a <a href="#lprt">option
preset</a> together with other account information (URL, username,
etc…). Example:</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset update myconf <span class="at">--url</span><span class="op">=</span>... <span class="at">--username</span><span class="op">=</span>... <span class="at">--password</span><span class="op">=</span>...</span></code></pre></div>
<p>For a more secure storage one can do:</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset update myconf <span class="at">--url</span><span class="op">=</span>... <span class="at">--username</span><span class="op">=</span>... <span class="at">--password</span><span class="op">=</span>@val:@vault:myconf.password</span></code></pre></div>
<div class="sourceCode" id="cb150"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf vault create myconf @json:<span class="st">&#39;{&quot;password&quot;:&quot;my_password_here&quot;}&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> use <code>@val:</code> in front of
<code>@vault:</code> so that the extended value is not evaluated.</p>
</blockquote>
<h2 data-number="4.11" id="private-key"><span
class="header-section-number">4.11</span>
<a id="private_key"></a>Private Key</h2>
<p>Some applications allow the user to be authenticated using a private
key (Server, AoC, Faspex5, …). It consists in using a pair of keys: the
private key and its associated public key. The same key can be used for
multiple applications. Technically, a private key contains the public
key, which can be extracted from it. The file containing the private key
can optionally be protected by a passphrase. If the key is protected by
a passphrase, then it will be prompted when used. (some plugins support
option <code>passphrase</code>)</p>
<p>The following commands use the shell variable
<code>PRIVKEYFILE</code>. Set it to the desired safe location of the
private key. Typically, located in folder <code>$HOME/.ssh</code> or
<code>$HOME/.aspera/ascli</code>:</p>
<div class="sourceCode" id="cb151"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="va">PRIVKEYFILE</span><span class="op">=</span>~/.aspera/ascli/my_private_key</span></code></pre></div>
<p>Several methods can be used to generate a key pair.</p>
<p>The format expected for private keys is <a
href="https://en.wikipedia.org/wiki/Privacy-Enhanced_Mail">PEM</a>.</p>
<h3 data-number="4.11.1" id="ascli-for-key-generation"><span
class="header-section-number">4.11.1</span> <code>ascli</code> for key
generation</h3>
<p>The generated key is of type <code>RSA</code>, by default:
<strong>4096</strong> bit. For convenience, the public key is also
extracted with extension <code>.pub</code>. The key is not passphrase
protected.</p>
<div class="sourceCode" id="cb152"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config genkey <span class="va">${PRIVKEYFILE}</span> 4096</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> <code>ascli</code> uses the
<code>openssl</code> library.</p>
</blockquote>
<p>To display the version of <strong>openssl</strong> used in
<code>ascli</code>:</p>
<div class="sourceCode" id="cb153"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config echo @ruby:OpenSSL::OPENSSL_VERSION</span></code></pre></div>
<h3 data-number="4.11.2" id="ssh-keygen"><span
class="header-section-number">4.11.2</span> <code>ssh-keygen</code></h3>
<p>Both private and public keys are generated, option <code>-N</code> is
for passphrase.</p>
<div class="sourceCode" id="cb154"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh-keygen</span> <span class="at">-t</span> rsa <span class="at">-b</span> 4096 <span class="at">-m</span> PEM <span class="at">-N</span> <span class="st">&#39;&#39;</span> <span class="at">-f</span> <span class="va">${PRIVKEYFILE}</span></span></code></pre></div>
<h3 data-number="4.11.3" id="openssl"><span
class="header-section-number">4.11.3</span> <code>openssl</code></h3>
<p>To generate a private key with a passphrase the following can be used
on any system:</p>
<div class="sourceCode" id="cb155"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> genrsa <span class="at">-passout</span> pass:_passphrase_here_ <span class="at">-out</span> <span class="va">${PRIVKEYFILE}</span> 4096</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> rsa <span class="at">-pubout</span> <span class="at">-in</span> <span class="va">${PRIVKEYFILE}</span> <span class="at">-out</span> <span class="va">${PRIVKEYFILE}</span>.pub</span></code></pre></div>
<p><code>openssl</code> is sometimes compiled to support option
<code>-nodes</code> (no DES, i.e. no passphrase, e.g. on macOS). In that
case, add option <code>-nodes</code> instead of
<code>-passout pass:_passphrase_here_</code> to generate a key without
passphrase.</p>
<p>If option <code>-nodes</code> is not available, the passphrase can be
removed using this method:</p>
<div class="sourceCode" id="cb156"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> rsa <span class="at">-passin</span> pass:_passphrase_here_ <span class="at">-in</span> <span class="va">${PRIVKEYFILE}</span> <span class="at">-out</span> <span class="va">${PRIVKEYFILE}</span>.no_des</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">${PRIVKEYFILE}</span>.no_des <span class="va">${PRIVKEYFILE}</span></span></code></pre></div>
<p>To change (or add) the passphrase for a key do:</p>
<div class="sourceCode" id="cb157"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> rsa <span class="at">-des3</span> <span class="at">-in</span> <span class="va">${PRIVKEYFILE}</span> <span class="at">-out</span> <span class="va">${PRIVKEYFILE}</span>.with_des</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> <span class="va">${PRIVKEYFILE}</span>.with_des <span class="va">${PRIVKEYFILE}</span></span></code></pre></div>
<h2 data-number="4.12" id="ssl-ca-certificate-bundle"><span
class="header-section-number">4.12</span> <a id="certificates"></a>SSL
CA certificate bundle</h2>
<p><code>ascli</code> uses the Ruby <code>openssl</code> gem, which uses
the <code>openssl</code> library. Certificates are checked against the
<a
href="https://ruby-doc.org/stdlib-3.0.3/libdoc/openssl/rdoc/OpenSSL/X509/Store.html">Ruby
default certificate store</a>
<code>OpenSSL::X509::DEFAULT_CERT_FILE</code> and
<code>OpenSSL::X509::DEFAULT_CERT_DIR</code>, which are typically the
ones of <code>openssl</code> on Unix-like systems (Linux, macOS,
etc..).</p>
<p>To display the current root certificate store locations:</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @ruby:<span class="st">&#39;[OpenSSL::X509::DEFAULT_CERT_DIR,OpenSSL::X509::DEFAULT_CERT_FILE]&#39;</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb159"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @ruby:<span class="st">&#39;%w[DIR FILE].map{|s|OpenSSL::X509.const_get(&quot;DEFAULT_CERT_&quot;+s)}.join(&quot;\n&quot;)&#39;</span> <span class="at">--format</span><span class="op">=</span>text</span></code></pre></div>
<p>Ruby’s default values can be overridden by env vars:
<code>SSL_CERT_FILE</code> and <code>SSL_CERT_DIR</code>.</p>
<p><code>ascp</code> also needs to validate certificates when using
<strong>WSS</strong>. By default, <code>ascp</code> uses primarily
certificates from hard-coded path (e.g. on macOS:
<code>/Library/Aspera/ssl</code>) for WSS. <code>ascli</code> overrides
and sets the default Ruby certificate path as well for <code>ascp</code>
using <code>-i</code> switch.</p>
<p>To update <code>ascli</code> trusted root certificates, just update
your system’s root certificates or use env vars specified here
above.</p>
<p>An up-to-date version of the certificate bundle can be retrieved
with:</p>
<div class="sourceCode" id="cb160"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @uri:https://curl.haxx.se/ca/cacert.pem <span class="at">--format</span><span class="op">=</span>text</span></code></pre></div>
<p>Once can use this to update the default certificate store:</p>
<div class="sourceCode" id="cb161"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf echo @uri:https://curl.haxx.se/ca/cacert.pem <span class="at">--format</span><span class="op">=</span>text <span class="op">&gt;</span> /tmp/cacert.pem</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">SSL_CERT_FILE</span><span class="op">=</span>/tmp/cacert.pem</span></code></pre></div>
<h2 data-number="4.13" id="plugins"><span
class="header-section-number">4.13</span> Plugins</h2>
<p><code>ascli</code> uses a plugin mechanism. The first level command
(just after <code>ascli</code> on the command line) is the name of the
concerned plugin which will execute the command. Each plugin usually
represents commands sent to a specific application. For instance, the
plugin <code>faspex</code> allows operations on the application “Aspera
Faspex”.</p>
<p>Available plugins can be found using command:</p>
<div class="sourceCode" id="cb162"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf plugin list</span></code></pre></div>
<pre class="output"><code>+--------------+--------------------------------------------------------+
| plugin       | path                                                   |
+--------------+--------------------------------------------------------+
| shares       | ..../aspera-cli/lib/aspera/cli/plugins/shares.rb       |
| node         | ..../aspera-cli/lib/aspera/cli/plugins/node.rb         |
...
+--------------+--------------------------------------------------------+</code></pre>
<h3 data-number="4.13.1" id="create-your-own-plugin"><span
class="header-section-number">4.13.1</span>
<a id="createownplugin"></a>Create your own plugin</h3>
<p>By default plugins are looked-up in folders specified by
(multi-value) option <code>plugin_folder</code>:</p>
<div class="sourceCode" id="cb164"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">--show-config</span> <span class="at">--select</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;key&quot;:&quot;plugin_folder&quot;}&#39;</span></span></code></pre></div>
<p>You can create the skeleton of a new plugin like this:</p>
<div class="sourceCode" id="cb165"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf plugin create foo .</span></code></pre></div>
<pre class="output"><code>Created ./foo.rb</code></pre>
<div class="sourceCode" id="cb167"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">--plugin-folder</span><span class="op">=</span>. foo</span></code></pre></div>
<h3 data-number="4.13.2"
id="plugins-application-url-and-authentication"><span
class="header-section-number">4.13.2</span> <a id="plugins"></a>Plugins:
Application URL and Authentication</h3>
<p><code>ascli</code> comes with several Aspera application plugins.</p>
<p>REST APIs of Aspera legacy applications (Aspera Node, Faspex, Shares,
Console, Orchestrator, Server) use simple username/password
authentication: HTTP Basic Authentication.</p>
<p>Those are using options:</p>
<ul>
<li>url</li>
<li>username</li>
<li>password</li>
</ul>
<p>Those can be provided using command line, parameter set, env var, see
section above.</p>
<p>Aspera on Cloud relies on Oauth, refer to the <a href="#aoc">Aspera
on Cloud</a> section.</p>
<h2 data-number="4.14" id="logging-debugging"><span
class="header-section-number">4.14</span> Logging, Debugging</h2>
<p>The gem is equipped with traces, mainly for debugging and learning
APIs. By default logging level is <code>warn</code> and the output
channel is <code>stderr</code>. To increase debug level, use parameter
<code>log_level</code> (e.g. using command line
<code>--log-level=xx</code>, env var <code>ASCLI_LOG_LEVEL</code>, or a
parameter in the configuration file).</p>
<p>It is also possible to activate traces before log facility
initialization using env var <code>ASCLI_LOG_LEVEL</code>.</p>
<p>By default passwords and secrets are removed from logs. Use option
<code>log_secrets</code> set to <code>yes</code> to reveal secrets in
logs.</p>
<p>Available loggers: <code>stdout</code>, <code>stderr</code>,
<code>syslog</code>.</p>
<p>Available levels: <code>debug</code>, <code>info</code>,
<code>warn</code>, <code>error</code>.</p>
<blockquote>
<p><strong>Note:</strong> When using the <code>direct</code> agent
(<code>ascp</code>), additional transfer logs can be activated using
<code>ascp</code> options and <code>ascp_args</code>, see <a
href="#agt_direct"><code>direct</code></a>.</p>
</blockquote>
<p>Examples:</p>
<ul>
<li>display debugging log on <code>stdout</code>:</li>
</ul>
<div class="sourceCode" id="cb168"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf pre over <span class="at">--log-level</span><span class="op">=</span>debug <span class="at">--logger</span><span class="op">=</span>stdout</span></code></pre></div>
<ul>
<li>log errors to <code>syslog</code>:</li>
</ul>
<div class="sourceCode" id="cb169"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf pre over <span class="at">--log-level</span><span class="op">=</span>error <span class="at">--logger</span><span class="op">=</span>syslog</span></code></pre></div>
<p>When <code>ascli</code> is used interactively in a shell, the shell
itself will usually log executed commands in the history file.</p>
<h2 data-number="4.15" id="learning-aspera-product-apis-rest"><span
class="header-section-number">4.15</span> Learning Aspera Product APIs
(REST)</h2>
<p><code>ascli</code> uses mainly Aspera applications REST APIs. To
display HTTP calls, use argument <code>-r</code> or
<code>--rest-debug</code>, this is useful to display exact content of
HTTP requests and responses.</p>
<p>In order to get traces of execution, use argument :
<code>--log-level=debug</code></p>
<h2 data-number="4.16" id="http-socket-parameters"><span
class="header-section-number">4.16</span> <a id="http_options"></a>HTTP
socket parameters</h2>
<p>If the server does not provide a valid certificate, use option:
<code>--insecure=yes</code>.</p>
<p>HTTP socket parameters can be adjusted using option
<code>http_options</code>:</p>
<table>
<thead>
<tr class="header">
<th>parameter</th>
<th>default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>read_timeout</code></td>
<td>60</td>
</tr>
<tr class="even">
<td><code>write_timeout</code></td>
<td>60</td>
</tr>
<tr class="odd">
<td><code>open_timeout</code></td>
<td>60</td>
</tr>
<tr class="even">
<td><code>keep_alive_timeout</code></td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Values are in set <em>seconds</em> and can be of type either integer
or float. Default values are the ones of Ruby: refer to the Ruby
library: <a
href="https://ruby-doc.org/stdlib/libdoc/net/http/rdoc/Net/HTTP.html"><code>Net::HTTP</code></a>.</p>
<p>Like any other option, those can be set either on command line, or in
config file, either in a global preset or server-specific one.</p>
<p>Example:</p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res package list <span class="at">--http-options</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;read_timeout&quot;:10.0}&#39;</span></span></code></pre></div>
<h2 data-number="4.17"
id="graphical-interactions-browser-and-text-editor"><span
class="header-section-number">4.17</span>
<a id="graphical"></a>Graphical Interactions: Browser and Text
Editor</h2>
<p>Some actions may require the use of a graphical tool:</p>
<ul>
<li>a browser for Aspera on Cloud authentication (web auth method)</li>
<li>a text editor for configuration file edition</li>
</ul>
<p>By default <code>ascli</code> assumes that a graphical environment is
available on Windows, and on other systems, rely on the presence of the
<code>DISPLAY</code> environment variable. It is also possible to force
the graphical mode with option –ui :</p>
<ul>
<li><code>--ui=graphical</code> forces a graphical environment, a
browser will be opened for URLs or a text editor for file edition.</li>
<li><code>--ui=text</code> forces a text environment, the URL or file
path to open is displayed on terminal.</li>
</ul>
<h2 data-number="4.18" id="proxy"><span
class="header-section-number">4.18</span> Proxy</h2>
<p>There are several types of network connections, each of them use a
different mechanism to define a (forward) <strong>proxy</strong>:</p>
<ul>
<li>Ruby HTTP: REST and HTTPGW client</li>
<li>Legacy Aspera HTTP/S Fallback</li>
<li>Aspera FASP</li>
</ul>
<p>Refer to the following sections.</p>
<h2 data-number="4.19" id="proxy-for-rest-and-httpgw"><span
class="header-section-number">4.19</span> Proxy for REST and HTTPGW</h2>
<p>There are two possibilities to define an HTTP proxy to be used when
Ruby HTTP is used.</p>
<p>The <code>http_proxy</code> environment variable (<strong>lower
case</strong>, preferred) can be set to the URL of the proxy. E.g.
<code>http://myproxy.org.net:3128</code>. Refer to <a
href="https://rubyapi.org/3.0/o/uri/generic#method-i-find_proxy">Ruby
find proxy</a>.</p>
<blockquote>
<p><strong>Note:</strong> Ruby expects a URL and
<code>myproxy.org.net:3128</code> alone is <strong>not</strong>
accepted.</p>
</blockquote>
<div class="sourceCode" id="cb171"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">http_proxy</span><span class="op">=</span>http://proxy.example.com:3128</span></code></pre></div>
<p>The <code>fpac</code> option (function for proxy auto config) can be
set to a <a href="https://en.wikipedia.org/wiki/Proxy_auto-config">Proxy
Auto Configuration (PAC)</a> javascript value. To read the script from a
URL (<code>http:</code>, <code>https:</code> and <code>file:</code>),
use prefix: <code>@uri:</code>. A minimal script can be specified to
define the use of a local proxy:</p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">--fpac</span><span class="op">=</span><span class="st">&#39;function FindProxyForURL(url, host){return &quot;PROXY localhost:3128&quot;}&#39;</span> ...</span></code></pre></div>
<p>The result of a PAC file can be tested with command:
<code>config proxy_check</code>. Example, using command line option:</p>
<div class="sourceCode" id="cb173"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf proxy_check <span class="at">--fpac</span><span class="op">=</span><span class="st">&#39;function FindProxyForURL(url, host) {return &quot;PROXY proxy.example.com:3128;DIRECT&quot;;}&#39;</span> http://example.com</span></code></pre></div>
<pre class="text"><code>PROXY proxy.example.com:1234;DIRECT</code></pre>
<div class="sourceCode" id="cb175"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config proxy_check <span class="at">--fpac</span><span class="op">=</span>@file:./proxy.pac http://www.example.com</span></code></pre></div>
<pre class="text"><code>PROXY proxy.example.com:8080</code></pre>
<div class="sourceCode" id="cb177"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config proxy_check <span class="at">--fpac</span><span class="op">=</span>@uri:http://server/proxy.pac http://www.example.com</span></code></pre></div>
<pre class="text"><code>PROXY proxy.example.com:8080</code></pre>
<p>If the proxy requires credentials, then use option
<code>proxy_credentials</code> with username and password provided as an
<code>Array</code>:</p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">--proxy-credentials</span><span class="op">=</span>@json:<span class="st">&#39;[&quot;__username_here__&quot;,&quot;__password_here__&quot;]&#39;</span> ...</span></code></pre></div>
<div class="sourceCode" id="cb180"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">--proxy-credentials</span><span class="op">=</span>@list::__username_here__:__password_here__ ...</span></code></pre></div>
<h2 data-number="4.20" id="proxy-for-legacy-aspera-https-fallback"><span
class="header-section-number">4.20</span> Proxy for Legacy Aspera HTTP/S
Fallback</h2>
<p>Only supported with the <code>direct</code> agent: To specify a proxy
for legacy HTTP fallback, use <code>ascp</code> native option
<code>-x</code> and <code>ascp_args</code>:
<code>--transfer-info=@json:'{"ascp_args":["-x","url_here"]}'</code>.
Alternatively, set the <a
href="#transferspec"><em>transfer-spec</em></a> parameter:
<code>EX_http_proxy_url</code>.</p>
<h2 data-number="4.21" id="fasp-proxy-forward-for-transfers"><span
class="header-section-number">4.21</span> FASP proxy (forward) for
transfers</h2>
<p>To specify a FASP proxy (forward), set the <a
href="#transferspec"><em>transfer-spec</em></a> parameter:
<code>proxy</code> (only supported with the <code>direct</code>
agent).</p>
<h2 data-number="4.22" id="fasp-configuration"><span
class="header-section-number">4.22</span> <a id="client"></a>FASP
configuration</h2>
<p>The <code>config</code> plugin also allows specification for the use
of a local FASP <strong>client</strong>. It provides the following
commands for <code>ascp</code> subcommand:</p>
<ul>
<li><code>show</code> : shows the path of <code>ascp</code> used</li>
<li><code>use</code> : list,download connect client versions available
on internet</li>
<li><code>products</code> : list Aspera transfer products available
locally</li>
<li><code>connect</code> : list,download connect client versions
available on internet</li>
</ul>
<h3 data-number="4.22.1" id="show-path-of-currently-used-ascp"><span
class="header-section-number">4.22.1</span> Show path of currently used
<code>ascp</code></h3>
<div class="sourceCode" id="cb181"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp show</span></code></pre></div>
<pre class="output"><code>/Users/laurent/.aspera/ascli/sdk/ascp</code></pre>
<div class="sourceCode" id="cb183"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp info</span></code></pre></div>
<pre class="output"><code>+--------------------+-----------------------------------------------------------+
| key                | value                                                     |
+--------------------+-----------------------------------------------------------+
| ascp               | /Users/laurent/.aspera/ascli/sdk/ascp                     |
...</code></pre>
<h3 data-number="4.22.2"
id="selection-of-ascp-location-for-direct-agent"><span
class="header-section-number">4.22.2</span> Selection of
<code>ascp</code> location for <a
href="#agt_direct"><code>direct</code></a> agent</h3>
<p>By default, <code>ascli</code> uses any found local product with
<code>ascp</code>, including SDK.</p>
<p>To temporarily use an alternate <code>ascp</code> path use option
<code>ascp_path</code> (<code>--ascp-path=</code>)</p>
<p>For a permanent change, the command <code>config ascp use</code> sets
the same parameter for the global default.</p>
<p>Using a POSIX shell:</p>
<div class="sourceCode" id="cb185"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp use @path:<span class="st">&#39;~/Applications/Aspera CLI/bin/ascp&#39;</span></span></code></pre></div>
<pre class="output"><code>ascp version: 4.0.0.182279
Updated: global_common_defaults: ascp_path &lt;- /Users/laurent/Applications/Aspera CLI/bin/ascp
Saved to default global preset global_common_defaults</code></pre>
<p>Windows:</p>
<pre class="text"><code>ascli config ascp use C:\Users\admin\.aspera\ascli\sdk\ascp.exe</code></pre>
<pre class="output"><code>ascp version: 4.0.0.182279
Updated: global_common_defaults: ascp_path &lt;- C:\Users\admin\.aspera\ascli\sdk\ascp.exe
Saved to default global preset global_common_defaults</code></pre>
<p>If the path has spaces, read section: <a href="#parsing">Shell and
Command line parsing</a>.</p>
<h3 data-number="4.22.3"
id="list-locally-installed-aspera-transfer-products"><span
class="header-section-number">4.22.3</span> List locally installed
Aspera Transfer products</h3>
<p>Locally installed Aspera products can be listed with:</p>
<div class="sourceCode" id="cb189"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp products list</span></code></pre></div>
<pre class="output"><code>+---------------------------------------+----------------------------------------+
| name                                  | app_root                               |
+---------------------------------------+----------------------------------------+
| IBM Aspera SDK                        | /Users/laurent/.aspera/ascli/sdk       |
| Aspera Connect                        | /Applications/Aspera Connect.app       |
| IBM Aspera CLI                        | /Users/laurent/Applications/Aspera CLI |
| IBM Aspera High-Speed Transfer Server | /Library/Aspera                        |
+---------------------------------------+----------------------------------------+</code></pre>
<h3 data-number="4.22.4"
id="selection-of-local-client-for-ascp-for-direct-agent"><span
class="header-section-number">4.22.4</span> Selection of local client
for <code>ascp</code> for <a href="#agt_direct"><code>direct</code></a>
agent</h3>
<p>If no <code>ascp</code> is selected, this is equivalent to using
option: <code>--use-product=FIRST</code>.</p>
<p>Using the option use_product finds the <code>ascp</code> binary of
the selected product.</p>
<p>To permanently use the <code>ascp</code> of a product:</p>
<div class="sourceCode" id="cb191"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp products use <span class="st">&#39;Aspera Connect&#39;</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="ex">saved</span> to default global preset /Users/laurent/Applications/Aspera Connect.app/Contents/Resources/ascp</span></code></pre></div>
<h3 data-number="4.22.5"
id="installation-of-connect-client-on-command-line"><span
class="header-section-number">4.22.5</span> Installation of Connect
Client on command line</h3>
<div class="sourceCode" id="cb192"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp connect list</span></code></pre></div>
<pre class="output"><code>+-----------------------------------------------+--------------------------------------+-----------+
| id                                            | title                                | version   |
+-----------------------------------------------+--------------------------------------+-----------+
| urn:uuid:589F9EE5-0489-4F73-9982-A612FAC70C4E | Aspera Connect for Windows           | 3.11.2.63 |
| urn:uuid:A3820D20-083E-11E2-892E-0800200C9A66 | Aspera Connect for Windows 64-bit    | 3.11.2.63 |
| urn:uuid:589F9EE5-0489-4F73-9982-A612FAC70C4E | Aspera Connect for Windows XP        | 3.11.2.63 |
| urn:uuid:55425020-083E-11E2-892E-0800200C9A66 | Aspera Connect for Windows XP 64-bit | 3.11.2.63 |
| urn:uuid:D8629AD2-6898-4811-A46F-2AF386531BFF | Aspera Connect for Mac Intel         | 3.11.2.63 |
| urn:uuid:97F94DF0-22B1-11E2-81C1-0800200C9A66 | Aspera Connect for Linux 64          | 3.11.2.63 |
+-----------------------------------------------+--------------------------------------+-----------+</code></pre>
<div class="sourceCode" id="cb194"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp connect version <span class="st">&#39;Aspera Connect for Mac Intel&#39;</span> list</span></code></pre></div>
<pre class="output"><code>+-------------------------------------------+--------------------------+-----------------------------------------------------------------------------------------+----------+---------------------+
| title                                     | type                     | href                                                                                    | hreflang | rel                 |
+-------------------------------------------+--------------------------+-----------------------------------------------------------------------------------------+----------+---------------------+
| Mac Intel Installer                       | application/octet-stream | bin/IBMAsperaConnectInstaller-3.11.2.63.dmg                                             | en       | enclosure           |
| Mac Intel Installer                       | application/octet-stream | bin/IBMAsperaConnectInstallerOneClick-3.11.2.63.dmg                                     | en       | enclosure-one-click |
| Aspera Connect for Mac HTML Documentation | text/html                | https://www.ibm.com/docs/en/aspera-connect/3.11?topic=aspera-connect-user-guide-macos   | en       | documentation       |
| Aspera Connect for Mac Release Notes      | text/html                | https://www.ibm.com/docs/en/aspera-connect/3.11?topic=notes-release-aspera-connect-3112 | en       | release-notes       |
+-------------------------------------------+--------------------------+-----------------------------------------------------------------------------------------+----------+---------------------+</code></pre>
<div class="sourceCode" id="cb196"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp connect version <span class="st">&#39;Aspera Connect for Mac Intel&#39;</span> download enclosure <span class="at">--to-folder</span><span class="op">=</span>.</span></code></pre></div>
<pre class="output"><code>Time: 00:00:02 ============================================= 100% 27766 KB/sec Time: 00:00:02
Downloaded: IBMAsperaConnectInstaller-3.11.2.63.dmg</code></pre>
<h2 data-number="4.23" id="transfer-clients-agents"><span
class="header-section-number">4.23</span> <a id="agents"></a>Transfer
Clients: Agents</h2>
<p>Some of the actions on Aspera Applications lead to file transfers
(upload and download) using the FASP protocol (<code>ascp</code>).</p>
<p>When a transfer needs to be started, a <a
href="#transferspec"><em>transfer-spec</em></a> has been internally
prepared. This <a href="#transferspec"><em>transfer-spec</em></a> will
be executed by a transfer client, here called <strong>Transfer
Agent</strong>.</p>
<p>There are currently 3 agents, set with option
<code>transfer</code>:</p>
<ul>
<li><a href="#agt_direct"><code>direct</code></a> : a local execution of
<code>ascp</code></li>
<li><a href="#agt_connect"><code>connect</code></a> : use of a local
Connect Client</li>
<li><a href="#agt_node"><code>node</code></a> : use of an Aspera
Transfer Node (potentially <em>remote</em>).</li>
<li><a href="#agt_httpgw"><code>httpgw</code></a> : use of an Aspera
HTTP Gateway</li>
<li><a href="#agt_trsdk"><code>trsdk</code></a> : use of Aspera Transfer
SDK</li>
</ul>
<blockquote>
<p><strong>Note:</strong> All transfer operations are seen from the
point of view of the agent. For example, a node agent executing an
“upload”, or “package send” operation will effectively push files to the
related server from the agent node.</p>
</blockquote>
<p><code>ascli</code> standardizes on the use of a <a
href="#transferspec"><em>transfer-spec</em></a> instead of
<em>native</em> <code>ascp</code> options to provide parameters for a
transfer session, as a common method for those three Transfer
Agents.</p>
<p>Specific options for agents are provided with option
<code>transfer_info</code>, cumulatively.</p>
<h3 data-number="4.23.1" id="direct"><span
class="header-section-number">4.23.1</span>
<a id="agt_direct"></a>Direct</h3>
<p>The <code>direct</code> agent directly executes a local
<code>ascp</code>. This is the default agent for <code>ascli</code>.
This is equivalent to option <code>--transfer=direct</code>.
<code>ascli</code> will search locally installed Aspera products,
including SDK, and use <code>ascp</code> from that component. Refer to
section <a href="#client">FASP</a>.</p>
<p>The <code>transfer_info</code> option accepts the following optional
parameters to control multi-session, Web Socket Session and Resume
policy:</p>
<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 16%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>wss</td>
<td>Bool</td>
<td>Web Socket Session<br/>Enable use of web socket session in case it
is available<br/>Default: true</td>
</tr>
<tr class="even">
<td>ascp_args</td>
<td>Array</td>
<td>Array of strings with native ascp arguments<br/>Use this instead of
deprecated <code>EX_ascp_args</code>.<br/>Default: []</td>
</tr>
<tr class="odd">
<td>spawn_timeout_sec</td>
<td>Float</td>
<td>Multi session<br/>Verification time that <code>ascp</code> is
running<br/>Default: 3</td>
</tr>
<tr class="even">
<td>spawn_delay_sec</td>
<td>Float</td>
<td>Multi session<br/>Delay between startup of sessions<br/>Default:
2</td>
</tr>
<tr class="odd">
<td>multi_incr_udp</td>
<td>Bool</td>
<td>Multi Session<br/>Increment UDP port on multi-session<br/>If true,
each session will have a different UDP port starting at
<code>fasp_port</code> (or default 33001)<br/>Else, each session will
use <code>fasp_port</code> (or <code>ascp</code> default)<br/>Default:
true</td>
</tr>
<tr class="even">
<td>resume</td>
<td>Hash</td>
<td>Resume<br/>parameters<br/>See below</td>
</tr>
<tr class="odd">
<td>resume.iter_max</td>
<td>int</td>
<td>Resume<br/>Max number of retry on error<br/>Default: 7</td>
</tr>
<tr class="even">
<td>resume.sleep_initial</td>
<td>int</td>
<td>Resume<br/>First Sleep before retry<br/>Default: 2</td>
</tr>
<tr class="odd">
<td>resume.sleep_factor</td>
<td>int</td>
<td>Resume<br/>Multiplier of sleep period between attempts<br/>Default:
2</td>
</tr>
<tr class="even">
<td>resume.sleep_max</td>
<td>int</td>
<td>Resume<br/>Default: 60</td>
</tr>
</tbody>
</table>
<p>In case of transfer interruption, the agent will
<strong>resume</strong> a transfer up to <code>iter_max</code> time.
Sleep between iterations is:</p>
<div class="sourceCode" id="cb198"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="ex">max</span><span class="er">(</span> <span class="ex">sleep_max</span> , sleep_initial <span class="pp">*</span> sleep_factor ^ <span class="er">(</span><span class="ex">iter_index-1</span><span class="kw">)</span> <span class="kw">)</span></span></code></pre></div>
<p>Some transfer errors are considered “retryable” (e.g. timeout) and
some other not (e.g. wrong password). The list of known protocol errors
and retry level can be listed:</p>
<div class="sourceCode" id="cb199"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp errors</span></code></pre></div>
<p>Examples:</p>
<div class="sourceCode" id="cb200"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ... <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;wss&quot;:true,&quot;resume&quot;:{&quot;iter_max&quot;:20}}&#39;</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ... <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;spawn_delay_sec&quot;:2.5,&quot;multi_incr_udp&quot;:false}&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> The <code>direct</code> agent supports
additional <code>transfer_spec</code> parameters starting with
<code>EX_</code> (extended). But it is preferred to use the option
<code>transfer_info</code> with parameter <code>ascp_args</code>.</p>
</blockquote>
<p>This can be useful to activate logging using option <code>-L</code>
of <code>ascp</code>. For example, to activate debug level 2 for
<code>ascp</code> (<code>DD</code>), and display those logs on the
terminal (<code>-</code>):</p>
<div class="sourceCode" id="cb201"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--transfer-info=@json:</span><span class="st">&#39;{&quot;ascp_args&quot;:[&quot;-DDL-&quot;]}&#39;</span></span></code></pre></div>
<p>This is useful to debug if a transfer fails.</p>
<p>To store <code>ascp</code> logs in file
<code>aspera-scp-transfer.log</code> in a folder, use
<code>--transfer-info=@json:'{"ascp_args":["-L","/path/to/folder"]}'</code>.</p>
<blockquote>
<p><strong>Note:</strong> When transfer agent <a
href="#agt_direct"><code>direct</code></a> is used, the list of files to
transfer is provided to <code>ascp</code> using either
<code>--file-list</code> or <code>--file-pair-list</code> and a file
list (or pair) file generated in a temporary folder. (unless
<code>--file-list</code> or <code>--file-pair-list</code> is provided
using <code>transfer_info</code> parameter <code>ascp_args</code>).</p>
</blockquote>
<p>In addition to standard methods described in section <a
href="#file_list">File List</a>, it is possible to specify the list of
file using those additional methods:</p>
<ul>
<li>Using the pseudo <a href="#transferspec"><em>transfer-spec</em></a>
parameter <code>EX_file_list</code></li>
</ul>
<div class="sourceCode" id="cb202"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--sources=@ts</span> <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;EX_file_list&quot;:&quot;file_list.txt&quot;}&#39;</span></span></code></pre></div>
<ul>
<li>Using option <code>transfer_info</code> parameter
<code>ascp_args</code></li>
</ul>
<div class="sourceCode" id="cb203"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--sources=@ts</span> <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;ascp_args&quot;:[&quot;--file-list&quot;,&quot;myfilelist&quot;]}&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> File lists is shown here, there are also
similar options for file pair lists.</p>
<p><strong>Note:</strong> Those 2 additional methods avoid the creation
of a copy of the file list: if the standard options
<code>--sources=@lines:@file:... --src-type=...</code> are used, then
the file is list read and parsed, and a new file list is created in a
temporary folder.</p>
<p><strong>Note:</strong> Those methods have limitations: they apply
<strong>only</strong> to the <a
href="#agt_direct"><code>direct</code></a> transfer agent (i.e. local
<code>ascp</code>) and not for Aspera on Cloud.</p>
</blockquote>
<p>This agent supports a local configuration file:
<code>aspera.conf</code> where Virtual links can be configured:</p>
<p>On a server (HSTS), the following commands can be used to set a
global virtual link:</p>
<div class="sourceCode" id="cb204"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="ex">asconfigurator</span> <span class="at">-x</span> <span class="st">&#39;set_trunk_data;id,1;trunk_name,in;trunk_capacity,45000;trunk_on,true&#39;</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="ex">asconfigurator</span> <span class="at">-x</span> <span class="st">&#39;set_trunk_data;id,2;trunk_name,out;trunk_capacity,45000;trunk_on,true&#39;</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="ex">asconfigurator</span> <span class="at">-x</span> <span class="st">&#39;set_node_data;transfer_in_bandwidth_aggregate_trunk_id,1&#39;</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="ex">asconfigurator</span> <span class="at">-x</span> <span class="st">&#39;set_node_data;transfer_out_bandwidth_aggregate_trunk_id,2&#39;</span></span></code></pre></div>
<p>But this command is not available on clients, so edit the file
<code>aspera.conf</code>, you can find the location with:
<code>ascli conf ascp info --fields=aspera_conf</code> and modify the
sections <code>default</code> and <code>trunks</code> like this for a
global 100 Mbps virtual link:</p>
<div class="sourceCode" id="cb205"><pre
class="sourceCode xml"><code class="sourceCode xml"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">&#39;1.0&#39;</span><span class="ot"> encoding=</span><span class="st">&#39;UTF-8&#39;</span><span class="fu">?&gt;</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">CONF</span><span class="ot"> version=</span><span class="st">&quot;2&quot;</span>&gt;</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">default</span>&gt;</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">transfer</span>&gt;</span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">in</span>&gt;</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">bandwidth</span>&gt;</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">aggregate</span>&gt;</span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">trunk_id</span>&gt;1&lt;/<span class="kw">trunk_id</span>&gt;</span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">aggregate</span>&gt;</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">bandwidth</span>&gt;</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">in</span>&gt;</span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">out</span>&gt;</span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">bandwidth</span>&gt;</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">aggregate</span>&gt;</span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">trunk_id</span>&gt;2&lt;/<span class="kw">trunk_id</span>&gt;</span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">aggregate</span>&gt;</span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">bandwidth</span>&gt;</span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">out</span>&gt;</span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">transfer</span>&gt;</span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">default</span>&gt;</span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">trunks</span>&gt;</span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">trunk</span>&gt;</span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">id</span>&gt;1&lt;/<span class="kw">id</span>&gt;</span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">name</span>&gt;in&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">on</span>&gt;true&lt;/<span class="kw">on</span>&gt;</span>
<span id="cb205-26"><a href="#cb205-26" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">capacity</span>&gt;</span>
<span id="cb205-27"><a href="#cb205-27" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">schedule</span><span class="ot"> format=</span><span class="st">&quot;ranges&quot;</span>&gt;1000000&lt;/<span class="kw">schedule</span>&gt;</span>
<span id="cb205-28"><a href="#cb205-28" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">capacity</span>&gt;</span>
<span id="cb205-29"><a href="#cb205-29" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">trunk</span>&gt;</span>
<span id="cb205-30"><a href="#cb205-30" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">trunk</span>&gt;</span>
<span id="cb205-31"><a href="#cb205-31" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">id</span>&gt;2&lt;/<span class="kw">id</span>&gt;</span>
<span id="cb205-32"><a href="#cb205-32" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">name</span>&gt;out&lt;/<span class="kw">name</span>&gt;</span>
<span id="cb205-33"><a href="#cb205-33" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">capacity</span>&gt;</span>
<span id="cb205-34"><a href="#cb205-34" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">schedule</span><span class="ot"> format=</span><span class="st">&quot;ranges&quot;</span>&gt;1000000&lt;/<span class="kw">schedule</span>&gt;</span>
<span id="cb205-35"><a href="#cb205-35" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">capacity</span>&gt;</span>
<span id="cb205-36"><a href="#cb205-36" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">on</span>&gt;true&lt;/<span class="kw">on</span>&gt;</span>
<span id="cb205-37"><a href="#cb205-37" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">trunk</span>&gt;</span>
<span id="cb205-38"><a href="#cb205-38" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">trunks</span>&gt;</span>
<span id="cb205-39"><a href="#cb205-39" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">CONF</span>&gt;</span></code></pre></div>
<p>It is also possible to set a schedule with different time and days,
for example for the value of <code>schedule</code>:</p>
<pre class="text"><code>start=08 end=19 days=mon,tue,wed,thu capacity=900000;1000000</code></pre>
<h3 data-number="4.23.2" id="ibm-aspera-connect-client-gui"><span
class="header-section-number">4.23.2</span> <a id="agt_connect"></a>IBM
Aspera Connect Client GUI</h3>
<p>By specifying option: <code>--transfer=connect</code>,
<code>ascli</code> will start transfers using the locally installed
Aspera Connect Client. There are no option for
<code>transfer_info</code>.</p>
<h3 data-number="4.23.3"
id="aspera-node-api-node-to-node-transfers"><span
class="header-section-number">4.23.3</span> <a id="agt_node"></a>Aspera
Node API : Node to node transfers</h3>
<p>By specifying option: <code>--transfer=node</code>,
<code>ascli</code> starts transfers in an Aspera Transfer Server using
the Node API, either on a local or remote node. Parameters provided in
option <code>transfer_info</code> are:</p>
<table>
<colgroup>
<col style="width: 32%" />
<col style="width: 25%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>url</td>
<td>string</td>
<td>URL of the node API</br>Mandatory</td>
</tr>
<tr class="even">
<td>username</td>
<td>string</td>
<td>node api user or access key</br>Mandatory</td>
</tr>
<tr class="odd">
<td>password</td>
<td>string</td>
<td>password, secret or bearer token</br>Mandatory</td>
</tr>
<tr class="even">
<td>root_id</td>
<td>string</td>
<td>password or secret</br>Mandatory only for bearer token</td>
</tr>
</tbody>
</table>
<p>Like any other option, <code>transfer_info</code> can get its value
from a pre-configured <a href="#lprt">option preset</a> :</p>
<div class="sourceCode" id="cb207"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--transfer-info=@preset:_name_here_</span></span></code></pre></div>
<p>or be specified using the extended value syntax :</p>
<div class="sourceCode" id="cb208"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--transfer-info=@json:</span><span class="st">&#39;{&quot;url&quot;:&quot;https://...&quot;,&quot;username&quot;:&quot;_user_here_&quot;,&quot;password&quot;:&quot;my_password_here&quot;}&#39;</span></span></code></pre></div>
<p>If <code>transfer_info</code> is not specified and a default node has
been configured (name in <code>node</code> for section
<code>default</code>) then this node is used by default.</p>
<p>If the <code>password</code> value begins with <code>Bearer</code>
then the <code>username</code> is expected to be an access key and the
parameter <code>root_id</code> is mandatory and specifies the root file
id on the node. It can be either the access key’s root file id, or any
authorized file id underneath it.</p>
<h3 data-number="4.23.4" id="http-gateway"><span
class="header-section-number">4.23.4</span> <a id="agt_httpgw"></a>HTTP
Gateway</h3>
<p>If it possible to send using a HTTP gateway, in case use of FASP is
not allowed.</p>
<p>Parameters provided in option <code>transfer_info</code> are:</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 11%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>url</td>
<td>string</td>
<td>URL of the HTTP GW</br>Mandatory</td>
</tr>
<tr class="even">
<td>upload_bar_refresh_sec</td>
<td>float</td>
<td>Refresh rate for upload progress bar</td>
</tr>
<tr class="odd">
<td>upload_chunk_size</td>
<td>int</td>
<td>Size in bytes of chunks for upload</td>
</tr>
<tr class="even">
<td>api_version</td>
<td>string</td>
<td>v1 or v2, for force use of version</td>
</tr>
<tr class="odd">
<td>synchronous</td>
<td>bool</td>
<td>wait for each message acknowledgment</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="sourceCode" id="cb209"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package recv 323 <span class="at">--transfer</span><span class="op">=</span>httpgw <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;url&quot;:&quot;https://asperagw.example.com:9443/aspera/http-gwy&quot;}&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> The gateway only supports transfers authorized
with a token.</p>
</blockquote>
<h3 data-number="4.23.5" id="transfer-sdk"><span
class="header-section-number">4.23.5</span>
<a id="agt_trsdk"></a>Transfer SDK</h3>
<p>Another possibility is to use the Transfer SDK daemon
(<code>asperatransferd</code>).</p>
<p>By default it will listen on local port <code>55002</code> on
<code>127.0.0.1</code>.</p>
<p>The gem <code>grpc</code> was removed from dependencies, as it
requires compilation of a native part. So, to use the Transfer SDK you
should install this gem:</p>
<div class="sourceCode" id="cb210"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="ex">gem</span> install grpc</span></code></pre></div>
<p>On Windows the compilation may fail for various reasons (3.1.1):</p>
<!-- spellchecker: disable -->
<ul>
<li><p><code>cannot find -lx64-ucrt-ruby310</code></p>
<p>→ copy the file
<code>[Ruby main dir]\lib\libx64-ucrt-ruby310.dll.a</code> to
<code>[Ruby main dir]\lib\libx64-ucrt-ruby310.a</code> (remove the dll
extension)</p></li>
<li><p><code>conflicting types for 'gettimeofday'</code></p>
<p>→ edit the file
<code>[Ruby main dir]/include/ruby-[version]/ruby/win32.h</code> and
change the signature of <code>gettimeofday</code> to
<code>gettimeofday(struct timeval *, void *)</code> ,i.e. change
<code>struct timezone</code> to <code>void</code></p></li>
</ul>
<!-- spellchecker: enable -->
<h2 data-number="4.24" id="transfer-specification"><span
class="header-section-number">4.24</span>
<a id="transferspec"></a>Transfer Specification</h2>
<p>Some commands lead to file transfer (upload/download). All parameters
necessary for this transfer are described in a <a
href="#transferspec"><em>transfer-spec</em></a> (Transfer
Specification), such as:</p>
<ul>
<li>server address</li>
<li>transfer user name</li>
<li>credentials</li>
<li>file list</li>
<li>etc…</li>
</ul>
<p><code>ascli</code> builds the <a
href="#transferspec"><em>transfer-spec</em></a> internally, so it is not
necessary to provide additional parameters on the command line for this
transfer.</p>
<p>The <a href="#transferspec"><em>transfer-spec</em></a> is a Hash
(dictionary), so it is described on the command line with the <a
href="#extended">Extended Value Syntax</a>.</p>
<p>It is possible to modify or add any of the supported <a
href="#transferspec"><em>transfer-spec</em></a> parameter using the
<code>ts</code> option. The <code>ts</code> option accepts a <a
href="#native">Structured Value</a> containing one or several <a
href="#transferspec"><em>transfer-spec</em></a> parameters in a
<code>Hash</code>. Multiple <code>ts</code> options on command line are
cumulative, and Hash is deeply merged. To remove a (deep) key from
transfer spec, set the value to <code>null</code>.</p>
<blockquote>
<p><strong>Note:</strong> Default transfer spec values can be displayed
with command: <code>config ascp info --flat-hash=no</code> under field
<code>ts</code>.</p>
</blockquote>
<p>It is possible to specify <code>ascp</code> options when the
<code>transfer</code> option is set to <a
href="#agt_direct"><code>direct</code></a> using
<code>transfer_info</code> option parameter: <code>ascp_args</code>.
Example:
<code>--transfer-info=@json:'{"ascp_args":["-l","100m"]}'</code>. This
is especially useful for <code>ascp</code> command line parameters not
supported in the transfer spec.</p>
<p>The use of a <a href="#transferspec"><em>transfer-spec</em></a>
instead of <code>ascp</code> parameters has the advantage of:</p>
<ul>
<li>common to all <a href="#agents">Transfer Agent</a></li>
<li>not dependent on command line limitations (special characters…)</li>
</ul>
<h2 data-number="4.25" id="transfer-parameters"><span
class="header-section-number">4.25</span>
<a id="transferparams"></a>Transfer Parameters</h2>
<p>All standard <a href="#transferspec"><em>transfer-spec</em></a>
parameters can be specified. <a
href="#transferspec"><em>transfer-spec</em></a> can also be
saved/overridden in the config file.</p>
<p>References:</p>
<ul>
<li><a
href="https://developer.ibm.com/apis/catalog?search=%22aspera%20node%20api%22">Aspera
Node API Documentation</a> → /opt/transfers</li>
<li><a
href="https://developer.ibm.com/apis/catalog?search=%22aspera%20transfer%20sdk%22">Aspera
Transfer SDK Documentation</a> → Guides → API Ref → Transfer Spec
V1</li>
<li><a
href="https://d3gcli72yxqn2z.cloudfront.net/connect/v4/asperaweb-4.js">Aspera
Connect SDK</a> → search
<code>The parameters for starting a transfer.</code></li>
</ul>
<p>Parameters can be displayed with commands:</p>
<div class="sourceCode" id="cb211"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp spec</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config ascp spec <span class="at">--select</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;d&quot;:&quot;Y&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>-d,n,c</span></code></pre></div>
<p>Columns:</p>
<ul>
<li>D=Direct (local <code>ascp</code> execution)</li>
<li>N=Node API</li>
<li>C=Connect Client</li>
<li>T=Transfer SDK</li>
<li>H=HTTP Gateway</li>
</ul>
<p><code>ascp</code> argument or environment variable is provided in
description.</p>
<p>Fields with EX_ prefix are extensions to transfer agent <a
href="#agt_direct"><code>direct</code></a>. (only in
<code>ascli</code>).</p>
<table>
<colgroup>
<col style="width: 20%" />
<col style="width: 16%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 44%" />
</colgroup>
<thead>
<tr class="header">
<th>Field</th>
<th>Type</th>
<th>D</th>
<th>N</th>
<th>C</th>
<th>T</th>
<th>H</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>apply_local_docroot</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Apply local docroot to source paths.<br/>(–apply-local-docroot)</td>
</tr>
<tr class="even">
<td>authentication</td>
<td>string</td>
<td> </td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td>value=token for SSH bypass keys, else password asked if not
provided.<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>cipher</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>In transit encryption type.<br/>Allowed values: none, aes-128,
aes-192, aes-256, aes-128-cfb, aes-192-cfb, aes-256-cfb, aes-128-gcm,
aes-192-gcm, aes-256-gcm<br/>(-c (conversion){enum})</td>
</tr>
<tr class="even">
<td>cipher_allowed</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>returned by node API. Valid literals include “aes-128” and
“none”.<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>compression</td>
<td>int</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>ascp4 only, 0 / 1?<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>content_protection</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Enable client-side encryption at rest. (CSEAR, content
protection)<br/>Allowed values: encrypt, decrypt<br/>(–file-crypt
{enum})</td>
</tr>
<tr class="odd">
<td>content_protection_password</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Specifies CSEAR password. (content
protection)<br/>(env:ASPERA_SCP_FILEPASS)</td>
</tr>
<tr class="even">
<td>cookie</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Metadata for transfer specified by
application<br/>(env:ASPERA_SCP_COOKIE)</td>
</tr>
<tr class="odd">
<td>create_dir</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Specifies whether to create new directories.<br/>(-d)</td>
</tr>
<tr class="even">
<td>delete_before_transfer</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Before transfer, delete files that exist at the destination but not
at the source.<br/>The source and destination arguments must be
directories that have matching names.<br/>Objects on the destination
that have the same name but different type or size as objects<br/>on the
source are not deleted.<br/>(–delete-before-transfer)</td>
</tr>
<tr class="odd">
<td>delete_source</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Remove SRC files after transfer
success<br/>(–remove-after-transfer)</td>
</tr>
<tr class="even">
<td>destination_root</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Destination root directory.<br/>(<special>)</td>
</tr>
<tr class="odd">
<td>destination_root_id</td>
<td>string</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>The file ID of the destination root directory.<br/>Required when
using Bearer token auth for the destination node.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>dgram_size</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>UDP datagram size in bytes<br/>(-Z {int})</td>
</tr>
<tr class="odd">
<td>direction</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Direction of transfer (on client side)<br/>Allowed values: send,
receive<br/>(–mode (conversion){enum})</td>
</tr>
<tr class="even">
<td>exclude_newer_than</td>
<td>int</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>skip src files with mtime &gt; arg<br/>(–exclude-newer-than
{int})</td>
</tr>
<tr class="odd">
<td>exclude_older_than</td>
<td>int</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>skip src files with mtime &lt; arg<br/>(–exclude-older-than
{int})</td>
</tr>
<tr class="even">
<td>fasp_port</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Specifies fasp (UDP) port.<br/>(-O {int})</td>
</tr>
<tr class="odd">
<td>fasp_url</td>
<td>string</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Only used in Faspex.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>file_checksum</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Enable checksum reporting for transferred files by specifying the
hash to use.<br/>Allowed values: sha-512, sha-384, sha-256, sha1, md5,
none<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>http_fallback</td>
<td>bool<br/>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>When true(1), attempts to perform an HTTP transfer if a FASP
transfer cannot be performed.<br/>(-y (conversion){bool}</td>
</tr>
<tr class="even">
<td>http_fallback_port</td>
<td>int</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Specifies http port when no cipher is used<br/>(-t {int})</td>
</tr>
<tr class="odd">
<td>https_fallback_port</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Specifies https port when cipher is used<br/>(-t {int})</td>
</tr>
<tr class="even">
<td>keepalive</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>The session is running in persistent session
mode.<br/>(–keepalive)</td>
</tr>
<tr class="odd">
<td>lock_min_rate</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>TODO: remove ?<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>lock_min_rate_kbps</td>
<td>bool</td>
<td> </td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td>If true, lock the minimum transfer rate to the value set for
min_rate_kbps.<br/>If false, users can adjust the transfer rate up to
the value set for target_rate_cap_kbps.<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>lock_rate_policy</td>
<td>bool</td>
<td> </td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td>If true, lock the rate policy to the default
value.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>lock_target_rate</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>TODO: remove ?<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>lock_target_rate_kbps</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>If true, lock the target transfer rate to the default value set for
target_rate_kbps.<br/>If false, users can adjust the transfer rate up to
the value set for target_rate_cap_kbps.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>min_rate_cap_kbps</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>The highest minimum rate that an incoming transfer can request, in
kilobits per second.<br/>Client minimum rate requests that exceed the
minimum rate cap are ignored.<br/>The default value of unlimited applies
no cap to the minimum rate. (Default: 0)<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>min_rate_kbps</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Set the minimum transfer rate in kilobits per second.<br/>(-m
{int})</td>
</tr>
<tr class="even">
<td>move_after_transfer</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>The relative path to which the files will be moved after the
transfer at the source side. Available as of
3.8.0.<br/>(–move-after-transfer {string})</td>
</tr>
<tr class="odd">
<td>multi_session</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Use multi-session transfer. max 128.<br/>Each participant on one
host needs an independent UDP (-O) port.<br/>Large files are split
between sessions only when transferring with
resume_policy=none.<br/><br/>(<special>)</td>
</tr>
<tr class="even">
<td>multi_session_threshold</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Split files across multiple ascp sessions if their size in bytes is
greater than or equal to the specified value.<br/>(0=no file is
split)<br/>(–multi-session-threshold {int})</td>
</tr>
<tr class="odd">
<td>obfuscate_file_names</td>
<td>bool</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Y</td>
<td>HTTP Gateway obfuscates file names when set to
true.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>overwrite</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Overwrite destination files with the source files of the same
name.<br/>Allowed values: never, always, diff, older,
diff+older<br/>(–overwrite {enum})</td>
</tr>
<tr class="odd">
<td>password</td>
<td>string</td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Password for local Windows user when transfer user associated with
node api user is not the same as the one running asperanoded.<br/>Allows
impersonating the transfer user and have access to resources
(e.g. network shares).<br/>Windows only, node api
only.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>paths</td>
<td>array</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Array of path to the source (required) and a path to the destination
(optional).<br/>(<special>)</td>
</tr>
<tr class="odd">
<td>precalculate_job_size</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Specifies whether to precalculate the job
size.<br/>(–precalculate-job-size)</td>
</tr>
<tr class="even">
<td>preserve_access_time</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Preserve the source-file access timestamps at the
destination.<br/>Because source access times are updated by the transfer
operation,<br/>the timestamp that is preserved is the one just before to
the transfer.<br/>(–preserve-access-time)</td>
</tr>
<tr class="odd">
<td>preserve_acls</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Preserve access control lists.<br/>Allowed values: none, native,
metafile<br/>(–preserve-acls {enum})</td>
</tr>
<tr class="even">
<td>preserve_creation_time</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>(Windows only) Preserve source-file creation timestamps at the
destination.<br/>Only Windows systems retain information about creation
time.<br/>If the destination is not a Windows computer, this option is
ignored.<br/>(–preserve-creation-time)</td>
</tr>
<tr class="odd">
<td>preserve_extended_attrs</td>
<td>string</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Preserve the extended attributes.<br/>Allowed values: none, native,
metafile<br/>(–preserve-xattrs {enum})</td>
</tr>
<tr class="even">
<td>preserve_file_owner_gid</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Preserve the group ID for a file
owner<br/>(–preserve-file-owner-gid)</td>
</tr>
<tr class="odd">
<td>preserve_file_owner_uid</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Preserve the user ID for a file
owner<br/>(–preserve-file-owner-uid)</td>
</tr>
<tr class="even">
<td>preserve_modification_time</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Set the modification time, the last time a file or directory was
modified (written), of a transferred file<br/>to the modification of the
source file or directory.<br/>Preserve source-file modification
timestamps at the destination.<br/>(–preserve-modification-time)</td>
</tr>
<tr class="odd">
<td>preserve_remote_acls</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Preserve remote access control lists.<br/>Allowed values: none,
native, metafile<br/>(–remote-preserve-acls {enum})</td>
</tr>
<tr class="even">
<td>preserve_source_access_time</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Preserve the time logged for when the source file was
accessed<br/>(–preserve-source-access-time)</td>
</tr>
<tr class="odd">
<td>preserve_times</td>
<td>bool</td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Preserve file timestamps.<br/>(–preserve-times)</td>
</tr>
<tr class="even">
<td>proxy</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Specify the address of the Aspera high-speed proxy
server.<br/>dnat(s)://[user[:password]@]server:port<br/>Default ports
for DNAT and DNATS protocols are 9091 and 9092.<br/>Password, if
specified here, overrides the value of environment variable
ASPERA_PROXY_PASS.<br/>(–proxy {string})</td>
</tr>
<tr class="odd">
<td>rate_policy</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>The transfer rate policy to use when sharing bandwidth.<br/>Allowed
values: low, fair, high, fixed<br/>(–policy {enum})</td>
</tr>
<tr class="even">
<td>rate_policy_allowed</td>
<td>string</td>
<td> </td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td>Specifies most aggressive rate policy that is allowed.<br/>Returned
by node API.<br/>Allowed values: low, fair, high,
fixed<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>read_threads</td>
<td>int</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>ascp4 only<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>remote_access_key</td>
<td>string</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>The access key ID of the access key that was used to construct the
bearer token that is used to authenticate to the remote
node.<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>remote_host</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>IP or fully qualified domain name of the remote server<br/>(–host
{string})</td>
</tr>
<tr class="even">
<td>remote_password</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>SSH session password<br/>(env:ASPERA_SCP_PASS)</td>
</tr>
<tr class="odd">
<td>remote_user</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Remote user. Default value is “xfer” on node or connect.<br/>(–user
{string})</td>
</tr>
<tr class="even">
<td>remove_after_transfer</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Remove SRC files after transfer
success<br/>(–remove-after-transfer)</td>
</tr>
<tr class="odd">
<td>remove_empty_directories</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Specifies whether to remove empty
directories.<br/>(–remove-empty-directories)</td>
</tr>
<tr class="even">
<td>remove_empty_source_directory</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Remove empty source subdirectories and remove the source directory
itself, if empty<br/>(–remove-empty-source-directory)</td>
</tr>
<tr class="odd">
<td>remove_skipped</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td>Must also have remove_after_transfer set to true, Defaults to false,
if true, skipped files will be removed as
well.<br/>(–remove-skipped)</td>
</tr>
<tr class="even">
<td>resume_policy</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>If a transfer is interrupted or fails to finish, resume without
re-transferring the whole files.<br/>Allowed values: none, attrs,
sparse_csum, full_csum<br/>(-k (conversion){enum})</td>
</tr>
<tr class="odd">
<td>retry_duration</td>
<td>string<br/>int</td>
<td> </td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td>Specifies how long to wait before retrying transfer.
(e.g. “5min”)<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>source_root</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Path to be prepended to each source path.<br/>This is either a
conventional path or it can be a URI but only if there is no root
defined.<br/>(–source-prefix64 (conversion){string})</td>
</tr>
<tr class="odd">
<td>source_root_id</td>
<td>string</td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>The file ID of the source root directory. Required when using Bearer
token auth for the source node.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>src_base</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>Specify the prefix to be stripped off from each source
object.<br/>The remaining portion of the source path is kept intact at
the destination.<br/>Special care must be taken when used with cloud
storage.<br/>(–src-base64 (conversion){string})</td>
</tr>
<tr class="odd">
<td>ssh_args</td>
<td>string</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Array of arguments to pass to SSH. Use with
caution.<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>ssh_port</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Specifies SSH (TCP) port. Default: local:22, other:33001<br/>(-P
{int})</td>
</tr>
<tr class="odd">
<td>ssh_private_key</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>Private key used for SSH authentication.<br/>Shall look like:
—–BEGIN RSA PRIV4TE KEY—–…<br/>Note the JSON encoding: for
newlines.<br/>(env:ASPERA_SCP_KEY)</td>
</tr>
<tr class="even">
<td>ssh_private_key_passphrase</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>The passphrase associated with the transfer user’s SSH private key.
Available as of 3.7.2.<br/>(env:ASPERA_SCP_PASS)</td>
</tr>
<tr class="odd">
<td>sshfp</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Check it against server SSH host key fingerprint<br/>(–check-sshfp
{string})</td>
</tr>
<tr class="even">
<td>symlink_policy</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Handle source side symbolic links<br/>Allowed values: follow, copy,
copy+force, skip<br/>(–symbolic-links {enum})</td>
</tr>
<tr class="odd">
<td>tags</td>
<td>hash</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Metadata for transfer as JSON<br/>(–tags64 (conversion){hash})</td>
</tr>
<tr class="even">
<td>target_rate_cap_kbps</td>
<td>int</td>
<td> </td>
<td> </td>
<td>Y</td>
<td> </td>
<td> </td>
<td>Returned by upload/download_setup node API.<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>target_rate_kbps</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Specifies desired speed for the transfer.<br/>(-l {int})</td>
</tr>
<tr class="even">
<td>target_rate_percentage</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>TODO: remove ?<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>title</td>
<td>string</td>
<td> </td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td>Title of the transfer<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>token</td>
<td>string</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Authorization token: Bearer, Basic or ATM (Also arg
-W)<br/>(env:ASPERA_SCP_TOKEN)</td>
</tr>
<tr class="odd">
<td>use_ascp4</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td>specify version of protocol<br/>(<special>)</td>
</tr>
<tr class="even">
<td>use_system_ssh</td>
<td>string</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>TODO, comment…<br/>(<ignored>)</td>
</tr>
<tr class="odd">
<td>write_threads</td>
<td>int</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>ascp4 only<br/>(<ignored>)</td>
</tr>
<tr class="even">
<td>wss_enabled</td>
<td>bool</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Server has Web Socket service enabled<br/>(<special>)</td>
</tr>
<tr class="odd">
<td>wss_port</td>
<td>int</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>TCP port used for websocket service feed<br/>(<special>)</td>
</tr>
<tr class="even">
<td>EX_ascp_args</td>
<td>array</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.13) Use option transfer_info.ascp_args<br/>Add native
command line arguments to ascp<br/>(<special>)</td>
</tr>
<tr class="odd">
<td>EX_at_rest_password</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.13) Use standard spec parameter:
content_protection_password<br/>Content protection
password<br/>(env:ASPERA_SCP_FILEPASS)</td>
</tr>
<tr class="even">
<td>EX_file_list</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use command line file list, or option
transfer_info.ascp_args<br/>source file list<br/>(<special>)</td>
</tr>
<tr class="odd">
<td>EX_file_pair_list</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use command line file pair list, or option
transfer_info.ascp_args<br/>source file pair list<br/>(<special>)</td>
</tr>
<tr class="even">
<td>EX_http_proxy_url</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) TODO, use proxy option ?<br/>Specify the proxy
server address used by HTTP Fallback<br/>(-x {string})</td>
</tr>
<tr class="odd">
<td>EX_http_transfer_jpeg</td>
<td>int</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use option transfer_info.ascp_args<br/>HTTP
transfers as JPEG file<br/>(-j {int})</td>
</tr>
<tr class="even">
<td>EX_license_text</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use env var ASPERA_SCP_LICENSE<br/>License file
text override.<br/>By default ascp looks for license file near
executable.<br/>(env:ASPERA_SCP_LICENSE)</td>
</tr>
<tr class="odd">
<td>EX_no_read</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use option transfer_info.ascp_args<br/>no read
source<br/>(–no-read)</td>
</tr>
<tr class="even">
<td>EX_no_write</td>
<td>bool</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use option transfer_info.ascp_args<br/>no write
on destination<br/>(–no-write)</td>
</tr>
<tr class="odd">
<td>EX_proxy_password</td>
<td>string</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use env var ASPERA_PROXY_PASS<br/>Password used
for Aspera proxy server authentication.<br/>May be overridden by
password in URL provided in parameter:
proxy.<br/>(env:ASPERA_PROXY_PASS)</td>
</tr>
<tr class="even">
<td>EX_ssh_key_paths</td>
<td>array</td>
<td>Y</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td>DEPRECATED: (4.14) Use option transfer_info.ascp_args<br/>Use public
key authentication for SSH and specify the private key file
paths<br/>(-i {array})</td>
</tr>
</tbody>
</table>
<h3 data-number="4.25.1" id="destination-folder-for-transfers"><span
class="header-section-number">4.25.1</span> Destination folder for
transfers</h3>
<p>The destination folder is set by <code>ascli</code> by default
to:</p>
<ul>
<li><code>.</code> for downloads</li>
<li><code>/</code> for uploads</li>
</ul>
<p>It is specified by the <a
href="#transferspec"><em>transfer-spec</em></a> parameter
<code>destination_root</code>. As such, it can be modified with option:
<code>--ts=@json:'{"destination_root":"&lt;path&gt;"}'</code>. The
option <code>to_folder</code> provides an equivalent and convenient way
to change this parameter: <code>--to-folder=&lt;path&gt;</code> .</p>
<h3 data-number="4.25.2" id="list-of-files-for-transfers"><span
class="header-section-number">4.25.2</span> <a id="file_list"></a>List
of files for transfers</h3>
<p>When uploading, downloading or sending files, the user must specify
the list of files to transfer.</p>
<p>By default the list of files to transfer is simply provided on the
command line.</p>
<p>The list of (source) files to transfer is specified by (extended
value) option <code>sources</code> (default: <code>@args</code>). The
list is either simply the list of source files, or a combined
source/destination list (see below) depending on value of option
<code>src_type</code> (default: <code>list</code>).</p>
<p>In <code>ascli</code>, all transfer parameters, including file list,
are provided to the transfer agent in a <a
href="#transferspec"><em>transfer-spec</em></a> so that execution of a
transfer is independent of the transfer agent (direct, connect, node,
transfer sdk…). So, eventually, the list of files to transfer is
provided to the transfer agent using the <a
href="#transferspec"><em>transfer-spec</em></a> field:
<code>"paths"</code> which is a list (array) of pairs of
<code>"source"</code> (mandatory) and <code>"destination"</code>
(optional). The <code>sources</code> and <code>src_type</code> options
provide convenient ways to populate the transfer spec with the source
file list.</p>
<p>Possible values for option <code>sources</code> are:</p>
<ul>
<li><p><code>@args</code> : (default) the list of files (or file pair)
is directly provided on the command line (after commands): unused
arguments (not starting with <code>-</code>) are considered as source
files. So, by default, the list of files to transfer will be simply
specified on the command line. Example:</p>
<div class="sourceCode" id="cb212"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload ~/first.file secondfile</span></code></pre></div>
<p>This is the same as (with default values):</p>
<div class="sourceCode" id="cb213"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload <span class="at">--sources</span><span class="op">=</span>@args <span class="at">--src-type</span><span class="op">=</span>list ~/mysample.file secondfile</span></code></pre></div></li>
<li><p>an <a href="#extended">Extended Value</a> with type <strong>Array
of String</strong></p>
<blockquote>
<p><strong>Note:</strong> extended values can be tested with the command
<code>conf echo</code></p>
</blockquote>
<p>Examples:</p>
<ul>
<li><p>Using extended value</p>
<p>Create the file list:</p>
<div class="sourceCode" id="cb214"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> ~/mysample.file <span class="op">&gt;</span> myfilelist.txt</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> secondfile <span class="op">&gt;&gt;</span> myfilelist.txt</span></code></pre></div>
<p>Use the file list: one path per line:</p>
<div class="sourceCode" id="cb215"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="kw">--</span>sources<span class="kw">=</span><span class="ot">@lines</span><span class="wa">:@file:myfilelist</span><span class="at">.txt</span></span></code></pre></div></li>
<li><p>Using JSON array</p>
<div class="sourceCode" id="cb216"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--sources=@json:</span><span class="st">&#39;[&quot;file1&quot;,&quot;file2&quot;]&#39;</span></span></code></pre></div></li>
<li><p>Using STDIN, one path per line</p>
<div class="sourceCode" id="cb217"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--sources=@lines:@stdin:</span></span></code></pre></div></li>
<li><p>Using Ruby code (one path per line in file)</p>
<div class="sourceCode" id="cb218"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="kw">--</span>sources<span class="kw">=</span><span class="ot">@ruby</span>:<span class="vs">&#39;File.read(&quot;myfilelist.txt&quot;).split(&quot;\n&quot;)&#39;</span></span></code></pre></div></li>
</ul></li>
<li><p><code>@ts</code> : the user provides the list of files directly
in the <code>paths</code> field of transfer spec (option
<code>ts</code>). Examples:</p>
<ul>
<li>Using transfer spec</li>
</ul>
<div class="sourceCode" id="cb219"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--sources=@ts</span> <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;paths&quot;:[{&quot;source&quot;:&quot;file1&quot;},{&quot;source&quot;:&quot;file2&quot;}]}&#39;</span></span></code></pre></div></li>
</ul>
<p>The option <code>src_type</code> allows specifying if the list
specified in option <code>sources</code> is a simple file list or if it
is a file pair list.</p>
<blockquote>
<p><strong>Note:</strong> Option <code>src_type</code> is not used if
option <code>sources</code> is set to <code>@ts</code></p>
</blockquote>
<p>Supported values for <code>src_type</code> are:</p>
<ul>
<li><code>list</code> : (default) the path of destination is the same as
source and each entry is a source file path</li>
<li><code>pair</code> : the first element is the first source, the
second element is the first destination, and so on.</li>
</ul>
<p>Example: Source file <code>200KB.1</code> is renamed
<code>sample1</code> on destination:</p>
<div class="sourceCode" id="cb220"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload <span class="at">--src-type</span><span class="op">=</span>pair ~/Documents/Samples/200KB.1 /Upload/sample1</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> There are some specific rules to specify a
file list when using <strong>Aspera on Cloud</strong>, refer to the AoC
plugin section.</p>
</blockquote>
<h3 data-number="4.25.3"
id="source-directory-structure-on-destination"><span
class="header-section-number">4.25.3</span> Source directory structure
on destination</h3>
<p>This section is not specific to <code>ascli</code> it is
<code>ascp</code> behaviour.</p>
<p>The transfer destination is normally expected to designate a
destination folder.</p>
<p>But there is one exception: The destination specifies the new item
name when the following are met:</p>
<ul>
<li>there is a single source item (file or folder)</li>
<li>transfer spec <code>create_dir</code> is not set to
<code>true</code> (<code>ascp</code> option <code>-d</code> not
provided)</li>
<li>destination is not an existing folder</li>
<li>the <code>dirname</code> of destination is an existing folder</li>
</ul>
<p>For this reason it is recommended to set <code>create_dir</code> to
<code>true</code> for consistent behaviour between single and multiple
items transfer, this is the default in <code>ascli</code>.</p>
<p>If a simple source file list is provided (no <code>destination</code>
in <code>paths</code>, i.e. no <code>file_pair_list</code> provided),
the destination folder is used as destination folder for each source
file, and source file folder names are not preserved.</p>
<p>The inner structure of source items that are folder is preserved on
destination.</p>
<p>A leading <code>/</code> on destination is ignored (relative to
docroot) unless docroot is not set (relative to home).</p>
<p>In the following table source folder <code>d3</code> contains 2
files: <code>f1</code> and <code>d4/f2</code>.</p>
<table>
<colgroup>
<col style="width: 16%" />
<col style="width: 14%" />
<col style="width: 21%" />
<col style="width: 13%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Source files</th>
<th>Destination</th>
<th>Folders on Dest.</th>
<th><code>create_dir</code></th>
<th>Destination Files</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>f1</td>
<td>d/f</td>
<td>-</td>
<td>false</td>
<td>Error: <code>d</code> does not exist.</td>
</tr>
<tr class="even">
<td>f1</td>
<td>d/f</td>
<td>d</td>
<td>false</td>
<td>d/f (renamed)</td>
</tr>
<tr class="odd">
<td>f1</td>
<td>d/f/.</td>
<td>d</td>
<td>false</td>
<td>d/f (renamed)</td>
</tr>
<tr class="even">
<td>f1</td>
<td>d/f</td>
<td>d/f</td>
<td>false</td>
<td>d/f/f1</td>
</tr>
<tr class="odd">
<td>f1 f2</td>
<td>d</td>
<td>d</td>
<td>false</td>
<td>d/f1 d/f2</td>
</tr>
<tr class="even">
<td>d3</td>
<td>d</td>
<td>-</td>
<td>false</td>
<td>d/f1 d/f2 (renamed)</td>
</tr>
<tr class="odd">
<td>f1</td>
<td>d</td>
<td>-</td>
<td>true</td>
<td>d/f1</td>
</tr>
<tr class="even">
<td>f1 f2</td>
<td>d</td>
<td>-</td>
<td>true</td>
<td>d/f1 d/f2</td>
</tr>
<tr class="odd">
<td>d1/f1 d2/f2</td>
<td>d</td>
<td>-</td>
<td>true</td>
<td>d/f1 d/f2</td>
</tr>
<tr class="even">
<td>d3</td>
<td>d</td>
<td>-</td>
<td>true</td>
<td>d/d3/f1 d/d3/d4/f2</td>
</tr>
</tbody>
</table>
<p>If a file par list is provided then it is possible to rename or
specify a different destination folder for each source (relative to the
destination).</p>
<p>If transfer spec has a <code>src_base</code>, it has the side effect
that the simple source file list is considered as a file pair list, and
so the lower structure of source folders is preserved on
destination.</p>
<table>
<colgroup>
<col style="width: 26%" />
<col style="width: 18%" />
<col style="width: 14%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="header">
<th>Source files</th>
<th>Destination</th>
<th><code>src_base</code></th>
<th>Destination Files</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>d1/d2/f2 d1/d3/f3</td>
<td>d</td>
<td>d1</td>
<td>d/d2/f2 d/d3/f3</td>
</tr>
</tbody>
</table>
<p>Advanced Example: Send files <code>./file1</code> and
<code>./folder2/files2</code> to server (e.g. <code>/Upload</code>) and
keep the original file names and folders, i.e. send <code>file1</code>
to <code>/Upload/file1</code> and <code>files2</code> to
<code>/Upload/folder2/files2</code>.</p>
<ul>
<li><p>If files are specified as
<code>./file1 ./folder2/files2</code>,</p>
<p>then destination will be:
<code>/Upload/file1 /Upload/files2</code></p></li>
<li><p>One possibility is to specify a file pair list:
<code>--src-type=pair file1 file1 folder2/files2 folder2/files2</code></p></li>
<li><p>Another possibility is to specify a source base:
<code>--src-base=$PWD $PWD/file1 $PWD/folder2/files2</code></p>
<p>(note that <code>.</code> cannot be used as source base)</p></li>
<li><p>Similarly, create a temporary soft link (Linux):
<code>ln -s . tmp_base</code> and use
<code>--src-base=tmp_base tmp_base/file1 tmp_base/folder2/files2</code></p></li>
<li><p>One can also similarly use <code>--sources=@ts</code> and specify
the list of files in the <code>paths</code> field of transfer spec with
both <code>source</code> and <code>destination</code> for each
file.</p></li>
</ul>
<h3 data-number="4.25.4" id="support-of-multi-session"><span
class="header-section-number">4.25.4</span>
<a id="multisession"></a>Support of multi-session</h3>
<p>Multi session, i.e. starting a transfer of a file set using multiple
sessions (one <code>ascp</code> process per session) is supported on
<code>direct</code> and <code>node</code> agents, not yet on
connect.</p>
<ul>
<li><code>--transfer=node</code></li>
</ul>
<div class="sourceCode" id="cb221"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;multi_session&quot;:10,&quot;multi_session_threshold&quot;:1}&#39;</span></span></code></pre></div>
<p>Multi-session is directly supported by the node daemon.</p>
<ul>
<li><code>--transfer=direct</code></li>
</ul>
<div class="sourceCode" id="cb222"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;multi_session&quot;:5,&quot;multi_session_threshold&quot;:1,&quot;resume_policy&quot;:&quot;none&quot;}&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> <code>resume_policy</code> set to
<code>attr</code> may cause problems: <code>none</code> or
<code>sparse_csum</code> shall be preferred.</p>
</blockquote>
<p><code>ascli</code> starts multiple <code>ascp</code> for
Multi-session using <code>direct</code> agent.</p>
<p>When multi-session is used, one separate UDP port is used per session
(refer to <code>ascp</code> manual page).</p>
<h3 data-number="4.25.5" id="content-protection"><span
class="header-section-number">4.25.5</span> Content protection</h3>
<p>Also known as Client-side encryption at rest (CSEAR), content
protection allows a client to send files to a server which will store
them encrypted (upload), and decrypt files as they are being downloaded
from a server, both using a passphrase, only known by users sharing
files. Files stay encrypted on server side.</p>
<p>Activating CSEAR consists in using transfer spec parameters:</p>
<ul>
<li><code>content_protection</code> : activate encryption
(<code>encrypt</code> for upload) or decryption (<code>decrypt</code>
for download)</li>
<li><code>content_protection_password</code> : the passphrase to be
used.</li>
</ul>
<p>Example: parameter to download a faspex package and decrypt on the
fly</p>
<div class="sourceCode" id="cb223"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;content_protection&quot;:&quot;decrypt&quot;,&quot;content_protection_password&quot;:&quot;my_password_here&quot;}&#39;</span></span></code></pre></div>
<h3 data-number="4.25.6" id="transfer-spec-examples"><span
class="header-section-number">4.25.6</span> Transfer Spec Examples</h3>
<ul>
<li>Change target rate</li>
</ul>
<div class="sourceCode" id="cb224"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;target_rate_kbps&quot;:500000}&#39;</span></span></code></pre></div>
<ul>
<li>Override the FASP SSH port to a specific TCP port:</li>
</ul>
<div class="sourceCode" id="cb225"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;ssh_port&quot;:33002}&#39;</span></span></code></pre></div>
<ul>
<li>Force http fallback mode:</li>
</ul>
<div class="sourceCode" id="cb226"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;http_fallback&quot;:&quot;force&quot;}&#39;</span></span></code></pre></div>
<ul>
<li>Activate progress when not activated by default on server</li>
</ul>
<div class="sourceCode" id="cb227"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;precalculate_job_size&quot;:true}&#39;</span></span></code></pre></div>
<h2 data-number="4.26" id="scheduler"><span
class="header-section-number">4.26</span>
<a id="scheduler"></a>Scheduler</h2>
<p>It is useful to configure automated scheduled execution.
<code>ascli</code> does not provide an internal scheduler. Instead, use
the service provided by the Operating system:</p>
<h3 data-number="4.26.1" id="windows-scheduler"><span
class="header-section-number">4.26.1</span> Windows Scheduler</h3>
<p>Windows provides the <a
href="https://docs.microsoft.com/en-us/windows/win32/taskschd/task-scheduler-start-page">Task
Scheduler</a>. It can be configured:</p>
<ul>
<li><p>Using utility <a
href="https://learn.microsoft.com/fr-fr/windows-server/administration/windows-commands/schtasks-create"><code>schtasks.exe</code></a></p></li>
<li><p>Using powershell function <a
href="https://learn.microsoft.com/en-us/powershell/module/scheduledtasks">scheduletasks</a></p></li>
<li><p>Using <code>taskschd.msc</code> (UI)</p></li>
</ul>
<h3 data-number="4.26.2" id="unix-like-scheduler"><span
class="header-section-number">4.26.2</span> Unix-like Scheduler</h3>
<p>Unix-like systems (Linux, …) provide cron, configured using a <a
href="https://www.man7.org/linux/man-pages/man5/crontab.5.html">crontab</a></p>
<p>Linux also provides <code>anacron</code>, if tasks are hourly or
daily.</p>
<p>For example, on Linux it is convenient to create a wrapping script,
e.g. <code>cron_ascli</code> that will setup the environment (e.g. Ruby)
to properly start <code>ascli</code>:</p>
<div class="sourceCode" id="cb228"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load the ruby environment</span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span> /etc/profile.d/rvm.sh</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="ex">rvm</span> use 2.6 <span class="at">--quiet</span></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set a timeout protection, just in case ascli is frozen </span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="va">tmout</span><span class="op">=</span>30m</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="co"># forward arguments to ascli</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span> timeout <span class="va">${tmout}</span> ascli <span class="st">&quot;</span><span class="va">${@}</span><span class="st">&quot;</span></span></code></pre></div>
<p>Example of cronjob created for user <code>xfer</code>.</p>
<div class="sourceCode" id="cb229"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crontab</span><span class="op">&lt;&lt;EOF</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="st">0    * * * *  /home/xfer/cron_ascli preview scan --logger=syslog --display=error</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="st">2-59 * * * *  /home/xfer/cron_ascli preview trev --logger=syslog --display=error</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="op">EOF</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> The logging options are kept here in the
cronfile instead of conf file to allow execution on command line with
output on command line.</p>
</blockquote>
<h2 data-number="4.27" id="locking-for-exclusive-execution"><span
class="header-section-number">4.27</span> <a id="locking"></a>Locking
for exclusive execution</h2>
<p>In some cases one needs to ensure that <code>ascli</code> is not
executed several times in parallel.</p>
<p>When <code>ascli</code> is executed automatically on a schedule
basis, one generally desires that a new execution is not started if a
previous execution is still running because an on-going operation may
last longer than the scheduling period:</p>
<ul>
<li>Executing instances may pile-up and kill the system</li>
<li>The same file may be transferred by multiple instances at the same
time.</li>
<li><code>preview</code> may generate the same files in multiple
instances.</li>
</ul>
<p>Usually the OS native scheduler already provides some sort of
protection against parallel execution:</p>
<ul>
<li>The Windows scheduler does this by default</li>
<li>Linux cron can leverage the utility <a
href="https://linux.die.net/man/1/flock"><code>flock</code></a> to do
the same:</li>
</ul>
<div class="sourceCode" id="cb230"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/usr/bin/flock</span> <span class="at">-w</span> 0 /var/cron.lock ascli ...</span></code></pre></div>
<p><code>ascli</code> natively supports a locking mechanism with option
<code>lock_port</code>. (Technically, this opens a local TCP server
port, and fails if this port is already used, providing a local lock.
Lock is released when process exits).</p>
<p>Testing <code>ascli</code> locking:</p>
<p>Run this same command in two separate terminals within less than 30
seconds:</p>
<div class="sourceCode" id="cb231"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config echo @ruby:<span class="st">&#39;sleep(30)&#39;</span> <span class="at">--lock-port</span><span class="op">=</span>12345</span></code></pre></div>
<p>The first instance will sleep 30 seconds, the second one will
immediately exit like this:</p>
<div class="sourceCode" id="cb232"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="ex">WARN</span> <span class="at">--</span> : Another instance is already running <span class="er">(</span><span class="ex">Address</span> already in use <span class="at">-</span> bind<span class="er">(</span><span class="ex">2</span><span class="kw">)</span> <span class="cf">for</span> <span class="st">&quot;127.0.0.1&quot;</span> port 12345<span class="kw">)</span><span class="bu">.</span></span></code></pre></div>
<h2 data-number="4.28" id="provençale"><span
class="header-section-number">4.28</span> “Provençale”</h2>
<p><code>ascp</code>, the underlying executable implementing Aspera file
transfer using FASP, has a capability to not only access the local file
system (using system’s
<code>open</code>,<code>read</code>,<code>write</code>,<code>close</code>
primitives), but also to do the same operations on other data storage
such as S3, Hadoop and others. This mechanism is call <em>PVCL</em>.
Several <em>PVCL</em> adapters are available, some are embedded in
<code>ascp</code> , some are provided om shared libraries and must be
activated. (e.g. using <code>trapd</code>)</p>
<p>The list of supported <em>PVCL</em> adapters can be retrieved with
command:</p>
<div class="sourceCode" id="cb233"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf ascp info</span></code></pre></div>
<pre class="output"><code>+--------------------+-----------------------------------------------------------+
| key                | value                                                     |
+--------------------+-----------------------------------------------------------+
-----8&lt;-----snip-----8&lt;-----
| product_name       | IBM Aspera SDK                                            |
| product_version    | 4.0.1.182389                                              |
| process            | pvcl                                                      |
| shares             | pvcl                                                      |
| noded              | pvcl                                                      |
| faux               | pvcl                                                      |
| file               | pvcl                                                      |
| stdio              | pvcl                                                      |
| stdio-tar          | pvcl                                                      |
+--------------------+-----------------------------------------------------------+</code></pre>
<p>Here we can see the adapters: <code>process</code>,
<code>shares</code>, <code>noded</code>, <code>faux</code>,
<code>file</code>, <code>stdio</code>, <code>stdio-tar</code>.</p>
<p>Those adapters can be used wherever a file path is used in
<code>ascp</code> including configuration. They act as a pseudo
“drive”.</p>
<p>The simplified format is:</p>
<div class="sourceCode" id="cb235"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span>adapter<span class="op">&gt;</span>:///<span class="op">&lt;</span>sub <span class="fu">file</span> path<span class="op">&gt;</span><span class="pp">?</span><span class="op">&lt;</span>arg1<span class="op">&gt;</span>=<span class="op">&lt;</span>val1<span class="op">&gt;&amp;</span>...</span></code></pre></div>
<p>One of the adapters, used in this manual, for testing, is
<code>faux</code>. It is a pseudo file system allowing generation of
file data without actual storage (on source or destination).</p>
<h2 data-number="4.29" id="faux-for-testing"><span
class="header-section-number">4.29</span>
<a id="faux_testing"></a><code>faux:</code> for testing</h2>
<p>This is an extract of the man page of <code>ascp</code>. This feature
is a feature of <code>ascp</code>, not <code>ascli</code>.</p>
<p>This adapter can be used to simulate a file or a directory.</p>
<p>To discard data at the destination, the destination argument is set
to <code>faux://</code>.</p>
<p>To send uninitialized data in place of an actual source file, the
source file is replaced with an argument of the form:</p>
<div class="sourceCode" id="cb236"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="ex">faux:///filename?filesize</span></span></code></pre></div>
<p>where:</p>
<ul>
<li><code>filename</code> is the name that will be assigned to the file
on the destination</li>
<li><code>filesize</code> is the number of bytes that will be sent (in
decimal).</li>
</ul>
<blockquote>
<p><strong>Note:</strong> characters <code>?</code> and
<code>&amp;</code> are shell special characters (wildcard and
background), so <code>faux</code> file specification on command line
should be protected (using quotes or <code>\</code>). If not, the shell
may give error: <code>no matches found</code> or equivalent.</p>
</blockquote>
<p>For all sizes, a suffix can be added (case insensitive) to the size:
k,m,g,t,p,e (values are power of 2, e.g. 1M is 2<sup>20</sup>, i.e. 1
mebibyte, not megabyte). The maximum allowed value is 8*2<sup>60</sup>.
Very large <code>faux</code> file sizes (petabyte range and above) will
likely fail due to lack of destination storage unless destination is
<code>faux://</code>.</p>
<p>To send uninitialized data in place of a source directory, the source
argument is replaced with an argument of the form:</p>
<div class="sourceCode" id="cb237"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="ex">faux:///dirname?</span><span class="op">&lt;</span>arg1<span class="op">&gt;</span>=<span class="op">&lt;</span>val1<span class="op">&gt;&amp;</span>...</span></code></pre></div>
<p>where:</p>
<ul>
<li><code>dirname</code> is the folder name and can contain
<code>/</code> to specify a subfolder.</li>
<li>supported arguments are:</li>
</ul>
<table>
<colgroup>
<col style="width: 29%" />
<col style="width: 22%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>count</td>
<td>int</td>
<td>mandatory</td>
</tr>
<tr class="even">
<td>file</td>
<td>string</td>
<td>Basename for files<br>Default: “file”</td>
</tr>
<tr class="odd">
<td>size</td>
<td>int</td>
<td>Size of first file.<br>Default: 0</td>
</tr>
<tr class="even">
<td>inc</td>
<td>int</td>
<td>Increment applied to determine next file size<br>Default: 0</td>
</tr>
<tr class="odd">
<td>seq</td>
<td>enum</td>
<td>Sequence in determining next file size<br/>Values: random,
sequential<br/>Default: sequential</td>
</tr>
<tr class="even">
<td>buf_init</td>
<td>enum</td>
<td>How source data is initialized<br/>Option ‘none’ is not allowed for
downloads.<br/>Values:none, zero, random<br/>Default:zero</td>
</tr>
</tbody>
</table>
<p>The sequence parameter is applied as follows:</p>
<ul>
<li><p>If <code>seq</code> is <code>random</code> then each file size
is:</p>
<ul>
<li>size +/- (inc * rand())</li>
<li>Where rand is a random number between 0 and 1</li>
<li>Note that file size must not be negative, inc will be set to size if
it is greater than size</li>
<li>Similarly, overall file size must be less than 8<em>2<sup>60</sup>.
If size + inc is greater, inc will be reduced to limit size + inc to
7</em>2<sup>60</sup>.</li>
</ul></li>
<li><p>If <code>seq</code> is <code>sequential</code> then each file
size is:</p>
<ul>
<li><code>size + ((file_index - 1) * inc)</code></li>
<li>Where first file is index 1</li>
<li>So file1 is <code>size</code> bytes, file2 is
<code>size + inc</code> bytes, file3 is <code>size + inc * 2</code>
bytes, etc.</li>
<li>As with <code>random</code>, <code>inc</code> will be adjusted if
<code>size + (count * inc)</code> is not less then
8*2<sup>60</sup>.</li>
</ul></li>
</ul>
<p>Filenames generated are of the form:
<code>&lt;file&gt;_&lt;00000 ... count&gt;_&lt;filesize&gt;</code></p>
<p>Examples:</p>
<ul>
<li>Upload 20 gibibytes of random data to file myfile to directory
/Upload</li>
</ul>
<div class="sourceCode" id="cb238"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload faux:///myfile\?20g <span class="at">--to-folder</span><span class="op">=</span>/Upload</span></code></pre></div>
<ul>
<li>Upload a file /tmp/sample but do not save results to disk (no
docroot on destination)</li>
</ul>
<div class="sourceCode" id="cb239"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload /tmp/sample <span class="at">--to-folder</span><span class="op">=</span>faux://</span></code></pre></div>
<ul>
<li>Upload a faux directory <code>mydir</code> containing 1 million
files, sequentially with sizes ranging from 0 to 2 Mebibyte - 2 bytes,
with the basename of each file being <code>testfile</code> to
/Upload</li>
</ul>
<div class="sourceCode" id="cb240"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload <span class="st">&quot;faux:///mydir?file=testfile&amp;count=1m&amp;size=0&amp;inc=2&amp;seq=sequential&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>/Upload</span></code></pre></div>
<h2 data-number="4.30" id="usage"><span
class="header-section-number">4.30</span> <a id="usage"></a>Usage</h2>
<pre class="text"><code>ascli -h
NAME
        ascli -- a command line tool for Aspera Applications (v4.15.0.pre)

SYNOPSIS
        ascli COMMANDS [OPTIONS] [ARGS]

DESCRIPTION
        Use Aspera application to perform operations on command line.
        Documentation and examples: https://rubygems.org/gems/aspera-cli
        execute: ascli conf doc
        or visit: https://www.rubydoc.info/gems/aspera-cli
        source repo: https://github.com/IBM/aspera-cli

ENVIRONMENT VARIABLES
        ASCLI_HOME config folder, default: $HOME/.aspera/ascli
        Any option can be set as an environment variable, refer to the manual

COMMANDS
        To list first level commands, execute: ascli
        Note that commands can be written shortened (provided it is unique).

OPTIONS
        Options begin with a &#39;-&#39; (minus), and value is provided on command line.
        Special values are supported beginning with special prefix @pfx:, where pfx is one of:
        val, base64, csvt, env, file, uri, json, lines, list, path, ruby, secret, stdin, zlib, extend, preset, vault
        Dates format is &#39;DD-MM-YY HH:MM:SS&#39;, or &#39;now&#39; or &#39;-&lt;num&gt;h&#39;

ARGS
        Some commands require mandatory arguments, e.g. a path.

OPTIONS: global
        --interactive=ENUM           Use interactive input of missing params: [no], yes
        --ask-options=ENUM           Ask even optional options: [no], yes
        --format=ENUM                Output format: text, nagios, ruby, json, jsonpp, yaml, [table], csv
        --display=ENUM               Output only some information: [info], data, error
        --fields=VALUE               Comma separated list of: fields, or ALL, or DEF (String, Array)
        --select=VALUE               Select only some items in lists: column, value (Hash)
        --table-style=VALUE          Table display style
        --flat-hash=ENUM             Display deep values as additional keys: no, [yes]
        --transpose-single=ENUM      Single object fields output vertically: no, [yes]
        --show-secrets=ENUM          Show secrets on command output: [no], yes
    -h, --help                       Show this message
        --bash-comp                  Generate bash completion for command
        --show-config                Display parameters used for the provided action
    -r, --rest-debug                 More debug for HTTP calls (REST)
    -v, --version                    Display version
    -w, --warnings                   Check for language warnings
        --ui=ENUM                    Method to start browser: text, [graphical]
        --log-level=ENUM             Log level: debug, info, [warn], error, fatal, unknown
        --logger=ENUM                Logging method: [stderr], stdout, syslog
        --lock-port=VALUE            Prevent dual execution of a command, e.g. in cron (Integer)
        --http-options=VALUE         Options for http socket (Hash)
        --insecure=ENUM              Do not validate HTTPS certificate: [no], yes
        --once-only=ENUM             Process only new items (some commands): [no], yes
        --log-secrets=ENUM           Show passwords in logs: [no], yes
        --cache-tokens=ENUM          Save and reuse Oauth tokens: no, [yes]
        --clean-temp=ENUM            Cleanup temporary files on exit: no, [yes]

COMMAND: config
SUBCOMMANDS: ascp check_update coffee detect documentation echo email_test file flush_tokens folder gem genkey hint initdemo open plugins preset proxy_check smtp_settings vault wizard
OPTIONS:
        --config-file=VALUE          Read parameters from file in YAML format, current=/usershome/.aspera/ascli/config.yaml
        --query=VALUE                Additional filter for for some commands (list/delete) (Hash)
        --value=VALUE                Value for create, update, list filter (Hash) (deprecated: (4.14) Use positional value for create/modify or option: query for list/delete)
        --property=VALUE             Name of property to set (modify operation)
        --id=VALUE                   Resource identifier (deprecated: (4.14) Use positional identifier after verb (modify,delete,show))
        --bulk=ENUM                  Bulk operation (only some): [no], yes
        --bfail=ENUM                 Bulk operation error handling: no, [yes]
    -N, --no-default                 Do not load default configuration for plugin
        --override=ENUM              Wizard: override existing value: [no], yes
        --use-generic-client=ENUM    Wizard: AoC: use global or org specific jwt client id: no, [yes]
        --default=ENUM               Wizard: set as default configuration for specified plugin (also: update): no, [yes]
        --test-mode=ENUM             Wizard: skip private key check step: [no], yes
        --pkeypath=VALUE             Wizard: path to private key for JWT
    -P, --presetVALUE                Load the named option preset from current config file
        --ascp-path=VALUE            Path to ascp
        --use-product=VALUE          Use ascp from specified product
        --smtp=VALUE                 SMTP configuration (Hash)
        --fpac=VALUE                 Proxy auto configuration script
        --proxy-credentials=VALUE    HTTP proxy credentials (user and password) (Array)
        --secret=VALUE               Secret for access keys
        --vault=VALUE                Vault for secrets (Hash)
        --vault-password=VALUE       Vault password
        --sdk-url=VALUE              URL to get SDK
        --sdk-folder=VALUE           SDK folder path
        --notif-to=VALUE             Email recipient for notification of transfers
        --notif-template=VALUE       Email ERB template for notification of transfers
        --version-check-days=VALUE   Period in days to check new version (zero to disable)
        --plugin-folder=VALUE        Folder where to find additional plugins
        --ts=VALUE                   Override transfer spec values (Hash)
        --to-folder=VALUE            Destination folder for transferred files
        --sources=VALUE              How list of transferred files is provided (@args,@ts,Array)
        --src-type=ENUM              Type of file list: [list], pair
        --transfer=ENUM              Type of transfer agent: [direct], node, connect, httpgw, trsdk
        --transfer-info=VALUE        Parameters for transfer agent (Hash)
        --progress=ENUM              Type of progress bar: none, [native], multi


COMMAND: shares
SUBCOMMANDS: admin files health
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --type=ENUM                  Type of user/group for operations: [any], local, ldap, saml


COMMAND: node
SUBCOMMANDS: access_keys api_details asperabrowser async basic_token browse central delete download events health http_node_download info license mkdir mkfile mklink rename search service space ssync stream sync transfer upload watch_folder
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --validator=VALUE            Identifier of validator (optional for central)
        --asperabrowserurl=VALUE     URL for simple aspera web ui
        --sync-name=VALUE            Sync name
        --default-ports=ENUM         Use standard FASP ports or get from node api (gen4): no, [yes]
        --sync-info=VALUE            Information for sync instance and sessions (Hash)


COMMAND: orchestrator
SUBCOMMANDS: health info plugins processes workflow
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --result=VALUE               Specify result value as: &#39;work_step:parameter&#39;
        --synchronous=ENUM           Wait for completion: [no], yes
        --ret-style=ENUM             How return type is requested in api: header, [arg], ext
        --auth-style=ENUM            Authentication type: arg_pass, [head_basic], apikey


COMMAND: bss
SUBCOMMANDS: subscription
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password


COMMAND: alee
SUBCOMMANDS: entitlement
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password


COMMAND: ats
SUBCOMMANDS: access_key api_key aws_trust_policy cluster
OPTIONS:
        --ibm-api-key=VALUE          IBM API key, see https://cloud.ibm.com/iam/apikeys
        --instance=VALUE             ATS instance in ibm cloud
        --ats-key=VALUE              ATS key identifier (ats_xxx)
        --ats-secret=VALUE           ATS key secret
        --params=VALUE               Parameters access key creation (@json:)
        --cloud=VALUE                Cloud provider
        --region=VALUE               Cloud region


COMMAND: faspex5
SUBCOMMANDS: admin bearer_token gateway health packages postprocessing shared_folders user version
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --client-id=VALUE            OAuth client identifier
        --client-secret=VALUE        OAuth client secret
        --redirect-uri=VALUE         OAuth redirect URI for web authentication
        --auth=ENUM                  OAuth type of authentication: boot, link, web, [jwt]
        --private-key=VALUE          OAuth JWT RSA private key PEM value (prefix file path with @file:)
        --passphrase=VALUE           OAuth JWT RSA private key passphrase
        --link=VALUE                 Public link authorization (specific operations)
        --box=VALUE                  Package inbox, either shared inbox name or one of [&quot;inbox&quot;, &quot;inbox_history&quot;, &quot;inbox_all&quot;, &quot;inbox_all_history&quot;, &quot;outbox&quot;, &quot;outbox_history&quot;, &quot;pending&quot;, &quot;pending_history&quot;, &quot;all&quot;] or ALL
        --shared-folder=VALUE        Send package with files from shared folder
        --group-type=ENUM            Type of shared box: [shared_inboxes], workgroups


COMMAND: cos
SUBCOMMANDS: node
OPTIONS:
        --bucket=VALUE               Bucket name
        --endpoint=VALUE             Storage endpoint url
        --apikey=VALUE               Storage API key
        --crn=VALUE                  Resource instance id
        --service-credentials=VALUE  IBM Cloud service credentials (Hash)
        --region=VALUE               Storage region
        --identity=VALUE             Authentication url (https://iam.cloud.ibm.com/identity)


COMMAND: faspex
SUBCOMMANDS: address_book dropbox health login_methods me package source v4
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --link=VALUE                 Public link for specific operation
        --delivery-info=VALUE        Package delivery information (Hash)
        --remote-source=VALUE        Remote source for package send (id or %name:)
        --storage=VALUE              Faspex local storage definition (for browsing source)
        --recipient=VALUE            Use if recipient is a dropbox (with *)
        --box=ENUM                   Package box: [inbox], archive, sent


COMMAND: preview
SUBCOMMANDS: check events scan test trevents
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --skip-format=ENUM           Skip this preview format (multiple possible): png, mp4
        --folder-reset-cache=ENUM    Force detection of generated preview by refresh cache: [no], header, read
        --skip-types=VALUE           Skip types in comma separated list
        --previews-folder=VALUE      Preview folder in storage root
        --temp-folder=VALUE          Path to temp folder
        --skip-folders=VALUE         List of folder to skip
        --case=VALUE                 Basename of output for for test
        --scan-path=VALUE            Subpath in folder id to start scan in (default=/)
        --scan-id=VALUE              Folder id in storage to start scan in, default is access key main folder id
        --mimemagic=ENUM             Use Mime type detection of gem mimemagic: [no], yes
        --overwrite=ENUM             When to overwrite result file: always, never, [mtime]
        --file-access=ENUM           How to read and write files in repository: [local], remote
        --max-size=VALUE             Maximum size (in bytes) of preview file
        --thumb-vid-scale=VALUE      Png: video: size (ffmpeg scale argument)
        --thumb-vid-fraction=VALUE   Png: video: time percent position of snapshot
        --thumb-img-size=VALUE       Png: non-video: height (and width)
        --thumb-text-font=VALUE      Png: plaintext: font to render text with imagemagick convert (identify -list font)
        --video-conversion=ENUM      Mp4: method for preview generation: [reencode], blend, clips
        --video-png-conv=ENUM        Mp4: method for thumbnail generation: [fixed], animated
        --video-scale=VALUE          Mp4: all: video scale (ffmpeg)
        --video-start-sec=VALUE      Mp4: all: start offset (seconds) of video preview
        --reencode-ffmpeg=VALUE      Mp4: reencode: options to ffmpeg
        --blend-keyframes=VALUE      Mp4: blend: # key frames
        --blend-pauseframes=VALUE    Mp4: blend: # pause frames
        --blend-transframes=VALUE    Mp4: blend: # transition blend frames
        --blend-fps=VALUE            Mp4: blend: frame per second
        --clips-count=VALUE          Mp4: clips: number of clips
        --clips-length=VALUE         Mp4: clips: length in seconds of each clips


COMMAND: aoc
SUBCOMMANDS: admin automation bearer_token files gateway organization packages reminder servers tier_restrictions user
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --auth=ENUM                  OAuth type of authentication: web, [jwt]
        --operation=ENUM             Client operation for transfers: [push], pull
        --client-id=VALUE            OAuth API client identifier
        --client-secret=VALUE        OAuth API client secret
        --redirect-uri=VALUE         OAuth API client redirect URI
        --private-key=VALUE          OAuth JWT RSA private key PEM value (prefix file path with @file:)
        --scope=VALUE                OAuth scope for AoC API calls
        --passphrase=VALUE           RSA private key passphrase
        --workspace=VALUE            Name of workspace
        --name=VALUE                 TODO
        --link=VALUE                 Public link to shared resource
        --new-user-option=VALUE      New user creation option for unknown package recipients
        --from-folder=VALUE          Source folder for Folder-to-Folder transfer
        --validate-metadata=ENUM     Validate shared inbox metadata: no, [yes]

COMMAND: node
SUBCOMMANDS: access_keys api_details asperabrowser async basic_token browse central delete download events health http_node_download info license mkdir mkfile mklink rename search service space ssync stream sync transfer upload watch_folder
OPTIONS:
        --validator=VALUE            Identifier of validator (optional for central)
        --asperabrowserurl=VALUE     URL for simple aspera web ui
        --sync-name=VALUE            Sync name
        --default-ports=ENUM         Use standard FASP ports or get from node api (gen4): no, [yes]
        --sync-info=VALUE            Information for sync instance and sessions (Hash)


COMMAND: server
SUBCOMMANDS: browse cp delete df download du health info ls md5sum mkdir mv rename rm sync upload
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --ssh-keys=VALUE             SSH key path list (Array or single)
        --passphrase=VALUE           SSH private key passphrase
        --ssh-options=VALUE          SSH options (Hash)
        --sync-info=VALUE            Information for sync instance and sessions (Hash)


COMMAND: console
SUBCOMMANDS: health transfer
OPTIONS:
        --url=VALUE                  URL of application, e.g. https://faspex.example.com/aspera/faspex
        --username=VALUE             Username to log in
        --password=VALUE             User&#39;s password
        --filter-from=DATE           Only after date
        --filter-to=DATE             Only before date

</code></pre>
<blockquote>
<p><strong>Note:</strong> commands and parameter values can be written
in short form.</p>
</blockquote>
<h2 data-number="4.31"
id="bulk-creation-and-deletion-of-resources"><span
class="header-section-number">4.31</span> Bulk creation and deletion of
resources</h2>
<p>Bulk creation and deletion of resources are possible using option
<code>bulk</code> (yes,no(default)). In that case, the operation expects
an Array of Hash instead of a simple Hash using the <a
href="#extended">Extended Value Syntax</a>. This option is available
only for some of the resources: if you need it: try and see if the
entities you try to create or delete support this option.</p>
<h1 data-number="5" id="plugin-aoc-ibm-aspera-on-cloud"><span
class="header-section-number">5</span> <a id="aoc"></a>Plugin:
<code>aoc</code>: IBM Aspera on Cloud</h1>
<p>Aspera on Cloud uses the more advanced Oauth v2 mechanism for
authentication (HTTP Basic authentication is not supported).</p>
<p>It is recommended to use the wizard to set it up, although manual
configuration is also possible.</p>
<h2 data-number="5.1" id="configuration-using-wizard"><span
class="header-section-number">5.1</span>
<a id="aocwizard"></a>Configuration: using Wizard</h2>
<p><code>ascli</code> provides a configuration wizard.</p>
<p>The wizard guides you through the steps to create a new configuration
preset for Aspera on Cloud.</p>
<p>The first</p>
<p>Here is a sample invocation :</p>
<pre class="text"><code>ascli config wizard
option: url&gt; https://myorg.ibmaspera.com
Detected: Aspera on Cloud
Preparing preset: aoc_myorg
Please provide path to your private RSA key, or empty to generate one:
option: pkeypath&gt;
using existing key:
/Users/myself/.aspera/ascli/aspera_aoc_key
Using global client_id.
option: username&gt; john@example.com
Updating profile with new key
creating new config preset: aoc_myorg
Setting config preset as default for aspera
saving config file
Done.
You can test with:
ascli aoc user profile show</code></pre>
<p>Optionally, it is possible to create a new organization-specific
“integration”, i.e. client application identification. For this, specify
the option: <code>--use-generic-client=no</code>.</p>
<p>If you already know the application, and want to limit the detection
to it, provide url and plugin name:</p>
<div class="sourceCode" id="cb243"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config wizard myorg aoc</span></code></pre></div>
<h2 data-number="5.2" id="configuration-using-manual-setup"><span
class="header-section-number">5.2</span>
<a id="aocmanual"></a>Configuration: using manual setup</h2>
<blockquote>
<p><strong>Note:</strong> If you used the wizard (recommended): skip
this section.</p>
</blockquote>
<h3 data-number="5.2.1" id="configuration-details"><span
class="header-section-number">5.2.1</span> Configuration details</h3>
<p>Several types of OAuth authentication are supported:</p>
<ul>
<li>JSON Web Token (JWT) : authentication is secured by a private key
(recommended for <code>ascli</code>)</li>
<li>Web based authentication : authentication is made by user using a
browser</li>
<li>URL Token : external users authentication with url tokens (public
links)</li>
</ul>
<p>The authentication method is controlled by option
<code>auth</code>.</p>
<p>For a <em>quick start</em>, follow the mandatory and sufficient
section: <a href="#clientreg">API Client Registration</a> (auth=web) as
well as <a href="#aocpreset">[option preset](#lprt) for Aspera on
Cloud</a>.</p>
<p>For a more convenient, browser-less, experience follow the <a
href="#jwt">JWT</a> section (auth=jwt) in addition to Client
Registration.</p>
<p>In Oauth, a “Bearer” token are generated to authenticate REST calls.
Bearer tokens are valid for a period of time.<code>ascli</code> saves
generated tokens in its configuration folder, tries to re-use them or
regenerates them when they have expired.</p>
<h3 data-number="5.2.2" id="optional-api-client-registration"><span
class="header-section-number">5.2.2</span>
<a id="clientreg"></a>Optional: API Client Registration</h3>
<p>If you use the built-in client_id and client_secret, skip this and do
not set them in next section.</p>
<p>Else you can use a specific OAuth API client_id, the first step is to
declare <code>ascli</code> in Aspera on Cloud using the admin
interface.</p>
<p>(<a
href="https://ibmaspera.com/help/admin/organization/registering_an_api_client">AoC
documentation: Registering an API Client</a> ).</p>
<p>Let’s start by a registration with web based authentication
(auth=web):</p>
<ul>
<li>Open a web browser, log to your instance:
e.g. <code>https://myorg.ibmaspera.com/</code></li>
<li>Go to Apps → Admin → Organization → Integrations</li>
<li>Click “Create New”
<ul>
<li>Client Name: <code>ascli</code></li>
<li>Redirect URIs: <code>http://localhost:12345</code></li>
<li>Origins: <code>localhost</code></li>
<li>uncheck “Prompt users to allow client to access”</li>
<li>leave the JWT part for now</li>
</ul></li>
<li>Save</li>
</ul>
<blockquote>
<p><strong>Note:</strong> for web based authentication,
<code>ascli</code> listens on a local port (e.g. specified by the
redirect_uri, in this example: 12345), and the browser will provide the
OAuth code there. For `<code>ascli</code>, HTTP is required, and 12345
is the default port.</p>
</blockquote>
<p>Once the client is registered, a “Client ID” and “Secret” are
created, these values will be used in the next step.</p>
<h3 data-number="5.2.3" id="option-preset-for-aspera-on-cloud"><span
class="header-section-number">5.2.3</span> <a id="aocpreset"></a><a
href="#lprt">option preset</a> for Aspera on Cloud</h3>
<p>If you did not use the wizard, you can also manually create a <a
href="#lprt">option preset</a> for <code>ascli</code> in its
configuration file.</p>
<p>Lets create an <a href="#lprt">option preset</a> called:
<code>my_aoc_org</code> using <code>ask</code> interactive input (client
info from previous step):</p>
<div class="sourceCode" id="cb244"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset ask my_aoc_org url client_id client_secret</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="ex">option:</span> url<span class="op">&gt;</span> https://myorg.ibmaspera.com/</span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="ex">option:</span> client_id<span class="op">&gt;</span> my_client_id_here</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="ex">option:</span> client_secret<span class="op">&gt;</span> my_client_secret_here</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="ex">updated:</span> my_aoc_org</span></code></pre></div>
<p>(This can also be done in one line using the command
<code>config preset update my_aoc_org --url=...</code>)</p>
<p>Define this <a href="#lprt">option preset</a> as default
configuration for the <code>aspera</code> plugin:</p>
<div class="sourceCode" id="cb245"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default aoc my_aoc_org</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> Default <code>auth</code> method is
<code>web</code> and default <code>redirect_uri</code> is
<code>http://localhost:12345</code>. Leave those default values.</p>
</blockquote>
<h3 data-number="5.2.4"
id="activation-of-json-web-token-jwt-for-direct-authentication"><span
class="header-section-number">5.2.4</span> <a id="jwt"></a>Activation of
JSON Web Token (JWT) for direct authentication</h3>
<p>For a Browser-less, Private Key-based authentication, use the
following steps.</p>
<p>In order to use JWT for Aspera on Cloud API client authentication, a
<a href="#private_key">private/public key pair</a> must be used.</p>
<h4 data-number="5.2.4.1" id="api-client-jwt-activation"><span
class="header-section-number">5.2.4.1</span> API Client JWT
activation</h4>
<p>If you are not using the built-in client_id and secret, JWT needs to
be authorized in Aspera on Cloud. This can be done in two manners:</p>
<ul>
<li><p>Graphically</p>
<ul>
<li>Open a web browser, log to your instance:
<code>https://myorg.ibmaspera.com/</code></li>
<li>Go to Apps → Admin → Organization → Integrations</li>
<li>Click on the previously created application</li>
<li>select tab : “JSON Web Token Auth”</li>
<li>Modify options if necessary, for instance: activate both options in
section “Settings”</li>
<li>Click “Save”</li>
</ul></li>
<li><p>Using command line</p></li>
</ul>
<div class="sourceCode" id="cb246"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res client list</span></code></pre></div>
<pre class="output"><code>+------------+---------------+
|     id     |  name         |
+------------+---------------+
| my_BJbQiFw | my-client-app |
+------------+---------------+</code></pre>
<div class="sourceCode" id="cb248"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res client modify my_BJbQiFw @json:<span class="st">&#39;{&quot;jwt_grant_enabled&quot;:true,&quot;explicit_authorization_required&quot;:false}&#39;</span></span></code></pre></div>
<pre class="output"><code>modified</code></pre>
<h3 data-number="5.2.5" id="user-key-registration"><span
class="header-section-number">5.2.5</span> User key registration</h3>
<p>The public key must be assigned to your user. This can be done in two
manners:</p>
<h4 data-number="5.2.5.1" id="graphically"><span
class="header-section-number">5.2.5.1</span> Graphically</h4>
<p>Open the previously generated public key located here:
<code>$HOME/.aspera/ascli/my_private_key.pub</code></p>
<ul>
<li>Open a web browser, log to your instance:
<code>https://myorg.ibmaspera.com/</code></li>
<li>Click on the user’s icon (top right)</li>
<li>Select “Account Settings”</li>
<li>Paste the <em>Public Key</em> in the “Public Key” section</li>
<li>Click on “Submit”</li>
</ul>
<h4 data-number="5.2.5.2" id="using-command-line"><span
class="header-section-number">5.2.5.2</span> Using command line</h4>
<div class="sourceCode" id="cb250"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list</span></code></pre></div>
<pre class="output"><code>+--------+----------------+
|   id   |      name      |
+--------+----------------+
| 109952 | Tech Support   |
| 109951 | LAURENT MARTIN |
+--------+----------------+</code></pre>
<div class="sourceCode" id="cb252"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>ascli aoc user profile modify <span class="ot">@ruby</span>:<span class="vs">&#39;{&quot;public_key&quot;=&gt;File.read(File.expand_path(&quot;~/.aspera/ascli/my_private_key.pub&quot;))}&#39;</span></span></code></pre></div>
<pre class="output"><code>modified</code></pre>
<blockquote>
<p><strong>Note:</strong> the <code>aspera user info show</code> command
can be used to verify modifications.</p>
</blockquote>
<h3 data-number="5.2.6" id="option-preset-modification-for-jwt"><span
class="header-section-number">5.2.6</span> <a href="#lprt">option
preset</a> modification for JWT</h3>
<p>To activate default use of JWT authentication for <code>ascli</code>
using the <a href="#lprt">option preset</a>, do the following:</p>
<ul>
<li>change auth method to JWT</li>
<li>provide location of private key</li>
<li>provide username to login as (OAuth “subject”)</li>
</ul>
<p>Execute:</p>
<div class="sourceCode" id="cb254"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update my_aoc_org <span class="at">--auth</span><span class="op">=</span>jwt <span class="at">--private-key</span><span class="op">=</span>@val:@file:~/.aspera/ascli/my_private_key <span class="at">--username</span><span class="op">=</span>someuser@example.com</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> the private key argument represents the actual
PEM string. In order to read the content from a file, use the
<code>@file:</code> prefix. But if the <span class="citation"
data-cites="file">@file</span>: argument is used as is, it will read the
file and set in the config file. So to keep the “<span class="citation"
data-cites="file">@file</span>” tag in the configuration file, the
<code>@val:</code> prefix is added.</p>
</blockquote>
<p>After this last step, commands do not require web login anymore.</p>
<h3 data-number="5.2.7" id="first-use-1"><span
class="header-section-number">5.2.7</span> <a id="aocfirst"></a>First
Use</h3>
<p>Once client has been registered and <a href="#lprt">option preset</a>
created: <code>ascli</code> can be used:</p>
<div class="sourceCode" id="cb255"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files br /</span></code></pre></div>
<pre class="output"><code>Current Workspace: Default Workspace (default)
empty</code></pre>
<h2 data-number="5.3" id="calling-aoc-apis-from-command-line"><span
class="header-section-number">5.3</span> Calling AoC APIs from command
line</h2>
<p>The command <code>ascli aoc bearer</code> can be used to generate an
OAuth token suitable to call any AoC API (use the <code>scope</code>
option to change the scope, default is <code>user:all</code>). This can
be useful when a command is not yet available.</p>
<p>Example:</p>
<div class="sourceCode" id="cb257"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> <span class="at">-H</span> <span class="st">&quot;Authorization: </span><span class="va">$(</span><span class="ex">ascli</span> aoc bearer_token<span class="va">)</span><span class="st">&quot;</span> <span class="st">&#39;https://api.ibmaspera.com/api/v1/group_memberships?embed[]=dropbox&amp;embed[]=workspace&#39;</span><span class="kw">|</span><span class="ex">jq</span> <span class="at">-r</span> <span class="st">&#39;.[]|(.workspace.name + &quot; -&gt; &quot; + .dropbox.name)&#39;</span></span></code></pre></div>
<p>It is also possible to get the bearer token for node, as user or as
admin using:</p>
<div class="sourceCode" id="cb258"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files bearer_token_node /</span></code></pre></div>
<div class="sourceCode" id="cb259"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res node v4 1234 <span class="at">--secret</span><span class="op">=</span>_ak_secret_here_ bearer_token_node /</span></code></pre></div>
<h2 data-number="5.4" id="administration"><span
class="header-section-number">5.4</span> Administration</h2>
<p>The <code>admin</code> command allows several administrative tasks
(and require admin privilege).</p>
<p>It allows actions (create, update, delete) on “resources”: users,
group, nodes, workspace, etc… with the <code>admin resource</code>
command.</p>
<h3 data-number="5.4.1" id="listing-resources"><span
class="header-section-number">5.4.1</span> Listing resources</h3>
<p>The command <code>aoc admin res &lt;type&gt; list</code> lists all
entities of given type. It uses paging and multiple requests if
necessary.</p>
<p>The option <code>query</code> can be optionally used. It expects a
<code>Hash</code> using <a href="#extended">Extended Value Syntax</a>,
generally provided using: <code>--query=@json:{...}</code>. Values are
directly sent to the API call and used as a filter on server side.</p>
<p>The following parameters are supported:</p>
<ul>
<li><code>q</code> : a filter on name of resource (case insensitive,
matches if value is contained in name)</li>
<li><code>sort</code>: name of fields to sort results, prefix with
<code>-</code> for reverse order.</li>
<li><code>max</code> : maximum number of items to retrieve (stop pages
when the maximum is passed)</li>
<li><code>pmax</code> : maximum number of pages to request (stop pages
when the maximum is passed)</li>
<li><code>page</code> : native api parameter, in general do not use
(added by</li>
<li><code>per_page</code> : native api parameter, number of items par
api call, in general do not use</li>
<li>Other specific parameters depending on resource type.</li>
</ul>
<p>Both <code>max</code> and <code>pmax</code> are processed internally
in <code>ascli</code>, not included in actual API call and limit the
number of successive pages requested to API. <code>ascli</code> will
return all values using paging if not provided.</p>
<p>Other parameters are directly sent as parameters to the GET request
on API.</p>
<p><code>page</code> and <code>per_page</code> are normally added by
<code>ascli</code> to build successive API calls to get all values if
there are more than 1000. (AoC allows a maximum page size of 1000).</p>
<p><code>q</code> and <code>sort</code> are available on most resource
types.</p>
<p>Other parameters depend on the type of entity (refer to AoC API).</p>
<p>Examples:</p>
<ul>
<li>List users with <code>laurent</code> in name:</li>
</ul>
<div class="sourceCode" id="cb260"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;q&quot;:&quot;laurent&quot;}&#39;</span></span></code></pre></div>
<ul>
<li>List users who logged-in before a date:</li>
</ul>
<div class="sourceCode" id="cb261"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;q&quot;:&quot;last_login_at:&lt;2018-05-28&quot;}&#39;</span></span></code></pre></div>
<ul>
<li>List external users and sort in reverse alphabetical order using
name:</li>
</ul>
<div class="sourceCode" id="cb262"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;member_of_any_workspace&quot;:false,&quot;sort&quot;:&quot;-name&quot;}&#39;</span></span></code></pre></div>
<p>Refer to the AoC API for full list of query parameters, or use the
browser in developer mode with the web UI.</p>
<blockquote>
<p><strong>Note:</strong> The option <code>select</code> can also be
used to further refine selection, refer to <a
href="#option_select">section earlier</a>.</p>
</blockquote>
<h3 data-number="5.4.2" id="selecting-a-resource"><span
class="header-section-number">5.4.2</span>
<a id="res_select"></a>Selecting a resource</h3>
<p>Resources are identified by a unique <code>id</code>, as well as a
unique <code>name</code> (case insensitive).</p>
<p>To execute an action on a specific resource, select it using one of
those methods:</p>
<ul>
<li><em>recommended</em>: give id directly on command line <em>after the
action</em>: <code>aoc admin res node show 123</code></li>
<li>give name on command line <em>after the action</em>:
<code>aoc admin res node show name abc</code></li>
<li>provide option <code>id</code> :
<code>aoc admin res node show 123</code></li>
<li>provide option <code>name</code> :
<code>aoc admin res node show --name=abc</code></li>
</ul>
<h3 data-number="5.4.3" id="creating-a-resource"><span
class="header-section-number">5.4.3</span>
<a id="res_create"></a>Creating a resource</h3>
<p>New resources (users, groups, workspaces, etc..) can be created using
a command like:</p>
<div class="sourceCode" id="cb263"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res create <span class="op">&lt;</span>resource type<span class="op">&gt;</span> @json:<span class="st">&#39;{&lt;...parameters...&gt;}&#39;</span></span></code></pre></div>
<p>Some of the API endpoints are described <a
href="https://developer.ibm.com/apis/catalog?search=%22aspera%20on%20cloud%20api%22">here</a>.
Sadly, not all.</p>
<p>Nevertheless, it is possible to guess the structure of the creation
value by simply dumping an existing resource, and use the same
parameters for the creation.</p>
<div class="sourceCode" id="cb264"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res group show 12345 <span class="at">--format</span><span class="op">=</span>json</span></code></pre></div>
<div class="sourceCode" id="cb265"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;created_at&quot;</span><span class="fu">:</span><span class="st">&quot;2018-07-24T21:46:39.000Z&quot;</span><span class="fu">,</span><span class="dt">&quot;description&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;id&quot;</span><span class="fu">:</span><span class="st">&quot;12345&quot;</span><span class="fu">,</span><span class="dt">&quot;manager&quot;</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;A8Demo WS1&quot;</span><span class="fu">,</span><span class="dt">&quot;owner&quot;</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">&quot;queued_operation_count&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;running_operation_count&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;stopped_operation_count&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;updated_at&quot;</span><span class="fu">:</span><span class="st">&quot;2018-07-24T21:46:39.000Z&quot;</span><span class="fu">,</span><span class="dt">&quot;saml_group&quot;</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">&quot;saml_group_dn&quot;</span><span class="fu">:</span><span class="kw">null</span><span class="fu">,</span><span class="dt">&quot;system_group&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span><span class="dt">&quot;system_group_type&quot;</span><span class="fu">:</span><span class="st">&quot;workspace_members&quot;</span><span class="fu">}</span></span></code></pre></div>
<p>Remove the parameters that are either obviously added by the system:
<code>id</code>, <code>created_at</code>, <code>updated_at</code> or
optional.</p>
<p>And then craft your command:</p>
<div class="sourceCode" id="cb266"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res group create @json:<span class="st">&#39;{&quot;description&quot;:&quot;test to delete&quot;,&quot;name&quot;:&quot;test 1 to delete&quot;,&quot;saml_group&quot;:false}&#39;</span></span></code></pre></div>
<p>If the command returns an error, example:</p>
<pre class="output"><code>+----+-----------------------------------------------------------------------------------+
| id | status                                                                            |
+----+-----------------------------------------------------------------------------------+
|    | found unpermitted parameters: :manager, :owner, :system_group, :system_group_type |
|    | code: unpermitted_parameters                                                      |
|    | request_id: b0f45d5b-c00a-4711-acef-72b633f8a6ea                                  |
|    | api.ibmaspera.com 422 Unprocessable Entity                                        |
+----+-----------------------------------------------------------------------------------+```</code></pre>
<p>Well, remove the offending parameters and try again.</p>
<blockquote>
<p><strong>Note:</strong> Some properties that are shown in the web UI,
such as membership, are not listed directly in the resource, but instead
another resource is created to link a user and its group:
<code>group_membership</code></p>
</blockquote>
<h3 data-number="5.4.4" id="access-key-secrets"><span
class="header-section-number">5.4.4</span> Access Key secrets</h3>
<p>In order to access some administrative actions on
<strong>nodes</strong> (in fact, access keys), the associated secret is
required. The secret is provided using the <code>secret</code> option.
For example in a command like:</p>
<div class="sourceCode" id="cb268"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res node 123 <span class="at">--secret</span><span class="op">=</span><span class="st">&quot;my_secret_here&quot;</span> v3 info</span></code></pre></div>
<p>It is also possible to store secrets in the <a href="#vault">secret
vault</a> and then automatically find the related secret using the <a
href="#config_finder">config finder</a>.</p>
<h3 data-number="5.4.5" id="activity"><span
class="header-section-number">5.4.5</span> Activity</h3>
<p>The activity app can be queried with:</p>
<div class="sourceCode" id="cb269"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin analytics transfers</span></code></pre></div>
<p>It can also support filters and send notification using option
<code>notif_to</code>. a template is defined using option
<code>notif_template</code> :</p>
<p><code>mytemplate.erb</code>:</p>
<div class="sourceCode" id="cb270"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="ex">From:</span> <span class="op">&lt;</span>%=from_name%<span class="op">&gt;</span> <span class="op">&lt;&lt;%=from_email%&gt;&gt;</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="st">To: &lt;&lt;%=ev[&#39;user_email&#39;]%&gt;&gt;</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="st">Subject: &lt;%=ev[&#39;files_completed&#39;]%&gt; files received</span></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="st">Dear &lt;%=ev[:user_email.to_s]%&gt;,</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="st">We received &lt;%=ev[&#39;files_completed&#39;]%&gt; files for a total of &lt;%=ev[&#39;transferred_bytes&#39;]%&gt; bytes, starting with file:</span></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;%=ev[&#39;content&#39;]%&gt;</span></span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="st">Thank you.</span></span></code></pre></div>
<p>The environment provided contains the following additional
variable:</p>
<ul>
<li>ev : all details on the transfer event</li>
</ul>
<p>Example:</p>
<div class="sourceCode" id="cb271"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin analytics transfers <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--lock-port</span><span class="op">=</span>12345 <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;status&quot;:&quot;completed&quot;,&quot;direction&quot;:&quot;receive&quot;}&#39;</span> <span class="at">--notif-to</span><span class="op">=</span>active <span class="at">--notif-template</span><span class="op">=</span>@file:mytemplate.erb</span></code></pre></div>
<p>Options:</p>
<ul>
<li><code>once_only</code> keep track of last date it was called, so
next call will get only new events</li>
<li><code>query</code> filter (on API call)</li>
<li><code>notify</code> send an email as specified by template, this
could be places in a file with the <code>@file</code> modifier.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> This must not be executed in less than 5
minutes because the analytics interface accepts only a period of time
between 5 minutes and 6 months. The period is [date of previous
execution]..[now].</p>
</blockquote>
<h3 data-number="5.4.6"
id="transfer-using-specific-transfer-ports"><span
class="header-section-number">5.4.6</span> Transfer: Using specific
transfer ports</h3>
<p>By default transfer nodes are expected to use ports TCP/UDP 33001.
The web UI enforces that. The option <code>default_ports</code>
([yes]/no) allows ascli to retrieve the server ports from an API call
(download_setup) which reads the information from
<code>aspera.conf</code> on the server.</p>
<h3 data-number="5.4.7" id="using-ats"><span
class="header-section-number">5.4.7</span> Using ATS</h3>
<p>Refer to section “Examples” of <a href="#ats">ATS</a> and substitute
command <code>ats</code> with <code>aoc admin ats</code>.</p>
<h3 data-number="5.4.8" id="files-with-type-link"><span
class="header-section-number">5.4.8</span> Files with type
<code>link</code></h3>
<p>Aspera on Cloud Shared folders are implemented through a special type
of file: <code>link</code>. A <code>link</code> is the equivalent of a
symbolic link on a file system: it points to another folder (not
file).</p>
<p>Listing a link (in terminal position of path) will information on the
link itself, not the content of the folder it points to. To list the
target folder content, add a <code>/</code> a the end of the path.</p>
<p>Example:</p>
<pre class="console"><code>$ ascli aoc files br the_link
Current Workspace: Default (default)
+------------+------+----------------+------+----------------------+--------------+
| name       | type | recursive_size | size | modified_time        | access_level |
+------------+------+----------------+------+----------------------+--------------+
| the_link   | link |                |      | 2021-04-28T09:17:14Z | edit         |
+------------+------+----------------+------+----------------------+--------------+</code></pre>
<pre class="console"><code>$ ascli aoc files br the_link/
Current Workspace: Default (default)
+-------------+------+----------------+------+----------------------+--------------+
| name        | type | recursive_size | size | modified_time        | access_level |
+-------------+------+----------------+------+----------------------+--------------+
| file_inside | file |                |      | 2021-04-26T09:00:00Z | edit         |
+-------------+------+----------------+------+----------------------+--------------+</code></pre>
<h3 data-number="5.4.9" id="example-bulk-creation-of-users"><span
class="header-section-number">5.4.9</span> Example: Bulk creation of
users</h3>
<div class="sourceCode" id="cb274"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user create <span class="at">--bulk</span><span class="op">=</span>yes @json:<span class="st">&#39;[{&quot;email&quot;:&quot;dummyuser1@example.com&quot;},{&quot;email&quot;:&quot;dummyuser2@example.com&quot;}]&#39;</span></span></code></pre></div>
<pre class="output"><code>+-------+---------+
|  id   | status  |
+-------+---------+
| 98398 | created |
| 98399 | created |
+-------+---------+</code></pre>
<h3 data-number="5.4.10" id="example-find-with-filter-and-delete"><span
class="header-section-number">5.4.10</span> Example: Find with filter
and delete</h3>
<div class="sourceCode" id="cb276"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--query</span><span class="op">=</span><span class="st">&#39;@json:{&quot;q&quot;:&quot;dummyuser&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id,email</span></code></pre></div>
<pre class="output"><code>+-------+------------------------+
|  id   |         email          |
+-------+------------------------+
| 98398 | dummyuser1@example.com |
| 98399 | dummyuser2@example.com |
+-------+------------------------+</code></pre>
<div class="sourceCode" id="cb278"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--query</span><span class="op">=</span><span class="st">&#39;@json:{&quot;q&quot;:&quot;dummyuser&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id <span class="at">--display</span><span class="op">=</span>data <span class="at">--format</span><span class="op">=</span>csv <span class="kw">|</span> <span class="ex">ascli</span> aoc admin res user delete @lines:@stdin: <span class="at">--bulk</span><span class="op">=</span>yes</span></code></pre></div>
<pre class="output"><code>+-------+---------+
|  id   | status  |
+-------+---------+
| 98398 | deleted |
| 98399 | deleted |
+-------+---------+</code></pre>
<h3 data-number="5.4.11"
id="example-find-deactivated-users-since-more-than-2-years"><span
class="header-section-number">5.4.11</span> Example:
<a id="deactuser"></a>Find deactivated users since more than 2
years</h3>
<div class="sourceCode" id="cb280"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>ascli aoc admin res user list <span class="kw">--</span>query<span class="kw">=</span><span class="ot">@ruby</span>:<span class="vs">&#39;{&quot;deactivated&quot;=&gt;true,&quot;q&quot;=&gt;&quot;last_login_at:&lt;#{(DateTime.now.to_time.utc-2*365*86400).iso8601}&quot;}&#39;</span></span></code></pre></div>
<p>To delete them use the same method as before</p>
<h3 data-number="5.4.12"
id="example-display-current-users-workspaces"><span
class="header-section-number">5.4.12</span> Example: Display current
user’s workspaces</h3>
<div class="sourceCode" id="cb281"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc user workspaces list</span></code></pre></div>
<pre class="output"><code>+------+----------------------------+
|  id  |            name            |
+------+----------------------------+
| 16   | Engineering                |
| 17   | Marketing                  |
| 18   | Sales                      |
+------+----------------------------+</code></pre>
<h3 data-number="5.4.13"
id="example-create-a-sub-access-key-in-a-node"><span
class="header-section-number">5.4.13</span> Example: Create a sub access
key in a “node”</h3>
<p>Creation of a sub-access key is like creation of access key with the
following difference: authentication to node API is made with accesskey
(master access key) and only the path parameter is provided: it is
relative to the storage root of the master key. (id and secret are
optional)</p>
<div class="sourceCode" id="cb283"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin resource node <span class="at">--name</span><span class="op">=</span>_node_name_ <span class="at">--secret</span><span class="op">=</span>_secret_ v4 access_key create @json:<span class="st">&#39;{&quot;storage&quot;:{&quot;path&quot;:&quot;/folder1&quot;}}&#39;</span></span></code></pre></div>
<h3 data-number="5.4.14"
id="example-display-transfer-events-opstransfer"><span
class="header-section-number">5.4.14</span> Example: Display transfer
events (ops/transfer)</h3>
<div class="sourceCode" id="cb284"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res node <span class="at">--secret</span><span class="op">=</span>_secret_ v3 transfer list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;[[&quot;q&quot;,&quot;*&quot;],[&quot;count&quot;,5]]&#39;</span></span></code></pre></div>
<p>Examples of query:</p>
<div class="sourceCode" id="cb285"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;q&quot;</span><span class="fu">:</span><span class="st">&quot;type(file_upload OR file_delete OR file_download OR file_rename OR folder_create OR folder_delete OR folder_share OR folder_share_via_public_link)&quot;</span><span class="fu">,</span><span class="dt">&quot;sort&quot;</span><span class="fu">:</span><span class="st">&quot;-date&quot;</span><span class="fu">}</span></span></code></pre></div>
<div class="sourceCode" id="cb286"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;tag&quot;</span><span class="fu">:</span><span class="st">&quot;aspera.files.package_id=LA8OU3p8w&quot;</span><span class="fu">}</span></span></code></pre></div>
<h3 data-number="5.4.15" id="example-display-node-events-events"><span
class="header-section-number">5.4.15</span> Example: Display node events
(events)</h3>
<div class="sourceCode" id="cb287"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res node <span class="at">--secret</span><span class="op">=</span>_secret_ v3 events</span></code></pre></div>
<h3 data-number="5.4.16"
id="example-display-members-of-a-workspace"><span
class="header-section-number">5.4.16</span> Example: Display members of
a workspace</h3>
<div class="sourceCode" id="cb288"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res workspace_membership list <span class="at">--fields</span><span class="op">=</span>member_type,manager,member.email <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;embed&quot;:&quot;member&quot;,&quot;inherited&quot;:false,&quot;workspace_id&quot;:11363,&quot;sort&quot;:&quot;name&quot;}&#39;</span></span></code></pre></div>
<pre class="output"><code>+-------------+---------+----------------------------------+
| member_type | manager |           member.email           |
+-------------+---------+----------------------------------+
| user        | true    | john.curtis@email.com            |
| user        | false   | someuser@example.com |
| user        | false   | jean.dupont@me.com               |
| user        | false   | another.user@example.com         |
| group       | false   |                                  |
| user        | false   | aspera.user@gmail.com            |
+-------------+---------+----------------------------------+</code></pre>
<p>Other query parameters:</p>
<div class="sourceCode" id="cb290"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;workspace_membership_through&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span><span class="dt">&quot;include_indirect&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">}</span></span></code></pre></div>
<h3 data-number="5.4.17"
id="example-add-all-members-of-a-workspace-to-another-workspace"><span
class="header-section-number">5.4.17</span> Example:
<a id="aoc_sample_member"></a>add all members of a workspace to another
workspace</h3>
<p>a- Get id of first workspace</p>
<div class="sourceCode" id="cb291"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="va">WS1</span><span class="op">=</span><span class="st">&#39;First Workspace&#39;</span></span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="va">WS1ID</span><span class="op">=</span><span class="va">$(</span><span class="ex">ascli</span> aoc admin res workspace list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;q&quot;:&quot;&#39;&quot;</span><span class="va">$WS1</span><span class="st">&quot;&#39;&quot;}&#39;</span> <span class="at">--select</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;&#39;&quot;</span><span class="va">$WS1</span><span class="st">&quot;&#39;&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id <span class="at">--format</span><span class="op">=</span>csv<span class="va">)</span></span></code></pre></div>
<p>b- Get id of second workspace</p>
<div class="sourceCode" id="cb292"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="va">WS2</span><span class="op">=</span><span class="st">&#39;Second Workspace&#39;</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="va">WS2ID</span><span class="op">=</span><span class="va">$(</span><span class="ex">ascli</span> aoc admin res workspace list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;q&quot;:&quot;&#39;&quot;</span><span class="va">$WS2</span><span class="st">&quot;&#39;&quot;}&#39;</span> <span class="at">--select</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;&#39;&quot;</span><span class="va">$WS2</span><span class="st">&quot;&#39;&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id <span class="at">--format</span><span class="op">=</span>csv<span class="va">)</span></span></code></pre></div>
<p>c- Extract membership information</p>
<div class="sourceCode" id="cb293"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res workspace_membership list <span class="at">--fields</span><span class="op">=</span>manager,member_id,member_type,workspace_id <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;workspace_id&quot;:&#39;&quot;</span><span class="va">$WS1ID</span><span class="st">&quot;&#39;}&#39;</span> <span class="at">--format</span><span class="op">=</span>jsonpp <span class="op">&gt;</span> ws1_members.json</span></code></pre></div>
<p>d- Convert to creation data for second workspace:</p>
<div class="sourceCode" id="cb294"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-Eve</span> <span class="st">&#39;(direct|effective_manager|_count|storage|&quot;id&quot;)&#39;</span> ws1_members.json<span class="kw">|</span><span class="fu">sed</span> <span class="st">&#39;/workspace_id/ s/&quot;&#39;&quot;</span><span class="va">$WS1ID</span><span class="st">&quot;&#39;&quot;/&quot;&#39;&quot;</span><span class="va">$WS2ID</span><span class="st">&quot;&#39;&quot;/g&#39;</span> <span class="op">&gt;</span> ws2_members.json</span></code></pre></div>
<p>or, using jq:</p>
<div class="sourceCode" id="cb295"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="ex">jq</span> <span class="st">&#39;[.[] | {member_type,member_id,workspace_id,manager,workspace_id:&quot;&#39;&quot;</span><span class="va">$WS2ID</span><span class="st">&quot;&#39;&quot;}]&#39;</span> ws1_members.json <span class="op">&gt;</span> ws2_members.json</span></code></pre></div>
<p>e- Add members to second workspace</p>
<div class="sourceCode" id="cb296"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res workspace_membership create <span class="at">--bulk</span><span class="op">=</span>yes @json:@file:ws2_members.json</span></code></pre></div>
<h3 data-number="5.4.18"
id="example-get-users-who-did-not-log-since-a-date"><span
class="header-section-number">5.4.18</span> Example: Get users who did
not log since a date</h3>
<div class="sourceCode" id="cb297"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--fields</span><span class="op">=</span>email <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;q&quot;:&quot;last_login_at:&lt;2018-05-28&quot;}&#39;</span></span></code></pre></div>
<pre class="output"><code>+-------------------------------+
|             email             |
+-------------------------------+
| John.curtis@acme.com          |
| Jean.Dupont@tropfort.com      |
+-------------------------------+</code></pre>
<h3 data-number="5.4.19" id="example-list-limited-users"><span
class="header-section-number">5.4.19</span> Example: List “Limited”
users</h3>
<div class="sourceCode" id="cb299"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--fields</span><span class="op">=</span>email <span class="at">--select</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;member_of_any_workspace&quot;:false}&#39;</span></span></code></pre></div>
<h3 data-number="5.4.20"
id="example-create-a-group-add-to-workspace-and-add-user-to-group"><span
class="header-section-number">5.4.20</span> Example: create a group, add
to workspace and add user to group</h3>
<ul>
<li>Create the group and take note of <code>id</code></li>
</ul>
<div class="sourceCode" id="cb300"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res group create @json:<span class="st">&#39;{&quot;name&quot;:&quot;group 1&quot;,&quot;description&quot;:&quot;my super group&quot;}&#39;</span></span></code></pre></div>
<p>Group: <code>11111</code></p>
<ul>
<li>Get the workspace id</li>
</ul>
<div class="sourceCode" id="cb301"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res workspace list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;q&quot;:&quot;myworkspace&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id <span class="at">--format</span><span class="op">=</span>csv <span class="at">--display</span><span class="op">=</span>data</span></code></pre></div>
<p>Workspace: 22222</p>
<ul>
<li>Add group to workspace</li>
</ul>
<div class="sourceCode" id="cb302"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res workspace_membership create @json:<span class="st">&#39;{&quot;workspace_id&quot;:22222,&quot;member_type&quot;:&quot;user&quot;,&quot;member_id&quot;:11111}&#39;</span></span></code></pre></div>
<ul>
<li>Get a user’s id</li>
</ul>
<div class="sourceCode" id="cb303"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res user list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;q&quot;:&quot;manu.macron@example.com&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id <span class="at">--format</span><span class="op">=</span>csv <span class="at">--display</span><span class="op">=</span>data</span></code></pre></div>
<p>User: 33333</p>
<ul>
<li>Add user to group</li>
</ul>
<div class="sourceCode" id="cb304"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res group_membership create @json:<span class="st">&#39;{&quot;group_id&quot;:11111,&quot;member_type&quot;:&quot;user&quot;,&quot;member_id&quot;:33333}&#39;</span></span></code></pre></div>
<h3 data-number="5.4.21"
id="example-perform-a-multi-gbps-transfer-between-two-remote-shared-folders"><span
class="header-section-number">5.4.21</span> Example: Perform a multi
Gbps transfer between two remote shared folders</h3>
<p>In this example, a user has access to a workspace where two shared
folders are located on different sites, e.g. different cloud
regions.</p>
<p>First, setup the environment (skip if already done)</p>
<div class="sourceCode" id="cb305"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf wizard <span class="at">--url</span><span class="op">=</span>https://sedemo.ibmaspera.com <span class="at">--username</span><span class="op">=</span>someuser@example.com</span></code></pre></div>
<pre class="output"><code>Detected: Aspera on Cloud
Preparing preset: aoc_sedemo
Using existing key:
/Users/laurent/.aspera/ascli/aspera_aoc_key
Using global client_id.
Please Login to your Aspera on Cloud instance.
Navigate to your &quot;Account Settings&quot;
Check or update the value of &quot;Public Key&quot; to be:
-----BEGIN PUBLIC KEY-----
SOME PUBLIC KEY PEM DATA HERE
-----END PUBLIC KEY-----
Once updated or validated, press enter.

creating new config preset: aoc_sedemo
Setting config preset as default for aspera
saving config file
Done.
You can test with:
ascli aoc user profile show</code></pre>
<p>This creates the option preset “aoc_&lt;org name&gt;” to allow
seamless command line access and sets it as default for aspera on
cloud.</p>
<p>Then, create two shared folders located in two regions, in your files
home, in a workspace.</p>
<p>Then, transfer between those:</p>
<div class="sourceCode" id="cb307"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">-Paoc_show</span> aoc files transfer <span class="at">--from-folder</span><span class="op">=</span><span class="st">&#39;IBM Cloud SJ&#39;</span> <span class="at">--to-folder</span><span class="op">=</span><span class="st">&#39;AWS Singapore&#39;</span> 100GB.file <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;target_rate_kbps&quot;:&quot;1000000&quot;,&quot;multi_session&quot;:10,&quot;multi_session_threshold&quot;:1}&#39;</span></span></code></pre></div>
<h3 data-number="5.4.22"
id="example-create-registration-key-to-register-a-node"><span
class="header-section-number">5.4.22</span> Example: create registration
key to register a node</h3>
<div class="sourceCode" id="cb308"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res client create @json:<span class="st">&#39;{&quot;data&quot;:{&quot;name&quot;:&quot;laurentnode&quot;,&quot;client_subject_scopes&quot;:[&quot;alee&quot;,&quot;aejd&quot;],&quot;client_subject_enabled&quot;:true}}&#39;</span> <span class="at">--fields</span><span class="op">=</span>token <span class="at">--format</span><span class="op">=</span>csv</span></code></pre></div>
<pre class="output"><code>jfqslfdjlfdjfhdjklqfhdkl</code></pre>
<h3 data-number="5.4.23" id="example-delete-all-registration-keys"><span
class="header-section-number">5.4.23</span> Example: delete all
registration keys</h3>
<div class="sourceCode" id="cb310"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res client list <span class="at">--fields</span><span class="op">=</span>id <span class="at">--format</span><span class="op">=</span>csv<span class="kw">|</span><span class="ex">ascli</span> aoc admin res client delete @lines:@stdin: <span class="at">--bulk</span><span class="op">=</span>yes</span></code></pre></div>
<pre class="output"><code>+-----+---------+
| id  | status  |
+-----+---------+
| 99  | deleted |
| 100 | deleted |
| 101 | deleted |
| 102 | deleted |
+-----+---------+</code></pre>
<h3 data-number="5.4.24" id="example-create-a-node"><span
class="header-section-number">5.4.24</span> Example: Create a Node</h3>
<p>AoC nodes as actually composed with two related entities:</p>
<ul>
<li>An access key created on the Transfer Server (HSTS/ATS)</li>
<li>a <code>node</code> resource in the AoC application.</li>
</ul>
<p>The web UI allows creation of both entities in one shot. For more
flexibility, <code>ascli</code> allows this in two separate steps.</p>
<blockquote>
<p><strong>Note:</strong> When selecting “Use existing access key” in
the web UI, this actually skips access key creation (first step).</p>
</blockquote>
<p>So, for example, the creation of a node using ATS in IBM Cloud looks
like (see other example in this manual):</p>
<ul>
<li><p>Create the access key on ATS</p>
<p>The creation options are the ones of ATS API, refer to the <a
href="#ats_params">section on ATS</a> for more details and examples.</p>
<div class="sourceCode" id="cb312"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin ats access_key create <span class="at">--cloud</span><span class="op">=</span>softlayer <span class="at">--region</span><span class="op">=</span>eu-de <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;storage&quot;:{&quot;type&quot;:&quot;ibm-s3&quot;,&quot;bucket&quot;:&quot;mybucket&quot;,&quot;credentials&quot;:{&quot;access_key_id&quot;:&quot;mykey&quot;,&quot;secret_access_key&quot;:&quot;mysecret&quot;},&quot;path&quot;:&quot;/&quot;}}&#39;</span></span></code></pre></div>
<p>Once executed, the access key <code>id</code> and
<code>secret</code>, randomly generated by the node api, is
displayed.</p>
<blockquote>
<p><strong>Note:</strong> Once returned by the API, the secret will not
be available anymore, so store this preciously. ATS secrets can only be
reset by asking to IBM support.</p>
</blockquote></li>
<li><p>Create the AoC node entity</p>
<p>First, Retrieve the ATS node address</p>
<div class="sourceCode" id="cb313"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin ats cluster show <span class="at">--cloud</span><span class="op">=</span>softlayer <span class="at">--region</span><span class="op">=</span>eu-de <span class="at">--fields</span><span class="op">=</span>transfer_setup_url <span class="at">--format</span><span class="op">=</span>csv <span class="at">--transpose-single</span><span class="op">=</span>no</span></code></pre></div>
<p>Then use the returned address for the <code>url</code> key to
actually create the AoC Node entity:</p>
<div class="sourceCode" id="cb314"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res node create @json:<span class="st">&#39;{&quot;name&quot;:&quot;myname&quot;,&quot;access_key&quot;:&quot;myaccesskeyid&quot;,&quot;ats_access_key&quot;:true,&quot;ats_storage_type&quot;:&quot;ibm-s3&quot;,&quot;url&quot;:&quot;https://ats-sl-fra-all.aspera.io&quot;}&#39;</span></span></code></pre></div></li>
</ul>
<p>Creation of a node with a self-managed node is similar, but the
command <code>aoc admin ats access_key create</code> is replaced with
<code>node access_key create</code> on the private node itself.</p>
<h2 data-number="5.5" id="list-of-files-to-transfer"><span
class="header-section-number">5.5</span> List of files to transfer</h2>
<p>Source files are provided as a list with the <code>sources</code>
option. Refer to section <a href="#file_list">File list</a></p>
<blockquote>
<p><strong>Note:</strong> A special case is when the source files are
located on <strong>Aspera on Cloud</strong> (i.e. using access keys and
the <code>file id</code> API).</p>
</blockquote>
<p>Source files are located on “Aspera on cloud”, when :</p>
<ul>
<li>the server is Aspera on Cloud, and executing a download or recv</li>
<li>the agent is Aspera on Cloud, and executing an upload or send</li>
</ul>
<p>In this case:</p>
<ul>
<li>If there is a single file : specify the full path</li>
<li>Else, if there are multiple files:
<ul>
<li>All source files must be in the same source folder</li>
<li>Specify the source folder as first item in the list</li>
<li>followed by the list of file names.</li>
</ul></li>
</ul>
<h2 data-number="5.6" id="packages"><span
class="header-section-number">5.6</span> Packages</h2>
<p>The webmail-like application.</p>
<h3 data-number="5.6.1" id="send-a-package"><span
class="header-section-number">5.6.1</span> Send a Package</h3>
<p>General syntax:</p>
<div class="sourceCode" id="cb315"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages send [package extended value] [other parameters such as file list and transfer parameters]</span></code></pre></div>
<p>Notes:</p>
<ul>
<li>Package creation parameter are sent as positional argument. Refer to
the AoC package creation API, or display an existing package in JSON to
list attributes.</li>
<li>List allowed shared inbox destinations with:
<code>ascli aoc packages shared_inboxes list</code></li>
<li>Use fields: <code>recipients</code> and/or
<code>bcc_recipients</code> to provide the list of recipients: user or
shared inbox.
<ul>
<li>Provide either ids as expected by API:
<code>"recipients":[{"type":"dropbox","id":"1234"}]</code></li>
<li>or just names: <code>"recipients":[{"The Dest"}]</code> . ascli will
resolve the list of email addresses and dropbox names to the expected
type/id list, based on case insensitive partial match.</li>
</ul></li>
<li>If a user recipient (email) is not already registered and the
workspace allows external users, then the package is sent to an external
user, and
<ul>
<li>if the option <code>new_user_option</code> is
<code>@json:{"package_contact":true}</code> (default), then a public
link is sent and the external user does not need to create an
account</li>
<li>if the option <code>new_user_option</code> is <code>@json:{}</code>,
then external users are invited to join the workspace</li>
</ul></li>
</ul>
<h3 data-number="5.6.2"
id="example-send-a-package-with-one-file-to-two-users-using-their-email"><span
class="header-section-number">5.6.2</span> Example: Send a package with
one file to two users, using their email</h3>
<div class="sourceCode" id="cb316"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages send @json:<span class="st">&#39;{&quot;name&quot;:&quot;my title&quot;,&quot;note&quot;:&quot;my note&quot;,&quot;recipients&quot;:[&quot;someuser@example.com&quot;,&quot;other@example.com&quot;]}&#39;</span> my_file.dat</span></code></pre></div>
<h3 data-number="5.6.3"
id="example-send-a-package-to-a-shared-inbox-with-metadata"><span
class="header-section-number">5.6.3</span> Example: Send a package to a
shared inbox with metadata</h3>
<div class="sourceCode" id="cb317"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages send <span class="at">--workspace</span><span class="op">=</span>eudemo @json:<span class="st">&#39;{&quot;name&quot;:&quot;my pack title&quot;,&quot;recipients&quot;:[&quot;Shared Inbox With Meta&quot;],&quot;metadata&quot;:{&quot;Project Id&quot;:&quot;123&quot;,&quot;Type&quot;:&quot;Opt2&quot;,&quot;CheckThose&quot;:[&quot;Check1&quot;,&quot;Check2&quot;],&quot;Optional Date&quot;:&quot;2021-01-13T15:02:00.000Z&quot;}}&#39;</span> ~/Documents/Samples/200KB.1</span></code></pre></div>
<p>It is also possible to use identifiers and API parameters:</p>
<div class="sourceCode" id="cb318"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages send <span class="at">--workspace</span><span class="op">=</span>eudemo @json:<span class="st">&#39;{&quot;name&quot;:&quot;my pack title&quot;,&quot;recipients&quot;:[{&quot;type&quot;:&quot;dropbox&quot;,&quot;id&quot;:&quot;12345&quot;}],&quot;metadata&quot;:[{&quot;input_type&quot;:&quot;single-text&quot;,&quot;name&quot;:&quot;Project Id&quot;,&quot;values&quot;:[&quot;123&quot;]},{&quot;input_type&quot;:&quot;single-dropdown&quot;,&quot;name&quot;:&quot;Type&quot;,&quot;values&quot;:[&quot;Opt2&quot;]},{&quot;input_type&quot;:&quot;multiple-checkbox&quot;,&quot;name&quot;:&quot;CheckThose&quot;,&quot;values&quot;:[&quot;Check1&quot;,&quot;Check2&quot;]},{&quot;input_type&quot;:&quot;date&quot;,&quot;name&quot;:&quot;Optional Date&quot;,&quot;values&quot;:[&quot;2021-01-13T15:02:00.000Z&quot;]}]}&#39;</span> ~/Documents/Samples/200KB.1</span></code></pre></div>
<h3 data-number="5.6.4"
id="example-list-packages-in-a-given-shared-inbox"><span
class="header-section-number">5.6.4</span> Example: List packages in a
given shared inbox</h3>
<p>When user packages are listed, the following query is used:</p>
<div class="sourceCode" id="cb319"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;archived&quot;</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">&quot;exclude_dropbox_packages&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span><span class="dt">&quot;has_content&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span><span class="dt">&quot;received&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">}</span></span></code></pre></div>
<p>To list packages in a shared inbox, the query has to be specified
with the the shared inbox by name or its identifier. Additional
parameters can be specified, as supported by the API (to find out
available filters, consult the API definition, or use the web interface
in developer mode). The current workspace is added unless specified in
the query.</p>
<p>Using shared inbox name:</p>
<div class="sourceCode" id="cb320"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;dropbox_name&quot;:&quot;My Shared Inbox&quot;,&quot;archived&quot;:false,&quot;received&quot;:true,&quot;has_content&quot;:true,&quot;exclude_dropbox_packages&quot;:false,&quot;include_draft&quot;:false,&quot;sort&quot;:&quot;-received_at&quot;}&#39;</span></span></code></pre></div>
<p>Using shared inbox identifier: first retrieve the id of the shared
inbox, and then list packages with the appropriate filter.</p>
<div class="sourceCode" id="cb321"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="va">shared_box_id</span><span class="op">=</span><span class="va">$(</span><span class="ex">ascli</span> aoc packages shared_inboxes show <span class="at">--name</span><span class="op">=</span><span class="st">&#39;My Shared Inbox&#39;</span> <span class="at">--format</span><span class="op">=</span>csv <span class="at">--display</span><span class="op">=</span>data <span class="at">--fields</span><span class="op">=</span>id <span class="at">--transpose-single</span><span class="op">=</span>no<span class="va">)</span></span></code></pre></div>
<div class="sourceCode" id="cb322"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;dropbox_id&quot;:&quot;&#39;</span><span class="va">$shared_box_id</span><span class="st">&#39;&quot;,&quot;archived&quot;:false,&quot;received&quot;:true,&quot;has_content&quot;:true,&quot;exclude_dropbox_packages&quot;:false,&quot;include_draft&quot;:false,&quot;sort&quot;:&quot;-received_at&quot;}&#39;</span></span></code></pre></div>
<h3 data-number="5.6.5"
id="example-receive-all-packages-from-a-given-shared-inbox"><span
class="header-section-number">5.6.5</span> Example: Receive all packages
from a given shared inbox</h3>
<div class="sourceCode" id="cb323"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages recv ALL <span class="at">--workspace</span><span class="op">=</span>_workspace_ <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--lock-port</span><span class="op">=</span>12345 <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;dropbox_name&quot;:&quot;_shared_inbox_name_&quot;,&quot;archived&quot;:false,&quot;received&quot;:true,&quot;has_content&quot;:true,&quot;exclude_dropbox_packages&quot;:false,&quot;include_draft&quot;:false}&#39;</span> <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;resume_policy&quot;:&quot;sparse_csum&quot;,&quot;target_rate_kbps&quot;:50000}&#39;</span></span></code></pre></div>
<h3 data-number="5.6.6"
id="example-send-a-package-with-files-from-the-files-app"><span
class="header-section-number">5.6.6</span> Example: Send a package with
files from the Files app</h3>
<p>Find files in Files app:</p>
<div class="sourceCode" id="cb324"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files browse /src_folder</span></code></pre></div>
<pre class="text"><code>+---------------+--------+----------------+--------------+----------------------+--------------+
| name          | type   | recursive_size | size         | modified_time        | access_level |
+---------------+--------+----------------+--------------+----------------------+--------------+
| sample_video  | link   |                |              | 2020-11-29T22:49:09Z | edit         |
| 100G          | file   |                | 107374182400 | 2021-04-21T18:19:25Z | edit         |
| 10M.dat       | file   |                | 10485760     | 2021-05-18T08:22:39Z | edit         |
| Test.pdf      | file   |                | 1265103      | 2022-06-16T12:49:55Z | edit         |
+---------------+--------+----------------+--------------+----------------------+--------------+</code></pre>
<p>Let’s send a package with the file <code>10M.dat</code> from
subfolder /src_folder in a package:</p>
<div class="sourceCode" id="cb326"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files node_info /src_folder <span class="at">--format</span><span class="op">=</span>json <span class="at">--display</span><span class="op">=</span>data <span class="kw">|</span> <span class="ex">ascli</span> aoc packages send @json:<span class="st">&#39;{&quot;name&quot;:&quot;test&quot;,&quot;recipients&quot;:[&quot;someuser@example.com&quot;]}&#39;</span> 10M.dat <span class="at">--transfer</span><span class="op">=</span>node <span class="at">--transfer-info</span><span class="op">=</span>@json:@stdin:</span></code></pre></div>
<h3 data-number="5.6.7" id="receive-new-packages-only-cargo"><span
class="header-section-number">5.6.7</span> <a id="aoccargo"></a>Receive
new packages only (Cargo)</h3>
<p>It is possible to automatically download new packages, like using
Aspera Cargo:</p>
<div class="sourceCode" id="cb327"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc packages recv ALL <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--lock-port</span><span class="op">=</span>12345</span></code></pre></div>
<ul>
<li><code>ALL</code> (case sensitive) will download all packages</li>
<li><code>--once-only=yes</code> keeps memory of any downloaded package
in persistency files located in the configuration folder</li>
<li><code>--lock-port=12345</code> ensures that only one instance is
started at the same time, to avoid running two downloads in
parallel</li>
</ul>
<p>Typically, one would execute this command on a regular basis, using
the method of your choice: see <a href="#scheduler">Scheduler</a>.</p>
<h2 data-number="5.7" id="files"><span
class="header-section-number">5.7</span> Files</h2>
<p>The Files application presents a <strong>Home</strong> folder to
users in a given workspace. Files located here are either user’s files,
or shared folders.</p>
<blockquote>
<p><strong>Note:</strong> All commands under <code>files</code> are the
same as under <code>access_keys do self</code> for plugin
<code>node</code>, i.e. <strong>gen4/access key</strong> operations.</p>
</blockquote>
<h3 data-number="5.7.1" id="download-files"><span
class="header-section-number">5.7.1</span> Download Files</h3>
<p>The general download command is:</p>
<div class="sourceCode" id="cb328"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files download <span class="op">&lt;</span>source folder path<span class="op">&gt;</span> <span class="op">&lt;</span>source filename <span class="dv">1</span><span class="op">&gt;</span> ...</span></code></pre></div>
<p>I.e. the first argument is the source folder, and the following
arguments are the source file names in this folder.</p>
<p>If a single file or folder is to be downloaded, then a single
argument can be provided.</p>
<div class="sourceCode" id="cb329"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files download <span class="op">&lt;</span>single file path<span class="op">&gt;</span></span></code></pre></div>
<h3 data-number="5.7.2" id="shared-folders"><span
class="header-section-number">5.7.2</span> Shared folders</h3>
<p>Shared folder created by users are managed through
<strong>permissions</strong>.</p>
<p>For creation, parameters are the same as for node API <a
href="https://developer.ibm.com/apis/catalog/aspera--aspera-node-api/api/API--aspera--node-api#post960739960">permissions</a>.
<code>ascli</code> expects the same payload for creation, but it will
automatically populate required tags if needed.</p>
<p>Also, the pseudo key <code>with</code> is available: it will lookup
the name in the contacts and fill the proper type and id. The pseudo
parameter <code>link_name</code> allows changing default “shared as”
name.</p>
<ul>
<li>List permissions on a shared folder as user</li>
</ul>
<div class="sourceCode" id="cb330"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files perm /shared_folder_test1 list</span></code></pre></div>
<ul>
<li>Share a personal folder with other users</li>
</ul>
<div class="sourceCode" id="cb331"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files perm /shared_folder_test1 create @json:<span class="st">&#39;{&quot;with&quot;:&quot;laurent&quot;}&#39;</span></span></code></pre></div>
<ul>
<li>Revoke shared access</li>
</ul>
<div class="sourceCode" id="cb332"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files perm /shared_folder_test1 delete 6161</span></code></pre></div>
<p>Public and Private short links can be managed with command:</p>
<div class="sourceCode" id="cb333"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> oc files short_link list _path_here_ private</span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> oc files short_link list _path_here_ public</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> oc files short_link delete</span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> oc files short_link create</span></code></pre></div>
<h3 data-number="5.7.3" id="cross-organization-transfers"><span
class="header-section-number">5.7.3</span> Cross Organization
transfers</h3>
<p>It is possible to transfer files directly between organizations
without having to first download locally and then upload…</p>
<p>Although optional, the creation of <a href="#lprt">option preset</a>
is recommended to avoid placing all parameters in the command line.</p>
<p>Procedure to send a file from org1 to org2:</p>
<ul>
<li>Get access to Organization 1 and create a <a href="#lprt">option
preset</a>: e.g. <code>org1</code>, for instance, use the <a
href="#aocwizard">Wizard</a></li>
<li>Check that access works and locate the source file
e.g. <code>mysourcefile</code>, e.g. using command
<code>files browse</code></li>
<li>Get access to Organization 2 and create a <a href="#lprt">option
preset</a>: e.g. <code>org2</code></li>
<li>Check that access works and locate the destination folder
<code>mydestfolder</code></li>
<li>execute the following:</li>
</ul>
<div class="sourceCode" id="cb334"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">-Porg1</span> aoc files node_info /mydestfolder <span class="at">--format</span><span class="op">=</span>json <span class="at">--display</span><span class="op">=</span>data <span class="kw">|</span> <span class="ex">ascli</span> <span class="at">-Porg2</span> aoc files upload mysourcefile <span class="at">--transfer</span><span class="op">=</span>node <span class="at">--transfer-info</span><span class="op">=</span>@json:@stdin:</span></code></pre></div>
<p>Explanation:</p>
<ul>
<li><code>-Porg1 aoc</code> use Aspera on Cloud plugin and load
credentials for <code>org1</code></li>
<li><code>files node_info /mydestfolder</code> generate transfer
information including node api credential and root id, suitable for the
next command</li>
<li><code>--format=json</code> format the output in JSON (instead of
default text table)</li>
<li><code>--display=data</code> display only the result, and remove
other information, such as workspace name</li>
<li><code>|</code> the standard output of the first command is fed into
the second one</li>
<li><code>-Porg2 aoc</code> use Aspera on Cloud plugin and load
credentials for <code>org2</code></li>
<li><code>files upload mysourcefile</code> upload the file named
<code>mysourcefile</code> (located in <code>org1</code>)</li>
<li><code>--transfer=node</code> use transfer agent type
<code>node</code> instead of default <a
href="#agt_direct"><code>direct</code></a></li>
<li><code>--transfer-info=@json:@stdin:</code> provide <code>node</code>
transfer agent information, i.e. node API credentials, those are
expected in JSON format and read from standard input</li>
</ul>
<h3 data-number="5.7.4" id="find-files"><span
class="header-section-number">5.7.4</span> Find Files</h3>
<p>The command <code>aoc files find</code> allows to search for files in
a given workspace.</p>
<p>It works also on <code>node</code> resource using the <code>v4</code>
command:</p>
<div class="sourceCode" id="cb335"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc admin res node <span class="at">--name</span><span class="op">=</span><span class="st">&#39;my node name&#39;</span> <span class="at">--secret</span><span class="op">=</span><span class="st">&#39;my_secret_here&#39;</span> v4 find ...</span></code></pre></div>
<p>For instructions, refer to section <code>find</code> for plugin
<code>node</code>.</p>
<h2 data-number="5.8" id="aoc-sample-commands"><span
class="header-section-number">5.8</span> AoC sample commands</h2>
<div class="sourceCode" id="cb336"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin analytics transfers <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;status&quot;:&quot;completed&quot;,&quot;direction&quot;:&quot;receive&quot;}&#39;</span> <span class="at">--notif-to</span><span class="op">=</span>my_email_external <span class="at">--notif-template</span><span class="op">=</span>@ruby:<span class="st">&#39;%Q{From: &lt;%=from_name%&gt; &lt;&lt;%=from_email%&gt;&gt;\nTo: &lt;&lt;%=to%&gt;&gt;\nSubject: &lt;%=ev[&quot;files_completed&quot;]%&gt; files received\n\n&lt;%=ev.to_yaml%&gt;}&#39;</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats access_key create <span class="at">--cloud</span><span class="op">=</span>softlayer <span class="at">--region</span><span class="op">=</span>my_icos_bucket_region <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;id&quot;:&quot;ak1ibmcloud&quot;,&quot;secret&quot;:&quot;my_secret_here&quot;,&quot;name&quot;:&quot;my test key&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;ibm-s3&quot;,&quot;bucket&quot;:&quot;my_icos_bucket_name&quot;,&quot;credentials&quot;:{&quot;access_key_id&quot;:&quot;my_icos_bucket_key&quot;,&quot;secret_access_key&quot;:&quot;my_icos_bucket_secret&quot;},&quot;path&quot;:&quot;/&quot;}}&#39;</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats access_key delete ak1ibmcloud</span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats access_key list <span class="at">--fields</span><span class="op">=</span>name,id</span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats access_key node ak1ibmcloud <span class="at">--secret</span><span class="op">=</span>my_secret_here browse /</span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats cluster clouds</span>
<span id="cb336-7"><a href="#cb336-7" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats cluster list</span>
<span id="cb336-8"><a href="#cb336-8" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats cluster show <span class="at">--cloud</span><span class="op">=</span>aws <span class="at">--region</span><span class="op">=</span>eu-west-1</span>
<span id="cb336-9"><a href="#cb336-9" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin ats cluster show 1f412ae7-869a-445c-9c05-02ad16813be2</span>
<span id="cb336-10"><a href="#cb336-10" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin auth_providers list</span>
<span id="cb336-11"><a href="#cb336-11" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res application list</span>
<span id="cb336-12"><a href="#cb336-12" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res client list</span>
<span id="cb336-13"><a href="#cb336-13" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res client_access_key list</span>
<span id="cb336-14"><a href="#cb336-14" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res client_registration_token create @json:<span class="st">&#39;{&quot;data&quot;:{&quot;name&quot;:&quot;test_client_reg1&quot;,&quot;client_subject_scopes&quot;:[&quot;alee&quot;,&quot;aejd&quot;],&quot;client_subject_enabled&quot;:true}}&#39;</span></span>
<span id="cb336-15"><a href="#cb336-15" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res client_registration_token delete my_clt_reg_id</span>
<span id="cb336-16"><a href="#cb336-16" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res client_registration_token list</span>
<span id="cb336-17"><a href="#cb336-17" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res contact list</span>
<span id="cb336-18"><a href="#cb336-18" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res dropbox list</span>
<span id="cb336-19"><a href="#cb336-19" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res dropbox_membership list</span>
<span id="cb336-20"><a href="#cb336-20" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res group list</span>
<span id="cb336-21"><a href="#cb336-21" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res kms_profile list</span>
<span id="cb336-22"><a href="#cb336-22" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res node list</span>
<span id="cb336-23"><a href="#cb336-23" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res operation list</span>
<span id="cb336-24"><a href="#cb336-24" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res organization show</span>
<span id="cb336-25"><a href="#cb336-25" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res package list <span class="at">--http-options</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;read_timeout&quot;:120.0}&#39;</span></span>
<span id="cb336-26"><a href="#cb336-26" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res saml_configuration list</span>
<span id="cb336-27"><a href="#cb336-27" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res self show</span>
<span id="cb336-28"><a href="#cb336-28" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res short_link list</span>
<span id="cb336-29"><a href="#cb336-29" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res user list</span>
<span id="cb336-30"><a href="#cb336-30" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res user modify %name:my_aoc_user_email @json:<span class="st">&#39;{&quot;deactivated&quot;:false}&#39;</span></span>
<span id="cb336-31"><a href="#cb336-31" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin res workspace_membership list</span>
<span id="cb336-32"><a href="#cb336-32" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource node do %name:my_aoc_ak_name <span class="at">--secret</span><span class="op">=</span>my_aoc_ak_secret browse /</span>
<span id="cb336-33"><a href="#cb336-33" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource node do %name:my_aoc_ak_name <span class="at">--secret</span><span class="op">=</span>my_aoc_ak_secret delete /folder1</span>
<span id="cb336-34"><a href="#cb336-34" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource node do %name:my_aoc_ak_name <span class="at">--secret</span><span class="op">=</span>my_aoc_ak_secret mkdir /folder1</span>
<span id="cb336-35"><a href="#cb336-35" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource node do %name:my_aoc_ak_name <span class="at">--secret</span><span class="op">=</span>my_aoc_ak_secret v3 access_key create @json:<span class="st">&#39;{&quot;id&quot;:&quot;testsub1&quot;,&quot;storage&quot;:{&quot;path&quot;:&quot;/folder1&quot;}}&#39;</span></span>
<span id="cb336-36"><a href="#cb336-36" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource node do %name:my_aoc_ak_name <span class="at">--secret</span><span class="op">=</span>my_aoc_ak_secret v3 access_key delete testsub1</span>
<span id="cb336-37"><a href="#cb336-37" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource node do %name:my_aoc_ak_name <span class="at">--secret</span><span class="op">=</span>my_aoc_ak_secret v3 events</span>
<span id="cb336-38"><a href="#cb336-38" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource workspace list</span>
<span id="cb336-39"><a href="#cb336-39" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin resource workspace_membership list <span class="at">--fields</span><span class="op">=</span>ALL <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;page&quot;:1,&quot;per_page&quot;:50,&quot;embed&quot;:&quot;member&quot;,&quot;inherited&quot;:false,&quot;workspace_id&quot;:11363,&quot;sort&quot;:&quot;name&quot;}&#39;</span></span>
<span id="cb336-40"><a href="#cb336-40" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> admin subscription</span>
<span id="cb336-41"><a href="#cb336-41" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> automation workflow action my_wf_id create @json:<span class="st">&#39;{&quot;name&quot;:&quot;toto&quot;}&#39;</span> <span class="dt">\</span></span>
<span id="cb336-42"><a href="#cb336-42" aria-hidden="true" tabindex="-1"></a>aoc automation workflow create @json:<span class="st">&#39;{&quot;name&quot;:&quot;test_workflow&quot;}&#39;</span></span>
<span id="cb336-43"><a href="#cb336-43" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> automation workflow delete my_wf_id</span>
<span id="cb336-44"><a href="#cb336-44" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> automation workflow list</span>
<span id="cb336-45"><a href="#cb336-45" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> automation workflow list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;show_org_workflows&quot;:&quot;true&quot;}&#39;</span> <span class="at">--scope</span><span class="op">=</span>admin:all</span>
<span id="cb336-46"><a href="#cb336-46" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> automation workflow list <span class="at">--select</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;test_workflow&quot;}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id <span class="at">--format</span><span class="op">=</span>csv <span class="at">--display</span><span class="op">=</span>data</span>
<span id="cb336-47"><a href="#cb336-47" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> bearer_token <span class="at">--display</span><span class="op">=</span>data <span class="at">--scope</span><span class="op">=</span>user:all</span>
<span id="cb336-48"><a href="#cb336-48" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files bearer /</span>
<span id="cb336-49"><a href="#cb336-49" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files bearer_token_node / <span class="at">--cache-tokens</span><span class="op">=</span>no</span>
<span id="cb336-50"><a href="#cb336-50" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files browse /</span>
<span id="cb336-51"><a href="#cb336-51" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files browse / <span class="at">--link</span><span class="op">=</span>my_aoc_publink_folder_nopass</span>
<span id="cb336-52"><a href="#cb336-52" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files browse / <span class="at">--link</span><span class="op">=</span>my_aoc_publink_folder_pass <span class="at">--password</span><span class="op">=</span>my_aoc_publink_password</span>
<span id="cb336-53"><a href="#cb336-53" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files delete /testsrc</span>
<span id="cb336-54"><a href="#cb336-54" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files download <span class="at">--transfer</span><span class="op">=</span>connect /200KB.1</span>
<span id="cb336-55"><a href="#cb336-55" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files find / <span class="st">&#39;\.partial$&#39;</span></span>
<span id="cb336-56"><a href="#cb336-56" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files http_node_download <span class="at">--to-folder</span><span class="op">=</span>. /200KB.1</span>
<span id="cb336-57"><a href="#cb336-57" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files mkdir /testsrc</span>
<span id="cb336-58"><a href="#cb336-58" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files modify my_aoc_test_folder</span>
<span id="cb336-59"><a href="#cb336-59" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files permission my_aoc_test_folder list</span>
<span id="cb336-60"><a href="#cb336-60" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files rename /somefolder testdst</span>
<span id="cb336-61"><a href="#cb336-61" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files short_link create /testdst private</span>
<span id="cb336-62"><a href="#cb336-62" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files short_link create testdst public</span>
<span id="cb336-63"><a href="#cb336-63" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files short_link list /testdst private</span>
<span id="cb336-64"><a href="#cb336-64" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files show %id:my_file_id</span>
<span id="cb336-65"><a href="#cb336-65" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files show /200KB.1</span>
<span id="cb336-66"><a href="#cb336-66" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files sync admin status <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;my_aoc_sync2&quot;,&quot;reset&quot;:true,&quot;direction&quot;:&quot;pull&quot;,&quot;local&quot;:{&quot;path&quot;:&quot;/data/localsync&quot;},&quot;remote&quot;:{&quot;path&quot;:&quot;/testdst&quot;}}&#39;</span></span>
<span id="cb336-67"><a href="#cb336-67" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files sync admin status <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;sessions&quot;:[{&quot;name&quot;:&quot;my_aoc_sync1&quot;,&quot;direction&quot;:&quot;pull&quot;,&quot;local_dir&quot;:&quot;/data/localsync&quot;,&quot;remote_dir&quot;:&quot;/testdst&quot;,&quot;reset&quot;:true}]}&#39;</span></span>
<span id="cb336-68"><a href="#cb336-68" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files sync start <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;my_aoc_sync2&quot;,&quot;reset&quot;:true,&quot;direction&quot;:&quot;pull&quot;,&quot;local&quot;:{&quot;path&quot;:&quot;/data/localsync&quot;},&quot;remote&quot;:{&quot;path&quot;:&quot;/testdst&quot;}}&#39;</span></span>
<span id="cb336-69"><a href="#cb336-69" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files sync start <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;sessions&quot;:[{&quot;name&quot;:&quot;my_aoc_sync1&quot;,&quot;direction&quot;:&quot;pull&quot;,&quot;local_dir&quot;:&quot;/data/localsync&quot;,&quot;remote_dir&quot;:&quot;/testdst&quot;,&quot;reset&quot;:true}]}&#39;</span></span>
<span id="cb336-70"><a href="#cb336-70" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files thumbnail my_aoc_media_file</span>
<span id="cb336-71"><a href="#cb336-71" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files thumbnail my_aoc_media_file <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;text&quot;:true,&quot;double&quot;:true}&#39;</span></span>
<span id="cb336-72"><a href="#cb336-72" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files transfer <span class="at">--from-folder</span><span class="op">=</span>/testsrc <span class="at">--to-folder</span><span class="op">=</span>/testdst testfile.bin</span>
<span id="cb336-73"><a href="#cb336-73" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files upload <span class="at">--to-folder</span><span class="op">=</span>/ testfile.bin <span class="at">--link</span><span class="op">=</span>my_aoc_publink_folder_nopass</span>
<span id="cb336-74"><a href="#cb336-74" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files upload <span class="at">--to-folder</span><span class="op">=</span>/testsrc testfile.bin</span>
<span id="cb336-75"><a href="#cb336-75" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files upload Test.pdf <span class="at">--transfer</span><span class="op">=</span>node <span class="at">--transfer-info</span><span class="op">=</span>@json:@stdin:</span>
<span id="cb336-76"><a href="#cb336-76" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> files v3 info</span>
<span id="cb336-77"><a href="#cb336-77" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> gateway https://localhost:12345/aspera/faspex</span>
<span id="cb336-78"><a href="#cb336-78" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> org <span class="at">--link</span><span class="op">=</span>my_aoc_publink_recv_from_aocuser</span>
<span id="cb336-79"><a href="#cb336-79" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> organization</span>
<span id="cb336-80"><a href="#cb336-80" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages browse <span class="st">&quot;my_package_id&quot;</span> /contents</span>
<span id="cb336-81"><a href="#cb336-81" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages list</span>
<span id="cb336-82"><a href="#cb336-82" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;dropbox_name&quot;:&quot;my_aoc_shbx_name&quot;,&quot;sort&quot;:&quot;-received_at&quot;,&quot;archived&quot;:false,&quot;received&quot;:true,&quot;has_content&quot;:true,&quot;exclude_dropbox_packages&quot;:false}&#39;</span></span>
<span id="cb336-83"><a href="#cb336-83" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages recv <span class="st">&quot;my_package_id&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb336-84"><a href="#cb336-84" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages recv ALL <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--lock-port</span><span class="op">=</span>12345</span>
<span id="cb336-85"><a href="#cb336-85" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages recv ALL <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--lock-port</span><span class="op">=</span>12345 <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;dropbox_name&quot;:&quot;my_aoc_shbx_name&quot;,&quot;archived&quot;:false,&quot;received&quot;:true,&quot;has_content&quot;:true,&quot;exclude_dropbox_packages&quot;:false,&quot;include_draft&quot;:false}&#39;</span> <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;resume_policy&quot;:&quot;sparse_csum&quot;,&quot;target_rate_kbps&quot;:50000}&#39;</span></span>
<span id="cb336-86"><a href="#cb336-86" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages send <span class="at">--workspace</span><span class="op">=</span>my_aoc_shbx_ws @json:<span class="st">&#39;{&quot;name&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;my_aoc_shbx_name&quot;],&quot;metadata&quot;:[{&quot;input_type&quot;:&quot;single-text&quot;,&quot;name&quot;:&quot;Project Id&quot;,&quot;values&quot;:[&quot;123&quot;]},{&quot;input_type&quot;:&quot;single-dropdown&quot;,&quot;name&quot;:&quot;Type&quot;,&quot;values&quot;:[&quot;Opt2&quot;]},{&quot;input_type&quot;:&quot;multiple-checkbox&quot;,&quot;name&quot;:&quot;CheckThose&quot;,&quot;values&quot;:[&quot;Check1&quot;,&quot;Check2&quot;]},{&quot;input_type&quot;:&quot;date&quot;,&quot;name&quot;:&quot;Optional Date&quot;,&quot;values&quot;:[&quot;2021-01-13T15:02:00.000Z&quot;]}]}&#39;</span> testfile.bin</span>
<span id="cb336-87"><a href="#cb336-87" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages send <span class="at">--workspace</span><span class="op">=</span>my_aoc_shbx_ws @json:<span class="st">&#39;{&quot;name&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;my_aoc_shbx_name&quot;],&quot;metadata&quot;:{&quot;Project Id&quot;:&quot;456&quot;,&quot;Type&quot;:&quot;Opt2&quot;,&quot;CheckThose&quot;:[&quot;Check1&quot;,&quot;Check2&quot;],&quot;Optional Date&quot;:&quot;2021-01-13T15:02:00.000Z&quot;}}&#39;</span> testfile.bin</span>
<span id="cb336-88"><a href="#cb336-88" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages send <span class="at">--workspace</span><span class="op">=</span>my_aoc_shbx_ws @json:<span class="st">&#39;{&quot;name&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;my_aoc_shbx_name&quot;]}&#39;</span> testfile.bin</span>
<span id="cb336-89"><a href="#cb336-89" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages send @json:<span class="st">&#39;{&quot;name&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;my_email_external&quot;]}&#39;</span> <span class="at">--new-user-option</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;package_contact&quot;:true}&#39;</span> testfile.bin</span>
<span id="cb336-90"><a href="#cb336-90" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages send @json:<span class="st">&#39;{&quot;name&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;my_email_internal&quot;],&quot;note&quot;:&quot;my note&quot;}&#39;</span> testfile.bin</span>
<span id="cb336-91"><a href="#cb336-91" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages send @json:<span class="st">&#39;{&quot;name&quot;:&quot;Important files delivery&quot;}&#39;</span> testfile.bin <span class="at">--link</span><span class="op">=</span>my_aoc_publink_send_aoc_user <span class="at">--password</span><span class="op">=</span>my_aoc_publink_send_use_pass</span>
<span id="cb336-92"><a href="#cb336-92" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages send @json:<span class="st">&#39;{&quot;name&quot;:&quot;Important files delivery&quot;}&#39;</span> testfile.bin <span class="at">--link</span><span class="op">=</span>my_aoc_publink_send_shd_inbox</span>
<span id="cb336-93"><a href="#cb336-93" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> packages shared_inboxes list</span>
<span id="cb336-94"><a href="#cb336-94" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> remind <span class="at">--username</span><span class="op">=</span>my_aoc_user_email</span>
<span id="cb336-95"><a href="#cb336-95" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> servers</span>
<span id="cb336-96"><a href="#cb336-96" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> user profile modify @json:<span class="st">&#39;{&quot;name&quot;:&quot;dummy change&quot;}&#39;</span></span>
<span id="cb336-97"><a href="#cb336-97" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> user profile show</span>
<span id="cb336-98"><a href="#cb336-98" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> user workspaces current</span>
<span id="cb336-99"><a href="#cb336-99" aria-hidden="true" tabindex="-1"></a><span class="ex">aoc</span> user workspaces list</span></code></pre></div>
<h1 data-number="6" id="plugin-ats-ibm-aspera-transfer-service"><span
class="header-section-number">6</span> <a id="ats"></a>Plugin:
<code>ats</code>: IBM Aspera Transfer Service</h1>
<p>ATS is usable either :</p>
<ul>
<li><p>from an AoC subscription : ascli aoc admin ats : use AoC
authentication</p></li>
<li><p>or from an IBM Cloud subscription : ascli ats : use IBM Cloud API
key authentication</p></li>
</ul>
<h2 data-number="6.1" id="ibm-cloud-ats-creation-of-api-key"><span
class="header-section-number">6.1</span> IBM Cloud ATS : creation of api
key</h2>
<p>This section is about using ATS with an IBM cloud subscription. If
you are using ATS as part of AoC, then authentication is through AoC,
not IBM Cloud.</p>
<p>First get your IBM Cloud APIkey. For instance, it can be created
using the IBM Cloud web interface, or using command line:</p>
<div class="sourceCode" id="cb337"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ibmcloud</span> iam api-key-create mykeyname <span class="at">-d</span> <span class="st">&#39;my sample key&#39;</span></span></code></pre></div>
<pre class="output"><code>OK
API key mykeyname was created

Please preserve the API key! It cannot be retrieved after it&#39;s created.

Name          mykeyname
Description   my sample key
Created At    2019-09-30T12:17+0000
API Key       my_secret_api_key_here
Locked        false
UUID          ApiKey-05b8fadf-e7fe-4bc4-93a9-6fd348c5ab1f</code></pre>
<p>References: <!-- spellchecker: disable --></p>
<ul>
<li><a
href="https://console.bluemix.net/docs/iam/userid_keys.html#userapikey">https://console.bluemix.net/docs/iam/userid_keys.html#userapikey</a></li>
<li><a
href="https://ibm.ibmaspera.com/helpcenter/transfer-service">https://ibm.ibmaspera.com/helpcenter/transfer-service</a></li>
</ul>
<!-- spellchecker: enable -->
<p>Then, to register the key by default for the ats plugin, create a
preset. Execute:</p>
<div class="sourceCode" id="cb339"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update my_ibm_ats <span class="at">--ibm-api-key</span><span class="op">=</span>my_secret_api_key_here</span></code></pre></div>
<div class="sourceCode" id="cb340"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default ats my_ibm_ats</span></code></pre></div>
<div class="sourceCode" id="cb341"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ats api_key instances</span></code></pre></div>
<pre class="output"><code>+--------------------------------------+
| instance                             |
+--------------------------------------+
| aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee |
+--------------------------------------+</code></pre>
<div class="sourceCode" id="cb343"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update my_ibm_ats <span class="at">--instance</span><span class="op">=</span>aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee</span></code></pre></div>
<div class="sourceCode" id="cb344"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ats api_key create</span></code></pre></div>
<pre class="output"><code>+--------+----------------------------------------------+
| key    | value                                        |
+--------+----------------------------------------------+
| id     | ats_XXXXXXXXXXXXXXXXXXXXXXXX                 |
| secret | YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY |
+--------+----------------------------------------------+
ascli config preset update my_ibm_ats --ats-key=ats_XXXXXXXXXXXXXXXXXXXXXXXX --ats-secret=YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY</code></pre>
<h2 data-number="6.2" id="ats-access-key-creation-parameters"><span
class="header-section-number">6.2</span> <a id="ats_params"></a>ATS
Access key creation parameters</h2>
<p>When creating an ATS access key, the option <code>params</code> must
contain an extended value with the creation parameters. Those are
directly the parameters expected by the <a
href="https://developer.ibm.com/apis/catalog?search=%22Aspera%20ATS%20API%22">ATS
API</a>.</p>
<h2 data-number="6.3" id="misc.-examples"><span
class="header-section-number">6.3</span> Misc. Examples</h2>
<p>Example: create access key on IBM Cloud (softlayer):</p>
<div class="sourceCode" id="cb346"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ats access_key create <span class="at">--cloud</span><span class="op">=</span>softlayer <span class="at">--region</span><span class="op">=</span>ams <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;storage&quot;:{&quot;type&quot;:&quot;softlayer_swift&quot;,&quot;container&quot;:&quot;_container_name_&quot;,&quot;credentials&quot;:{&quot;api_key&quot;:&quot;my_secret_here&quot;,&quot;username&quot;:&quot;_name_:_usr_name_&quot;},&quot;path&quot;:&quot;/&quot;},&quot;id&quot;:&quot;_optional_id_&quot;,&quot;name&quot;:&quot;_optional_name_&quot;}&#39;</span></span></code></pre></div>
<p>Example: create access key on AWS:</p>
<div class="sourceCode" id="cb347"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ats access_key create <span class="at">--cloud</span><span class="op">=</span>aws <span class="at">--region</span><span class="op">=</span>eu-west-1 <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;id&quot;:&quot;myaccesskey&quot;,&quot;name&quot;:&quot;laurent key AWS&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;aws_s3&quot;,&quot;bucket&quot;:&quot;my-bucket&quot;,&quot;credentials&quot;:{&quot;access_key_id&quot;:&quot;_access_key_id_here_&quot;,&quot;secret_access_key&quot;:&quot;my_secret_here&quot;},&quot;path&quot;:&quot;/laurent&quot;}}&#39;</span></span></code></pre></div>
<p>Example: create access key on Azure SAS:</p>
<div class="sourceCode" id="cb348"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ats access_key create <span class="at">--cloud</span><span class="op">=</span>azure <span class="at">--region</span><span class="op">=</span>eastus <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;id&quot;:&quot;myaccesskey&quot;,&quot;name&quot;:&quot;laurent key azure&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;azure_sas&quot;,&quot;credentials&quot;:{&quot;shared_access_signature&quot;:&quot;https://containername.blob.core.windows.net/blobname?sr=c&amp;...&quot;},&quot;path&quot;:&quot;/&quot;}}&#39;</span></span></code></pre></div>
<p>(Note that the blob name is mandatory after server address and before
parameters. and that parameter sr=c is mandatory.)</p>
<p>Example: create access key on Azure:</p>
<div class="sourceCode" id="cb349"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ats access_key create <span class="at">--cloud</span><span class="op">=</span>azure <span class="at">--region</span><span class="op">=</span>eastus <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;id&quot;:&quot;myaccesskey&quot;,&quot;name&quot;:&quot;laurent key azure&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;azure&quot;,&quot;credentials&quot;:{&quot;account&quot;:&quot;myaccount&quot;,&quot;key&quot;:&quot;myaccesskey&quot;,&quot;storage_endpoint&quot;:&quot;myblob&quot;},&quot;path&quot;:&quot;/&quot;}}&#39;</span></span></code></pre></div>
<p>delete all my access keys:</p>
<div class="sourceCode" id="cb350"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> ats access_key list <span class="at">--field</span><span class="op">=</span>id <span class="at">--format</span><span class="op">=</span>csv <span class="kw">|</span> <span class="ex">ascli</span> ats access_key delete @lines:@stdin: <span class="at">--bulk</span><span class="op">=</span>yes</span></code></pre></div>
<p>The parameters provided to ATS for access key creation are the ones
of <a
href="https://developer.ibm.com/apis/catalog?search=%22aspera%20ats%22">ATS
API</a> for the <code>POST /access_keys</code> endpoint.</p>
<h2 data-number="6.4" id="ats-sample-commands"><span
class="header-section-number">6.4</span> ATS sample commands</h2>
<div class="sourceCode" id="cb351"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key cluster ak2ibmcloud <span class="at">--secret</span><span class="op">=</span>my_secret_here</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key create <span class="at">--cloud</span><span class="op">=</span>aws <span class="at">--region</span><span class="op">=</span>my_aws_bucket_region <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;id&quot;:&quot;ak_aws&quot;,&quot;name&quot;:&quot;my test key AWS&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;aws_s3&quot;,&quot;bucket&quot;:&quot;my_aws_bucket_name&quot;,&quot;credentials&quot;:{&quot;access_key_id&quot;:&quot;my_aws_bucket_key&quot;,&quot;secret_access_key&quot;:&quot;my_aws_bucket_secret&quot;},&quot;path&quot;:&quot;/&quot;}}&#39;</span></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key create <span class="at">--cloud</span><span class="op">=</span>softlayer <span class="at">--region</span><span class="op">=</span>my_icos_bucket_region <span class="at">--params</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;id&quot;:&quot;ak2ibmcloud&quot;,&quot;secret&quot;:&quot;my_secret_here&quot;,&quot;name&quot;:&quot;my test key&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;ibm-s3&quot;,&quot;bucket&quot;:&quot;my_icos_bucket_name&quot;,&quot;credentials&quot;:{&quot;access_key_id&quot;:&quot;my_icos_bucket_key&quot;,&quot;secret_access_key&quot;:&quot;my_icos_bucket_secret&quot;},&quot;path&quot;:&quot;/&quot;}}&#39;</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key delete ak2ibmcloud</span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key delete ak_aws</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key entitlement ak2ibmcloud</span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key list <span class="at">--fields</span><span class="op">=</span>name,id</span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key node ak2ibmcloud browse / <span class="at">--secret</span><span class="op">=</span>my_secret_here</span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> access_key show ak2ibmcloud</span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> api_key create</span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> api_key instances</span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> api_key list</span>
<span id="cb351-13"><a href="#cb351-13" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> cluster clouds</span>
<span id="cb351-14"><a href="#cb351-14" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> cluster list</span>
<span id="cb351-15"><a href="#cb351-15" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> cluster show <span class="at">--cloud</span><span class="op">=</span>aws <span class="at">--region</span><span class="op">=</span>eu-west-1</span>
<span id="cb351-16"><a href="#cb351-16" aria-hidden="true" tabindex="-1"></a><span class="ex">ats</span> cluster show 1f412ae7-869a-445c-9c05-02ad16813be2</span></code></pre></div>
<h1 data-number="7"
id="plugin-server-ibm-aspera-high-speed-transfer-server-ssh"><span
class="header-section-number">7</span> <a id="server"></a>Plugin:
<code>server</code>: IBM Aspera High Speed Transfer Server (SSH)</h1>
<p>The <code>server</code> plugin is used for operations on Aspera HSTS
using SSH authentication. It is the legacy way of accessing an Aspera
Server, often used for server to server transfers. An SSH session is
established, authenticated with either a password or an SSH private key,
then commands <code>ascp</code> (for transfers) and <code>ascmd</code>
(for file operations) are executed.</p>
<blockquote>
<p><strong>Note:</strong> The URL to be provided is usually:
<code>ssh://_server_address_:33001</code></p>
</blockquote>
<h2 data-number="7.1" id="server-sample-commands"><span
class="header-section-number">7.1</span> Server sample commands</h2>
<div class="sourceCode" id="cb352"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> browse /</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> browse my_server_folder/testfile.bin</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> browse my_upload_folder/target_hot</span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> cp my_server_folder/testfile.bin my_upload_folder/200KB.2</span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> delete my_server_folder</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> delete my_upload_folder/to.delete</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> df</span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> download my_server_folder/testfile.bin <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;wss&quot;:false,&quot;resume&quot;:{&quot;iter_max&quot;:1}}&#39;</span></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> download my_server_folder/testfile.bin <span class="at">--to-folder</span><span class="op">=</span>my_upload_folder <span class="at">--transfer</span><span class="op">=</span>node</span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> du /</span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> health transfer <span class="at">--to-folder</span><span class="op">=</span>my_upload_folder <span class="at">--format</span><span class="op">=</span>nagios</span>
<span id="cb352-12"><a href="#cb352-12" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> info</span>
<span id="cb352-13"><a href="#cb352-13" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> md5sum my_server_folder/testfile.bin</span>
<span id="cb352-14"><a href="#cb352-14" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> mkdir my_server_folder <span class="at">--logger</span><span class="op">=</span>stdout</span>
<span id="cb352-15"><a href="#cb352-15" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> mkdir my_upload_folder/target_hot</span>
<span id="cb352-16"><a href="#cb352-16" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> mv my_upload_folder/200KB.2 my_upload_folder/to.delete</span>
<span id="cb352-17"><a href="#cb352-17" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> sync admin status <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;sync2&quot;,&quot;local&quot;:{&quot;path&quot;:&quot;/data/localsync&quot;}}&#39;</span></span>
<span id="cb352-18"><a href="#cb352-18" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> sync admin status <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;sync2&quot;}&#39;</span></span>
<span id="cb352-19"><a href="#cb352-19" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> sync admin status mysync <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;sessions&quot;:[{&quot;name&quot;:&quot;mysync&quot;,&quot;local_dir&quot;:&quot;/data/localsync&quot;}]}&#39;</span></span>
<span id="cb352-20"><a href="#cb352-20" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> sync start <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;instance&quot;:{&quot;quiet&quot;:false},&quot;sessions&quot;:[{&quot;name&quot;:&quot;mysync&quot;,&quot;direction&quot;:&quot;pull&quot;,&quot;remote_dir&quot;:&quot;my_server_folder&quot;,&quot;local_dir&quot;:&quot;/data/localsync&quot;,&quot;reset&quot;:true}]}&#39;</span></span>
<span id="cb352-21"><a href="#cb352-21" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> sync start <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;sync2&quot;,&quot;local&quot;:{&quot;path&quot;:&quot;/data/localsync&quot;},&quot;remote&quot;:{&quot;path&quot;:&quot;my_server_folder&quot;},&quot;reset&quot;:true,&quot;quiet&quot;:false}&#39;</span></span>
<span id="cb352-22"><a href="#cb352-22" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--sources</span><span class="op">=</span>@ts <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;EX_ascp_args&quot;:[&quot;--file-list&quot;,&quot;&#39;&quot;filelist.txt&quot;&#39;&quot;]}&#39;</span> <span class="at">--to-folder</span><span class="op">=</span>my_server_folder</span>
<span id="cb352-23"><a href="#cb352-23" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--sources</span><span class="op">=</span>@ts <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;EX_ascp_args&quot;:[&quot;--file-pair-list&quot;,&quot;&#39;&quot;filepairlist.txt&quot;&#39;&quot;]}&#39;</span></span>
<span id="cb352-24"><a href="#cb352-24" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--sources</span><span class="op">=</span>@ts <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;EX_file_list&quot;:&quot;&#39;&quot;filelist.txt&quot;&#39;&quot;}&#39;</span> <span class="at">--to-folder</span><span class="op">=</span>my_server_folder</span>
<span id="cb352-25"><a href="#cb352-25" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--sources</span><span class="op">=</span>@ts <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;EX_file_pair_list&quot;:&quot;&#39;&quot;filepairlist.txt&quot;&#39;&quot;}&#39;</span></span>
<span id="cb352-26"><a href="#cb352-26" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--sources</span><span class="op">=</span>@ts <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;paths&quot;:[{&quot;source&quot;:&quot;testfile.bin&quot;,&quot;destination&quot;:&quot;my_server_folder/othername&quot;}]}&#39;</span></span>
<span id="cb352-27"><a href="#cb352-27" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--src-type</span><span class="op">=</span>pair <span class="at">--sources</span><span class="op">=</span>@json:<span class="st">&#39;[&quot;testfile.bin&quot;,&quot;my_server_folder/othername&quot;]&#39;</span></span>
<span id="cb352-28"><a href="#cb352-28" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--src-type</span><span class="op">=</span>pair testfile.bin my_server_folder/othername <span class="at">--notif-to</span><span class="op">=</span>my_email_external <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;ascp_args&quot;:[&quot;-l&quot;,&quot;10m&quot;]}&#39;</span></span>
<span id="cb352-29"><a href="#cb352-29" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--src-type</span><span class="op">=</span>pair testfile.bin my_upload_folder/with_options <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;cipher&quot;:&quot;aes-192-gcm&quot;,&quot;content_protection&quot;:&quot;encrypt&quot;,&quot;content_protection_password&quot;:&quot;my_secret_here&quot;,&quot;cookie&quot;:&quot;biscuit&quot;,&quot;create_dir&quot;:true,&quot;delete_before_transfer&quot;:false,&quot;delete_source&quot;:false,&quot;exclude_newer_than&quot;:1,&quot;exclude_older_than&quot;:10000,&quot;fasp_port&quot;:33001,&quot;http_fallback&quot;:false,&quot;multi_session&quot;:0,&quot;overwrite&quot;:&quot;diff+older&quot;,&quot;precalculate_job_size&quot;:true,&quot;preserve_access_time&quot;:true,&quot;preserve_creation_time&quot;:true,&quot;rate_policy&quot;:&quot;fair&quot;,&quot;resume_policy&quot;:&quot;sparse_csum&quot;,&quot;symlink_policy&quot;:&quot;follow&quot;}&#39;</span></span>
<span id="cb352-30"><a href="#cb352-30" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload <span class="at">--to-folder</span><span class="op">=</span>my_upload_folder/target_hot <span class="at">--lock-port</span><span class="op">=</span>12345 <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;EX_ascp_args&quot;:[&quot;--remove-after-transfer&quot;,&quot;--remove-empty-directories&quot;,&quot;--exclude-newer-than=-8&quot;,&quot;--src-base&quot;,&quot;source_hot&quot;]}&#39;</span> source_hot</span>
<span id="cb352-31"><a href="#cb352-31" aria-hidden="true" tabindex="-1"></a><span class="ex">server</span> upload testfile.bin <span class="at">--to-folder</span><span class="op">=</span>my_server_folder <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;multi_session&quot;:3,&quot;multi_session_threshold&quot;:1,&quot;resume_policy&quot;:&quot;none&quot;,&quot;target_rate_kbps&quot;:1500}&#39;</span> <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;spawn_delay_sec&quot;:2.5,&quot;multi_incr_udp&quot;:false}&#39;</span> <span class="at">--progress</span><span class="op">=</span>multi</span></code></pre></div>
<h2 data-number="7.2"
id="authentication-on-server-with-ssh-session"><span
class="header-section-number">7.2</span> Authentication on Server with
SSH session</h2>
<p>If SSH is the session protocol (by default i.e. not WSS), then
following session authentication methods are supported:</p>
<ul>
<li><code>password</code>: SSH password</li>
<li><code>ssh_keys</code>: SSH keys (Multiple SSH key paths can be
provided.)</li>
</ul>
<p>If <code>username</code> is not provided then the default transfer
user <code>xfer</code> is used.</p>
<p>If no SSH password or key is provided and a transfer token is
provided in transfer spec (option <code>ts</code>), then standard SSH
bypass keys are used. Example:</p>
<div class="sourceCode" id="cb353"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server <span class="at">--url</span><span class="op">=</span>ssh://_server_address_:33001 ... <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;token&quot;:&quot;Basic _token_here_&quot;}&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> If you need to use the Aspera public keys,
then specify an empty token: <code>--ts=@json:'{"token":""}'</code> :
Aspera public SSH keys will be used, but the protocol will ignore the
empty token.</p>
</blockquote>
<p>The value of the <code>ssh_keys</code> option can be a single value
or an <code>Array</code>. Each value is a <strong>path</strong> to a
private key and is expanded (<code>~</code> is replaced with the user’s
home folder).</p>
<p>Examples:</p>
<div class="sourceCode" id="cb354"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server <span class="at">--ssh-keys</span><span class="op">=</span>~/.ssh/id_rsa</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server <span class="at">--ssh-keys</span><span class="op">=</span>@list:,~/.ssh/id_rsa</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server <span class="at">--ssh-keys</span><span class="op">=</span>@json:<span class="st">&#39;[&quot;~/.ssh/id_rsa&quot;]&#39;</span></span></code></pre></div>
<p>For file operation command (browse, delete), the Ruby SSH client
library <code>Net::SSH</code> is used and provides several options
settable using option <code>ssh_options</code>.</p>
<p>For a list of SSH client options, refer to the Ruby documentation of
<a
href="http://net-ssh.github.io/net-ssh/Net/SSH.html#method-c-start">Net::SSH</a>.</p>
<p>Some of the 50 available SSH options:</p>
<ul>
<li><code>verbose</code></li>
<li><code>use_agent</code></li>
<li><code>passphrase</code></li>
</ul>
<p>By default the SSH library will check if a local
<code>ssh-agent</code> is running.</p>
<p>On Linux, if you get an error message such as:</p>
<div class="sourceCode" id="cb355"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ERROR</span> <span class="at">--</span> net.ssh.authentication.agent: could not connect to ssh-agent: Agent not configured</span></code></pre></div>
<p>or on Windows:</p>
<div class="sourceCode" id="cb356"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ERROR</span> <span class="at">--</span> net.ssh.authentication.agent: could not connect to ssh-agent: pageant process not running</span></code></pre></div>
<p>This means that your environment suggests to use an agent but you
don’t have such an SSH agent running, then:</p>
<ul>
<li>Check env var: <code>SSH_AGENT_SOCK</code></li>
<li>Check your file: <code>$HOME/.ssh/config</code></li>
<li>Check if the SSH key is protected with a passphrase (then, use the
<code>passphrase</code> SSH option)</li>
<li><a
href="https://www.rubydoc.info/github/net-ssh/net-ssh/Net%2FSSH.start">Check
the Ruby SSH manual</a></li>
<li>To disable the use of <code>ssh-agent</code>, use the option
<code>ssh_options</code> like this:</li>
</ul>
<div class="sourceCode" id="cb357"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server <span class="at">--ssh-options</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;use_agent&quot;: false}&#39;</span> ...</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> This can also be set using a preset.</p>
</blockquote>
<p>If one of the SSH private keys is passphrase-protected, then option
<code>passphrase</code> can be used. It is equivalent to setting both
options <code>ssh_options.passphrase</code> and
<code>ts.ssh_private_key_passphrase</code>.</p>
<h2 data-number="7.3" id="other-session-channels-for-server"><span
class="header-section-number">7.3</span> Other session channels for
<code>server</code></h2>
<p>URL schemes <code>local</code> and <code>https</code> are also
supported (mainly for testing purpose). (<code>--url=local:</code> ,
<code>--url=https://...</code>)</p>
<ul>
<li><code>local</code> will execute <code>ascmd</code> locally, instead
of using an SSH connection.</li>
<li><code>https</code> will use Web Socket Session: This requires the
use of a transfer token. For example a <code>Basic</code> token can be
used.</li>
</ul>
<p>As, most of the time, SSH is used, if an <code>http</code> scheme is
provided without token, the plugin will fallback to SSH and port
33001.</p>
<h2 data-number="7.4" id="examples-server"><span
class="header-section-number">7.4</span> Examples:
<code>server</code></h2>
<p>One can test the <code>server</code> application using the well known
demo server:</p>
<div class="sourceCode" id="cb358"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config initdemo</span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server browse /aspera-test-dir-large</span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server download /aspera-test-dir-large/200MB</span></code></pre></div>
<p><code>initdemo</code> creates a <a href="#lprt">option preset</a>
<code>demoserver</code> and set it as default for plugin
<code>server</code>.</p>
<p>If an SSH private key is used for authentication with a passphrase,
the passphrase needs to be provided to both options:
<code>ssh_options</code>, for browsing, and <code>ts</code> for
transfers:</p>
<div class="sourceCode" id="cb359"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server <span class="at">--url</span><span class="op">=</span>ssh://_server_address_here_:33001 <span class="at">--username</span><span class="op">=</span>_user_here_ <span class="at">--ssh_keys</span><span class="op">=</span>_private_key_path_here_ <span class="at">--passphrase</span><span class="op">=</span>_passphrase_here_</span></code></pre></div>
<h1 data-number="8"
id="plugin-node-ibm-aspera-high-speed-transfer-server-node"><span
class="header-section-number">8</span> <a id="node"></a>Plugin:
<code>node</code>: IBM Aspera High Speed Transfer Server Node</h1>
<p>This plugin gives access to capabilities provided by the HSTS node
API.</p>
<p>The authentication is <code>username</code> and <code>password</code>
or <code>access_key</code> and <code>secret</code> through options:
<code>username</code> and <code>password</code>.</p>
<blockquote>
<p><strong>Note:</strong> Capabilities of this plugin are used in other
plugins which access to the node API, such as <code>aoc</code>,
<code>ats</code>, <code>shares</code>.</p>
</blockquote>
<h2 data-number="8.1" id="file-operations"><span
class="header-section-number">8.1</span> File Operations</h2>
<p>It is possible to do <code>gen3</code> operations:</p>
<ul>
<li>browse</li>
<li>transfer (upload / download / sync)</li>
<li>delete</li>
<li>…</li>
</ul>
<p>When using an access key, so called <strong>gen4/access key</strong>
API is also supported through sub commands using
<code>access_keys do self</code>.</p>
<p>Example:</p>
<ul>
<li><code>ascli node browse /</code> : list files with gen3 API</li>
<li><code>ascli node access_key do self browse /</code> : list files
with gen4 API</li>
</ul>
<h2 data-number="8.2" id="operation-find-on-gen4access-key"><span
class="header-section-number">8.2</span> Operation <code>find</code> on
<strong>gen4/access key</strong></h2>
<p>The command <code>find &lt;folder&gt; [filter_expr]</code> is
available for <strong>gen4/access key</strong>, under
<code>access_keys do self</code>.</p>
<p>The argument <code>&lt;folder&gt;</code> is mandatory and is the root
from which search is performed. The argument <code>[filter_expr]</code>
is optional and represent the matching criteria.</p>
<p>It recursively scans storage to find files/folders matching a
criteria and then returns a list of matching entries.</p>
<p><code>[filter_expr]</code> is either:</p>
<ul>
<li>Optional (default) : all files and folder are selected</li>
<li>type <code>String</code> : the expression is similar to shell
globbing, refer to <strong>Ruby</strong> function: <a
href="https://ruby-doc.org/3.2.2/File.html#method-c-fnmatch"><code>File.fnmatch</code></a></li>
<li>Type <code>Proc</code> : the expression is a Ruby lambda that takes
one argument: a <code>Hash</code> that contains the current folder entry
to test. Refer to the following examples.</li>
</ul>
<p>Examples of expressions:</p>
<ul>
<li><p>Find all files and folders under <code>/</code></p>
<div class="sourceCode" id="cb360"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node access_keys do self find</span></code></pre></div></li>
<li><p>Find all text files <code>/Documents</code></p>
<div class="sourceCode" id="cb361"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node access_keys do self find /Documents <span class="st">&#39;*.txt&#39;</span></span></code></pre></div></li>
</ul>
<p>The following are examples of <code>ruby_lambda</code> to be provided
in the following template command:</p>
<div class="sourceCode" id="cb362"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a> <span class="ex">ascli</span> node access_keys do self find / @ruby:<span class="st">&#39;ruby_lambda&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> Single quotes are used here above to protect
the whole <strong>Ruby</strong> expression from the shell. Then double
quotes are used for strings in the <strong>Ruby</strong> expression to
not mix with the shell.</p>
</blockquote>
<ul>
<li><p>Find files more recent than 100 days</p>
<div class="sourceCode" id="cb363"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-&gt;</span>(f)<span class="kw">{</span>f<span class="kw">[</span><span class="st">&quot;type&quot;</span><span class="kw">]</span><span class="at">.eql?</span>(<span class="st">&quot;file&quot;</span>) <span class="cf">and</span> (<span class="dt">DateTime</span><span class="at">.now</span><span class="kw">-</span><span class="dt">DateTime</span><span class="at">.parse</span>(f<span class="kw">[</span><span class="st">&quot;modified_time&quot;</span><span class="kw">]</span>))<span class="kw">&lt;</span><span class="dv">100</span><span class="kw">}</span></span></code></pre></div></li>
<li><p>Find files older than 1 year</p>
<div class="sourceCode" id="cb364"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-&gt;</span>(f)<span class="kw">{</span>f<span class="kw">[</span><span class="st">&quot;type&quot;</span><span class="kw">]</span><span class="at">.eql?</span>(<span class="st">&quot;file&quot;</span>) <span class="cf">and</span> (<span class="dt">DateTime</span><span class="at">.now</span><span class="kw">-</span><span class="dt">DateTime</span><span class="at">.parse</span>(f<span class="kw">[</span><span class="st">&quot;modified_time&quot;</span><span class="kw">]</span>))<span class="kw">&gt;</span><span class="dv">365</span><span class="kw">}</span></span></code></pre></div></li>
<li><p>Find files larger than 1MB</p>
<div class="sourceCode" id="cb365"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-&gt;</span>(f)<span class="kw">{</span>f<span class="kw">[</span><span class="st">&quot;type&quot;</span><span class="kw">]</span><span class="at">.eql?</span>(<span class="st">&quot;file&quot;</span>) <span class="cf">and</span> f<span class="kw">[</span><span class="st">&quot;size&quot;</span><span class="kw">]</span><span class="at">.to_i</span><span class="kw">&gt;</span><span class="dv">1000000</span><span class="kw">}</span></span></code></pre></div></li>
<li><p>Filter out files beginning with <code>._</code> or named
<code>.DS_Store</code>:</p>
<div class="sourceCode" id="cb366"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-&gt;</span>(f)<span class="kw">{</span>!(f<span class="kw">[</span><span class="st">&quot;name&quot;</span><span class="kw">]</span><span class="at">.start_with?</span>(<span class="st">&quot;._&quot;</span>) <span class="cf">or</span> f<span class="kw">[</span><span class="st">&quot;name&quot;</span><span class="kw">]</span><span class="at">.eql?</span>(<span class="st">&quot;.DS_Store&quot;</span>))<span class="kw">}</span></span></code></pre></div></li>
<li><p>Match files using a <a
href="https://ruby-doc.org/core/Regexp.html">Ruby Regex</a> :
<code>\.gif$</code></p>
<div class="sourceCode" id="cb367"><pre
class="sourceCode ruby"><code class="sourceCode ruby"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="kw">-&gt;</span>(f)<span class="kw">{</span>f<span class="kw">[</span><span class="st">&quot;name&quot;</span><span class="kw">]</span><span class="at">.match?</span>(<span class="ss">/\.gif$/</span>)<span class="kw">}</span></span></code></pre></div></li>
</ul>
<p><code>ascli</code> commands can be piped in order to combine
operations, such as “find and delete”:</p>
<div class="sourceCode" id="cb368"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node access_keys do self find / @ruby:<span class="st">&#39;-&gt;(f){f[&quot;type&quot;].eql?(&quot;file&quot;) and (DateTime.now-DateTime.parse(f[&quot;modified_time&quot;]))&gt;365}&#39;</span> <span class="at">--fields</span><span class="op">=</span>path <span class="at">--format</span><span class="op">=</span>csv <span class="kw">|</span> <span class="ex">ascli</span> node <span class="at">--bulk</span><span class="op">=</span>yes delete @lines:@stdin:</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> the pipe <code>|</code> character on the last
line.</p>
</blockquote>
<h2 data-number="8.3" id="central"><span
class="header-section-number">8.3</span> Central</h2>
<p>The central subcommand uses the <em>reliable query</em> API (session
and file). It allows listing transfer sessions and transferred
files.</p>
<p>Filtering can be applied:</p>
<div class="sourceCode" id="cb369"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node central file list</span></code></pre></div>
<p>By providing the <code>validator</code> option, offline transfer
validation can be done.</p>
<blockquote>
<p><strong>Note:</strong> This API will probably be deprecated in the
future.</p>
</blockquote>
<h2 data-number="8.4" id="sync"><span
class="header-section-number">8.4</span> Sync</h2>
<p>There are three sync types of operations:</p>
<ul>
<li><code>sync</code>: perform a local sync, by executing
<code>async</code> locally</li>
<li><code>async</code>: calls legacy async API on node :
<code>/async</code></li>
<li><code>ssync</code> : calls newer async API on node :
<code>/asyncs</code></li>
</ul>
<h2 data-number="8.5" id="fasp-stream"><span
class="header-section-number">8.5</span> FASP Stream</h2>
<p>It is possible to start a FASPStream session using the node API:</p>
<p>Use the command
<code>ascli node stream create --ts=@json:&lt;value&gt;</code>, with <a
href="#transferspec"><em>transfer-spec</em></a>:</p>
<div class="sourceCode" id="cb370"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;direction&quot;</span><span class="fu">:</span><span class="st">&quot;send&quot;</span><span class="fu">,</span><span class="dt">&quot;source&quot;</span><span class="fu">:</span><span class="st">&quot;udp://233.3.3.4:3000?loopback=1&amp;ttl=2&quot;</span><span class="fu">,</span><span class="dt">&quot;destination&quot;</span><span class="fu">:</span><span class="st">&quot;udp://233.3.3.3:3001/&quot;</span><span class="fu">,</span><span class="dt">&quot;remote_host&quot;</span><span class="fu">:</span><span class="st">&quot;localhost&quot;</span><span class="fu">,</span><span class="dt">&quot;remote_user&quot;</span><span class="fu">:</span><span class="st">&quot;stream&quot;</span><span class="fu">,</span><span class="dt">&quot;remote_password&quot;</span><span class="fu">:</span><span class="st">&quot;my_pass_here&quot;</span><span class="fu">}</span></span></code></pre></div>
<h2 data-number="8.6" id="watchfolder"><span
class="header-section-number">8.6</span> Watchfolder</h2>
<p>Refer to <a
href="https://download.asperasoft.com/download/docs/entsrv/3.7.4/es_admin_linux/webhelp/index.html#watchfolder_external/dita/json_conf.html">Aspera
documentation</a> for watch folder creation.</p>
<p><code>ascli</code> supports remote operations through the node API.
Operations are:</p>
<ul>
<li>Start watchd and watchfolderd services running as a system user
having access to files</li>
<li>configure a watchfolder to define automated transfers</li>
</ul>
<div class="sourceCode" id="cb371"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node service create @json:<span class="st">&#39;{&quot;id&quot;:&quot;mywatchd&quot;,&quot;type&quot;:&quot;WATCHD&quot;,&quot;run_as&quot;:{&quot;user&quot;:&quot;user1&quot;}}&#39;</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node service create @json:<span class="st">&#39;{&quot;id&quot;:&quot;mywatchfolderd&quot;,&quot;type&quot;:&quot;WATCHFOLDERD&quot;,&quot;run_as&quot;:{&quot;user&quot;:&quot;user1&quot;}}&#39;</span></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node watch_folder create @json:<span class="st">&#39;{&quot;id&quot;:&quot;mywfolder&quot;,&quot;source_dir&quot;:&quot;/watch1&quot;,&quot;target_dir&quot;:&quot;/&quot;,&quot;transport&quot;:{&quot;host&quot;:&quot;10.25.0.4&quot;,&quot;user&quot;:&quot;user1&quot;,&quot;pass&quot;:&quot;mypassword&quot;}}&#39;</span></span></code></pre></div>
<h2 data-number="8.7" id="out-of-transfer-file-validation"><span
class="header-section-number">8.7</span> Out of Transfer File
Validation</h2>
<p>Follow the Aspera Transfer Server configuration to activate this
feature.</p>
<div class="sourceCode" id="cb372"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node central file list <span class="at">--validator</span><span class="op">=</span>ascli <span class="at">--data</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;file_transfer_filter&quot;:{&quot;max_result&quot;:1}}&#39;</span></span></code></pre></div>
<pre class="output"><code>+--------------+--------------+------------+--------------------------------------+
| session_uuid |    file_id   |   status   |              path                    |
+--------------+--------------+------------+--------------------------------------+
| 1a74444c-... | 084fb181-... | validating | /home/xfer.../PKG - my title/200KB.1 |
+--------------+--------------+------------+--------------------------------------+</code></pre>
<div class="sourceCode" id="cb374"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node central file update <span class="at">--validator</span><span class="op">=</span>ascli <span class="at">--data</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;files&quot;:[{&quot;session_uuid&quot;: &quot;1a74444c-...&quot;,&quot;file_id&quot;: &quot;084fb181-...&quot;,&quot;status&quot;: &quot;completed&quot;}]}&#39;</span></span></code></pre></div>
<pre class="output"><code>updated</code></pre>
<h2 data-number="8.8" id="example-shod-to-ats"><span
class="header-section-number">8.8</span> Example: SHOD to ATS</h2>
<p>Scenario: Access to a <strong>Shares on Demand</strong> (SHOD) server
on AWS is provided by a partner. We need to transfer files from this
third party SHOD instance into our Azure BLOB storage. Simply create an
<strong>Aspera Transfer Service</strong> instance, which provides access
to the node API. Then create a configuration for the
<strong>SHOD</strong> instance in the configuration file: in section
“shares”, a configuration named: aws_shod. Create another configuration
for the Azure ATS instance: in section “node”, named azure_ats. Then
execute the following command:</p>
<div class="sourceCode" id="cb376"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node download /share/sourcefile <span class="at">--to-folder</span><span class="op">=</span>/destination_folder <span class="at">--preset</span><span class="op">=</span>aws_shod <span class="at">--transfer</span><span class="op">=</span>node <span class="at">--transfer-info</span><span class="op">=</span>@preset:azure_ats</span></code></pre></div>
<p>This will get transfer information from the SHOD instance and tell
the Azure ATS instance to download files.</p>
<h2 data-number="8.9" id="node-file-information"><span
class="header-section-number">8.9</span> node file information</h2>
<p>When node api is used with an <strong>Access key</strong>, extra
information can be retrieved, such as preview.</p>
<blockquote>
<p><strong>Note:</strong> Display of preview on terminal requires
installation of extra gem: <code>rmagick</code></p>
</blockquote>
<div class="sourceCode" id="cb377"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> install <span class="at">-y</span> ImageMagick-devel</span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="ex">gem</span> install rmagick rainbow</span></code></pre></div>
<p>For example, it is possible to display the preview of a file, if it
exists, using an access key on node:</p>
<div class="sourceCode" id="cb378"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node access_key do self thumbnail /preview_samples/Aspera.mpg</span></code></pre></div>
<p>Previews are mainly used in AoC, this also works with AoC:</p>
<div class="sourceCode" id="cb379"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files thumbnail /preview_samples/Aspera.mpg</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> To specify the file by its file id, use the
selector syntax: <code>%id:_file_id_here_</code></p>
<p><strong>Note:</strong> To force textual display of the preview on
<strong>iTerm</strong>, prefix command with:
<code>env -u TERM_PROGRAM -u LC_TERMINAL</code></p>
</blockquote>
<h2 data-number="8.10" id="create-access-key"><span
class="header-section-number">8.10</span> Create access key</h2>
<div class="sourceCode" id="cb380"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> node access_key create @json:<span class="st">&#39;{&quot;id&quot;:&quot;myaccesskey&quot;,&quot;secret&quot;:&quot;my_secret_here&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;local&quot;,&quot;path&quot;:&quot;/data/mydir&quot;}}&#39;</span></span></code></pre></div>
<h2 data-number="8.11" id="node-sample-commands"><span
class="header-section-number">8.11</span> Node sample commands</h2>
<div class="sourceCode" id="cb381"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key create @json:<span class="st">&#39;{&quot;id&quot;:&quot;testingAK1&quot;,&quot;storage&quot;:{&quot;type&quot;:&quot;local&quot;,&quot;path&quot;:&quot;/&quot;}}&#39;</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key delete testingAK1</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name browse /</span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name delete /folder2</span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name delete testfile1</span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name download testfile1 <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name find /</span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name find / @ruby:<span class="st">&#39;-&gt;(f){f[&quot;name&quot;].end_with?(&quot;.jpg&quot;)}&#39;</span></span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name find / exec:<span class="st">&#39;f[&quot;name&quot;].end_with?(&quot;.jpg&quot;)&#39;</span></span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name mkdir /folder1</span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name node_info /</span>
<span id="cb381-12"><a href="#cb381-12" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name rename /folder1 folder2</span>
<span id="cb381-13"><a href="#cb381-13" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name show %id:1</span>
<span id="cb381-14"><a href="#cb381-14" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name show /testfile1</span>
<span id="cb381-15"><a href="#cb381-15" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key do my_aoc_ak_name upload <span class="st">&#39;faux:///testfile1?1k&#39;</span> <span class="at">--default_ports</span><span class="op">=</span>no</span>
<span id="cb381-16"><a href="#cb381-16" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> access_key list</span>
<span id="cb381-17"><a href="#cb381-17" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> api_details</span>
<span id="cb381-18"><a href="#cb381-18" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> async bandwidth 1</span>
<span id="cb381-19"><a href="#cb381-19" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> async counters 1</span>
<span id="cb381-20"><a href="#cb381-20" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> async files 1</span>
<span id="cb381-21"><a href="#cb381-21" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> async list</span>
<span id="cb381-22"><a href="#cb381-22" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> async show 1</span>
<span id="cb381-23"><a href="#cb381-23" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> async show ALL</span>
<span id="cb381-24"><a href="#cb381-24" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> basic_token</span>
<span id="cb381-25"><a href="#cb381-25" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> browse / <span class="at">-r</span></span>
<span id="cb381-26"><a href="#cb381-26" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> delete @list:,my_upload_folder/todelete,my_upload_folder/tdlink,my_upload_folder/delfile</span>
<span id="cb381-27"><a href="#cb381-27" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> delete my_upload_folder/testfile.bin</span>
<span id="cb381-28"><a href="#cb381-28" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> download my_upload_folder/testfile.bin <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb381-29"><a href="#cb381-29" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> health</span>
<span id="cb381-30"><a href="#cb381-30" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> info <span class="at">--fpac</span><span class="op">=</span><span class="st">&#39;function FindProxyForURL(url,host){return &quot;DIRECT&quot;}&#39;</span></span>
<span id="cb381-31"><a href="#cb381-31" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> license</span>
<span id="cb381-32"><a href="#cb381-32" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> mkdir my_upload_folder/todelete</span>
<span id="cb381-33"><a href="#cb381-33" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> mkfile my_upload_folder/delfile1 <span class="st">&quot;hello world&quot;</span></span>
<span id="cb381-34"><a href="#cb381-34" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> mklink my_upload_folder/todelete my_upload_folder/tdlink</span>
<span id="cb381-35"><a href="#cb381-35" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> rename my_upload_folder delfile1 delfile</span>
<span id="cb381-36"><a href="#cb381-36" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> search / <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;sort&quot;:&quot;mtime&quot;}&#39;</span></span>
<span id="cb381-37"><a href="#cb381-37" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> service create @json:<span class="st">&#39;{&quot;id&quot;:&quot;service1&quot;,&quot;type&quot;:&quot;WATCHD&quot;,&quot;run_as&quot;:{&quot;user&quot;:&quot;user1&quot;}}&#39;</span></span>
<span id="cb381-38"><a href="#cb381-38" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> service delete service1</span>
<span id="cb381-39"><a href="#cb381-39" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> service list</span>
<span id="cb381-40"><a href="#cb381-40" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> space /</span>
<span id="cb381-41"><a href="#cb381-41" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync bandwidth %name:my_node_sync</span>
<span id="cb381-42"><a href="#cb381-42" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync counters %name:my_node_sync</span>
<span id="cb381-43"><a href="#cb381-43" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync create @json:<span class="st">&#39;{&quot;configuration&quot;:{&quot;name&quot;:&quot;my_node_sync&quot;,&quot;local&quot;:{&quot;path&quot;:&quot;my_local_path&quot;},&quot;remote&quot;:{&quot;host&quot;:&quot;my_host&quot;,&quot;port&quot;:my_port,&quot;user&quot;:&quot;my_username&quot;,&quot;pass&quot;:&quot;my_password&quot;,&quot;path&quot;:&quot;my_remote_path&quot;}}}&#39;</span></span>
<span id="cb381-44"><a href="#cb381-44" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync delete %name:my_node_sync</span>
<span id="cb381-45"><a href="#cb381-45" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync files %name:my_node_sync</span>
<span id="cb381-46"><a href="#cb381-46" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync list</span>
<span id="cb381-47"><a href="#cb381-47" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync show %name:my_node_sync</span>
<span id="cb381-48"><a href="#cb381-48" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync start %name:my_node_sync</span>
<span id="cb381-49"><a href="#cb381-49" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync state %name:my_node_sync</span>
<span id="cb381-50"><a href="#cb381-50" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync stop %name:my_node_sync</span>
<span id="cb381-51"><a href="#cb381-51" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> ssync summary %name:my_node_sync</span>
<span id="cb381-52"><a href="#cb381-52" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> sync admin status <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;my_node_sync2&quot;,&quot;reset&quot;:true,&quot;direction&quot;:&quot;pull&quot;,&quot;local&quot;:{&quot;path&quot;:&quot;/data/localsync&quot;},&quot;remote&quot;:{&quot;path&quot;:&quot;/aspera-test-dir-tiny&quot;}}&#39;</span></span>
<span id="cb381-53"><a href="#cb381-53" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> sync admin status <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;sessions&quot;:[{&quot;name&quot;:&quot;my_node_sync1&quot;,&quot;direction&quot;:&quot;pull&quot;,&quot;local_dir&quot;:&quot;/data/localsync&quot;,&quot;remote_dir&quot;:&quot;/aspera-test-dir-tiny&quot;,&quot;reset&quot;:true}]}&#39;</span></span>
<span id="cb381-54"><a href="#cb381-54" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> sync start <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;name&quot;:&quot;my_node_sync2&quot;,&quot;reset&quot;:true,&quot;direction&quot;:&quot;pull&quot;,&quot;local&quot;:{&quot;path&quot;:&quot;/data/localsync&quot;},&quot;remote&quot;:{&quot;path&quot;:&quot;/aspera-test-dir-tiny&quot;}}&#39;</span></span>
<span id="cb381-55"><a href="#cb381-55" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> sync start <span class="at">--sync-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;sessions&quot;:[{&quot;name&quot;:&quot;my_node_sync1&quot;,&quot;direction&quot;:&quot;pull&quot;,&quot;local_dir&quot;:&quot;/data/localsync&quot;,&quot;remote_dir&quot;:&quot;/aspera-test-dir-tiny&quot;,&quot;reset&quot;:true}]}&#39;</span></span>
<span id="cb381-56"><a href="#cb381-56" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> transfer list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;active_only&quot;:true}&#39;</span></span>
<span id="cb381-57"><a href="#cb381-57" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> transfer sessions</span>
<span id="cb381-58"><a href="#cb381-58" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> upload <span class="at">--to-folder</span><span class="op">=</span>my_upload_folder <span class="at">--sources</span><span class="op">=</span>@ts <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;paths&quot;:[{&quot;source&quot;:&quot;/aspera-test-dir-small/10MB.2&quot;}],&quot;precalculate_job_size&quot;:true}&#39;</span> <span class="at">--transfer</span><span class="op">=</span>node <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;url&quot;:&quot;https://node_simple.example.com/path@&quot;,&quot;username&quot;:&quot;my_username&quot;,&quot;password&quot;:&quot;my_password&quot;}&#39;</span></span>
<span id="cb381-59"><a href="#cb381-59" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> upload <span class="at">--username</span><span class="op">=</span>my_aoc_ak_name <span class="at">--password</span><span class="op">=</span>my_aoc_ak_secret testfile.bin</span>
<span id="cb381-60"><a href="#cb381-60" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> upload testfile.bin <span class="at">--to-folder</span><span class="op">=</span>my_upload_folder <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;target_rate_cap_kbps&quot;:10000}&#39;</span></span></code></pre></div>
<h1 data-number="9" id="plugin-faspex5-ibm-aspera-faspex-v5"><span
class="header-section-number">9</span> <a id="faspex5"></a>Plugin:
<code>faspex5</code>: IBM Aspera Faspex v5</h1>
<p>IBM Aspera’s newer self-managed application.</p>
<p>3 authentication methods are supported:</p>
<ul>
<li>jwt : general purpose, private-key based authentication</li>
<li>link : public link authentication</li>
<li>web : requires authentication with web browser</li>
<li>boot : use authentication token copied from browser
(experimental)</li>
</ul>
<p>For a quick start, one can use the wizard, which will help creating a
<a href="#lprt">option preset</a>:</p>
<div class="sourceCode" id="cb382"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config wizard</span></code></pre></div>
<pre class="text"><code>argument: url&gt; faspex5.example.com
Multiple applications detected:
+---------+-------------------------------------------+-------------+
| product | url                                       | version     |
+---------+-------------------------------------------+-------------+
| faspex5 | https://faspex5.example.com/aspera/faspex | F5.0.6      |
| server  | ssh://faspex5.example.com:22              | OpenSSH_8.3 |
+---------+-------------------------------------------+-------------+
product&gt; faspex5
Using: Faspex at https://faspex5.example.com/aspera/faspex
Please provide the path to your private RSA key, or nothing to generate one:
option: pkeypath&gt;
Using existing key:
/Users/someuser/.aspera/ascli/my_key
option: username&gt; someuser@example.com
Ask the ascli client id and secret to your Administrator.
Admin should login to: https://faspex5.example.com/aspera/faspex
Navigate to: ::  → Admin → Configurations → API clients
Create an API client with:
- name: ascli
- JWT: enabled
Then, logged in as someuser@example.com go to your profile:
() → Account Settings → Preferences -&gt; Public Key in PEM:
-----BEGIN PUBLIC KEY-----
redacted
-----END PUBLIC KEY-----
Once set, fill in the parameters:
option: client_id&gt; _my_key_here_
option: client_secret&gt; ****
Preparing preset: faspex5_example_com_user
Setting config preset as default for faspex5
Done.
You can test with:
ascli faspex5 user profile show
Saving config file.</code></pre>
<blockquote>
<p><strong>Note:</strong> Include the public key <code>BEGIN</code> and
<code>END</code> lines when pasting in the user profile.</p>
</blockquote>
<p>For details on the JWT method, see the following section.</p>
<h2 data-number="9.1" id="faspex-5-jwt-authentication"><span
class="header-section-number">9.1</span> Faspex 5 JWT
authentication</h2>
<p>This is the general purpose and <strong>recommended</strong> method
to use.</p>
<p>Activation is in two steps:</p>
<ul>
<li><p>The admninistrator must create an API client in Faspex with JWT
support</p>
<p>This operation is generally done only once:</p>
<ul>
<li>As Admin, Navigate to the web UI: Admin → Configurations → API
Clients → Create</li>
<li>Give a name, like <code>ascli</code></li>
<li>Activate JWT</li>
<li>There is an option to set a general public key allowing the owner of
the private key to impersonate any user. Unless you want to do this,
leave this field empty.</li>
<li>Click on <code>Create</code> Button</li>
<li>Take note of Client Id (and Client Secret, but not used in current
version)</li>
</ul></li>
<li><p>The user uses a private key and sets the public key in his faspex
5 profile</p>
<p>This operation is done by each user using the CLI.</p>
<ul>
<li>As user, click on the user logo, left to the app switcher on top
right.</li>
<li>Select <code>Account Settings</code></li>
<li>on the bottom in the text field:
<code>Public key in PEM format</code> paste the <strong>public</strong>
key corresponding to the private key used by the user.</li>
</ul>
<p><strong>Note:</strong> If you don’t have any refer to section <a
href="#private_key">Private Key</a></p></li>
</ul>
<p>Then use these options:</p>
<pre class="text"><code>--auth=jwt
--client-id=_client_id_here_
--client-secret=my_secret_here
--username=_username_here_
--private-key=@file:.../path/to/key.pem</code></pre>
<blockquote>
<p><strong>Note:</strong> The <code>private_key</code> option must
contain the PEM <strong>value</strong> (not file path) of the private
key which can be read from a file using the modifier:
<code>@file:</code>, e.g. <code>@file:/path/to/key.pem</code>.</p>
</blockquote>
<p>As usual, typically a user will create preset to avoid having to type
these options each time.</p>
<p>Example:</p>
<div class="sourceCode" id="cb385"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset update myf5 <span class="at">--auth</span><span class="op">=</span>jwt <span class="at">--client-id</span><span class="op">=</span>_client_id_here_ <span class="at">--client-secret</span><span class="op">=</span>my_secret_here <span class="at">--username</span><span class="op">=</span>_username_here_ <span class="at">--private-key</span><span class="op">=</span>@file:.../path/to/key.pem</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset set default faspx5 myf5</span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 user profile show</span></code></pre></div>
<h2 data-number="9.2" id="faspex-5-web-authentication"><span
class="header-section-number">9.2</span> Faspex 5 web
authentication</h2>
<p>The admninistrator must create an API client in Faspex for an
external web app support:</p>
<ul>
<li>As Admin, Navigate to the web UI: Admin → Configurations → API
Clients → Create</li>
<li>Do not Activate JWT</li>
<li>Set <strong>Redirect URI</strong> to
<code>https://127.0.0.1:8888</code></li>
<li>Click on <code>Create</code> Button</li>
<li>Take note of Client Id (and Client Secret, but not used in current
version)</li>
</ul>
<p>The user will use the following options:</p>
<pre class="text"><code>--auth=web
--client-id=_client_id_here_
--client-secret=my_secret_here
--redirect-uri=https://127.0.0.1:8888</code></pre>
<h2 data-number="9.3" id="faspex-5-bootstrap-authentication"><span
class="header-section-number">9.3</span> Faspex 5 bootstrap
authentication</h2>
<p>For <code>boot</code> method: (will be removed in future)</p>
<ul>
<li>As user: Open a Web Browser</li>
<li>Start developer mode</li>
<li>Login to Faspex 5</li>
<li>Find the first API call with <code>Authorization</code> header, and
copy the value of the token (series of base64 values with dots)</li>
</ul>
<p>Use this token as password and use <code>--auth=boot</code>.</p>
<div class="sourceCode" id="cb387"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset update f5boot <span class="at">--url</span><span class="op">=</span>https://localhost/aspera/faspex <span class="at">--auth</span><span class="op">=</span>boot <span class="at">--password</span><span class="op">=</span>_token_here_</span></code></pre></div>
<h2 data-number="9.4" id="faspex-5-sample-commands"><span
class="header-section-number">9.4</span> Faspex 5 sample commands</h2>
<p>Most commands are directly REST API calls. Parameters to commands are
carried through option <code>query</code>, as extended value, for
<code>list</code>, or through positional argument for creation. One can
conveniently use the JSON format with prefix <code>@json:</code>.</p>
<blockquote>
<p><strong>Note:</strong> The API is listed in <a
href="https://developer.ibm.com/apis/catalog?search=%22faspex+5%22">Faspex
5 API Reference</a> under <strong>IBM Aspera Faspex API</strong>.</p>
</blockquote>
<div class="sourceCode" id="cb388"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res accounts list</span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res contacts list</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res jobs list</span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res metadata_profiles list</span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res node list</span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res oauth_clients list</span>
<span id="cb388-7"><a href="#cb388-7" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res registrations list</span>
<span id="cb388-8"><a href="#cb388-8" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res saml_configs list</span>
<span id="cb388-9"><a href="#cb388-9" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res shared_inboxes invite %name:<span class="st">&#39;ascli shinbox&#39;</span> johnny@example.com</span>
<span id="cb388-10"><a href="#cb388-10" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res shared_inboxes list</span>
<span id="cb388-11"><a href="#cb388-11" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res shared_inboxes members %name:<span class="st">&#39;ascli shinbox&#39;</span> create %name:john@example.com</span>
<span id="cb388-12"><a href="#cb388-12" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res shared_inboxes members %name:<span class="st">&#39;ascli shinbox&#39;</span> delete %name:john@example.com</span>
<span id="cb388-13"><a href="#cb388-13" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res shared_inboxes members %name:<span class="st">&#39;ascli shinbox&#39;</span> delete %name:johnny@example.com</span>
<span id="cb388-14"><a href="#cb388-14" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res shared_inboxes members %name:<span class="st">&#39;ascli shinbox&#39;</span> list</span>
<span id="cb388-15"><a href="#cb388-15" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin res workgroups list</span>
<span id="cb388-16"><a href="#cb388-16" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin smtp show</span>
<span id="cb388-17"><a href="#cb388-17" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> admin smtp test my_email_external</span>
<span id="cb388-18"><a href="#cb388-18" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> bearer_token</span>
<span id="cb388-19"><a href="#cb388-19" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> gateway https://localhost:12345/aspera/faspex</span>
<span id="cb388-20"><a href="#cb388-20" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> health</span>
<span id="cb388-21"><a href="#cb388-21" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages list <span class="at">--box</span><span class="op">=</span>my_faspex5_shinbox</span>
<span id="cb388-22"><a href="#cb388-22" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages list <span class="at">--box</span><span class="op">=</span>my_faspex5_workgroup <span class="at">--group-type</span><span class="op">=</span>workgroups</span>
<span id="cb388-23"><a href="#cb388-23" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;mailbox&quot;:&quot;inbox&quot;,&quot;state&quot;:[&quot;released&quot;]}&#39;</span></span>
<span id="cb388-24"><a href="#cb388-24" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages receive <span class="st">&quot;my_package_id&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;content_protection_password&quot;:&quot;abc123_yo&quot;}&#39;</span></span>
<span id="cb388-25"><a href="#cb388-25" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages receive <span class="at">--box</span><span class="op">=</span>my_faspex5_shinbox <span class="st">&quot;my_package_id&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb388-26"><a href="#cb388-26" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages receive <span class="at">--box</span><span class="op">=</span>my_faspex5_workgroup <span class="at">--group-type</span><span class="op">=</span>workgroups <span class="st">&quot;my_package_id&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb388-27"><a href="#cb388-27" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages receive ALL <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb388-28"><a href="#cb388-28" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages receive INIT <span class="at">--once-only</span><span class="op">=</span>yes</span>
<span id="cb388-29"><a href="#cb388-29" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages send @json:<span class="st">&#39;{&quot;title&quot;:&quot;test title&quot;,&quot;recipients&quot;:[&quot;my_faspex5_shinbox&quot;],&quot;metadata&quot;:{&quot;Options&quot;:&quot;Opt1&quot;,&quot;TextInput&quot;:&quot;example text&quot;}}&#39;</span> testfile.bin</span>
<span id="cb388-30"><a href="#cb388-30" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages send @json:<span class="st">&#39;{&quot;title&quot;:&quot;test title&quot;,&quot;recipients&quot;:[&quot;my_faspex5_workgroup&quot;]}&#39;</span> testfile.bin</span>
<span id="cb388-31"><a href="#cb388-31" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages send @json:<span class="st">&#39;{&quot;title&quot;:&quot;test title&quot;,&quot;recipients&quot;:[{&quot;name&quot;:&quot;my_username&quot;}]my_faspex5_meta}&#39;</span> testfile.bin <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;content_protection_password&quot;:&quot;my_passphrase_here&quot;}&#39;</span></span>
<span id="cb388-32"><a href="#cb388-32" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages show <span class="st">&quot;my_package_id&quot;</span></span>
<span id="cb388-33"><a href="#cb388-33" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages show <span class="at">--box</span><span class="op">=</span>my_faspex5_shinbox <span class="st">&quot;my_package_id&quot;</span></span>
<span id="cb388-34"><a href="#cb388-34" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages show <span class="at">--box</span><span class="op">=</span>my_faspex5_workgroup <span class="at">--group-type</span><span class="op">=</span>workgroups <span class="st">&quot;my_package_id&quot;</span></span>
<span id="cb388-35"><a href="#cb388-35" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> packages status <span class="st">&quot;my_package_id&quot;</span></span>
<span id="cb388-36"><a href="#cb388-36" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> postprocessing @json:<span class="st">&#39;{&quot;url&quot;:&quot;https://localhost:8443/domain&quot;,&quot;processing&quot;:{&quot;script_folder&quot;:&quot;tests&quot;},&quot;certificate&quot;:{&quot;key&quot;:&quot;../local/k&quot;,&quot;cert&quot;:&quot;../local/c&quot;,&quot;chain&quot;:&quot;../local/ch&quot;}}&#39;</span></span>
<span id="cb388-37"><a href="#cb388-37" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> shared browse %name:my_faspex_src</span>
<span id="cb388-38"><a href="#cb388-38" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> shared list</span>
<span id="cb388-39"><a href="#cb388-39" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> user profile modify @json:<span class="st">&#39;{&quot;preference&quot;:{&quot;connect_disabled&quot;:false}}&#39;</span></span>
<span id="cb388-40"><a href="#cb388-40" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex5</span> user profile show</span></code></pre></div>
<h2 data-number="9.5" id="faspex-5-inbox-selection"><span
class="header-section-number">9.5</span> Faspex 5: inbox selection</h2>
<p>By default, package operations (send, receive, list) are done on the
user’s inbox.</p>
<p>To select another inbox, use option <code>box</code> with one of the
following values:</p>
<ul>
<li>inbox</li>
<li>inbox_history</li>
<li>inbox_all</li>
<li>inbox_all_history</li>
<li>outbox</li>
<li>outbox_history</li>
<li>pending</li>
<li>pending_history</li>
<li>all</li>
<li>ALL (only admin)</li>
<li>name of a shared inbox or workgroup</li>
</ul>
<blockquote>
<p><strong>Note:</strong> specify if the box is a shared inbox or a
workgroup using option <code>group_type</code> with either
<code>shared_inboxes</code> or <code>workgroups</code></p>
</blockquote>
<h2 data-number="9.6" id="faspex-5-send-a-package"><span
class="header-section-number">9.6</span> Faspex 5: Send a package</h2>
<p>The <code>Hash</code> creation parameter provided to command
<code>faspex5 packages send</code> corresponds to the Faspex 5 API:
<code>POST /packages</code>.</p>
<p>Required fields are <code>title</code> and <code>recipients</code>.
Example using <code>@json:</code> format:</p>
<div class="sourceCode" id="cb389"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;title&quot;</span><span class="fu">:</span><span class="st">&quot;some title&quot;</span><span class="fu">,</span><span class="dt">&quot;recipients&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;recipient_type&quot;</span><span class="fu">:</span><span class="st">&quot;user&quot;</span><span class="fu">,</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;user@example.com&quot;</span><span class="fu">}</span><span class="ot">]</span><span class="fu">}</span></span></code></pre></div>
<p><code>recipient_type</code> is one of (Refer to API):</p>
<ul>
<li>user</li>
<li>workgroup</li>
<li>external_user</li>
<li>distribution_list</li>
<li>shared_inbox</li>
</ul>
<p><code>ascli</code> adds some convenience: The API expects the field
<code>recipients</code> to be an <code>Array</code> of
<code>Hash</code>, each with field <code>name</code> and optionally
<code>recipient_type</code>. It is also possible to provide an
<code>Array</code> of <code>String</code>, with simply a recipient name.
Then <code>ascli</code> will lookup existing contacts among all possible
types, use it if a single match is found, and set the <code>name</code>
and <code>recipient_type</code> accordingly. Else an exception is
sent.</p>
<blockquote>
<p><strong>Note:</strong> The lookup is case insensitive and on partial
matches.</p>
</blockquote>
<div class="sourceCode" id="cb390"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;title&quot;</span><span class="fu">:</span><span class="st">&quot;some title&quot;</span><span class="fu">,</span><span class="dt">&quot;recipients&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;user@example.com&quot;</span><span class="ot">]</span><span class="fu">}</span></span></code></pre></div>
<p>If the lookup needs to be only on certain types, you can specify the
field: <code>recipient_types</code> with either a single value or an
Array of values (from the list above). e.g. :</p>
<div class="sourceCode" id="cb391"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;title&quot;</span><span class="fu">:</span><span class="st">&quot;test title&quot;</span><span class="fu">,</span><span class="dt">&quot;recipient_types&quot;</span><span class="fu">:</span><span class="st">&quot;user&quot;</span><span class="fu">,</span><span class="dt">&quot;recipients&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;user1@example.com&quot;</span><span class="ot">,</span><span class="st">&quot;user2@example.com&quot;</span><span class="ot">]</span><span class="fu">}</span></span></code></pre></div>
<h2 data-number="9.7" id="faspex-5-send-a-package-with-metadata"><span
class="header-section-number">9.7</span> Faspex 5: Send a package with
metadata</h2>
<p>The interface is the one of the API (Refer to API documentation, or
look at request in browser):</p>
<div class="sourceCode" id="cb392"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 packages send @json:<span class="st">&#39;{&quot;title&quot;:&quot;test title&quot;,&quot;recipients&quot;:[&quot;my shared inbox&quot;],&quot;metadata&quot;:{&quot;Confidential&quot;:&quot;Yes&quot;,&quot;Drop menu&quot;:&quot;Option 1&quot;}}&#39;</span> <span class="st">&#39;faux:///test1?k1&#39;</span></span></code></pre></div>
<p>Basically, add the field <code>metadata</code>, with one key per
metadata and the value is directly the metadata value.</p>
<h2 data-number="9.8" id="faspex-5-receive-a-package"><span
class="header-section-number">9.8</span> Faspex 5: Receive a
package</h2>
<p>The (numeric) identifier of the package t receive is given as
argument to command <code>faspex5 packages receive</code>.</p>
<blockquote>
<p><strong>Note:</strong> option <code>box</code> applies.</p>
</blockquote>
<h2 data-number="9.9" id="faspex-5-list-packages"><span
class="header-section-number">9.9</span> Faspex 5: List packages</h2>
<p>The following parameters in option <code>query</code> are
supported:</p>
<ul>
<li><code>q</code> : a filter on name (case insensitive, matches if
value is contained in name)</li>
<li><code>max</code> : maximum number of items to retrieve (stop pages
when the maximum is passed)</li>
<li><code>pmax</code> : maximum number of pages to request (stop pages
when the maximum is passed)</li>
<li><code>offset</code> : native api parameter, in general do not use
(added by <code>ascli</code>)</li>
<li><code>limit</code> : native api parameter, number of items par api
call, in general do not use (added by <code>ascli</code>)</li>
</ul>
<p>Admin only: If the value <code>ALL</code> is provided to option
<code>box</code>, then all packages are selected.</p>
<h2 data-number="9.10"
id="faspex-5-list-all-shared-inboxes-and-workgroups"><span
class="header-section-number">9.10</span> Faspex 5: List all shared
inboxes and workgroups</h2>
<p>If ypou are a regular, user, list workgroups you belong to:</p>
<div class="sourceCode" id="cb393"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 admin res workgroup list</span></code></pre></div>
<p>If you are admin or manager, add option:
<code>--query=@json:'{"all":true}'</code>, this will list items you
manage, even if you do not belong to them.</p>
<div class="sourceCode" id="cb394"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 admin res shared list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;all&quot;:true}&#39;</span> <span class="at">--fields</span><span class="op">=</span>id,name</span></code></pre></div>
<p>Shared inbox members can also be listed, added, removed, and external
users can be invited to a shared inbox.</p>
<div class="sourceCode" id="cb395"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 admin res shared_inboxes invite <span class="st">&#39;%name:the shared inbox&#39;</span> john@example.com</span></code></pre></div>
<p>It is equivalent to:</p>
<div class="sourceCode" id="cb396"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 admin res shared_inboxes invite <span class="st">&#39;%name:the shared inbox&#39;</span> @json:<span class="st">&#39;{&quot;email_address&quot;:&quot;john@example.com&quot;}&#39;</span></span></code></pre></div>
<p>Other payload parameters are possible in Hash format:</p>
<div class="sourceCode" id="cb397"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;description&quot;</span><span class="fu">:</span><span class="st">&quot;blah&quot;</span><span class="fu">,</span><span class="dt">&quot;prevent_http_upload&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span><span class="dt">&quot;custom_link_expiration_policy&quot;</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">&quot;invitation_expires_after_upload&quot;</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">&quot;set_invitation_link_expiration&quot;</span><span class="fu">:</span><span class="kw">false</span><span class="fu">,</span><span class="dt">&quot;invitation_expiration_days&quot;</span><span class="fu">:</span><span class="dv">3</span></span></code></pre></div>
<h2 data-number="9.11" id="faspex-5-create-metadata-profile"><span
class="header-section-number">9.11</span> Faspex 5: Create Metadata
profile</h2>
<div class="sourceCode" id="cb398"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 admin res metadata_profiles create @json:<span class="st">&#39;{&quot;name&quot;:&quot;the profile&quot;,&quot;default&quot;:false,&quot;title&quot;:{&quot;max_length&quot;:200,&quot;illegal_chars&quot;:[]},&quot;note&quot;:{&quot;max_length&quot;:400,&quot;illegal_chars&quot;:[],&quot;enabled&quot;:false},&quot;fields&quot;:[{&quot;ordering&quot;:0,&quot;name&quot;:&quot;field1&quot;,&quot;type&quot;:&quot;text_area&quot;,&quot;require&quot;:true,&quot;illegal_chars&quot;:[],&quot;max_length&quot;:100},{&quot;ordering&quot;:1,&quot;name&quot;:&quot;fff2&quot;,&quot;type&quot;:&quot;option_list&quot;,&quot;require&quot;:false,&quot;choices&quot;:[&quot;opt1&quot;,&quot;opt2&quot;]}]}&#39;</span></span></code></pre></div>
<h2 data-number="9.12"
id="faspex-5-create-a-shared-inbox-with-specific-metadata-profile"><span
class="header-section-number">9.12</span> Faspex 5: Create a Shared
inbox with specific metadata profile</h2>
<div class="sourceCode" id="cb399"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 admin res shared create @json:<span class="st">&#39;{&quot;name&quot;:&quot;the shared inbox&quot;,&quot;metadata_profile_id&quot;:1}&#39;</span></span></code></pre></div>
<h2 data-number="9.13"
id="faspex-5-list-content-in-shared-folder-and-send-package-from-remote-source"><span
class="header-section-number">9.13</span> Faspex 5: List content in
Shared folder and send package from remote source</h2>
<div class="sourceCode" id="cb400"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 shared_folders list</span></code></pre></div>
<div class="sourceCode" id="cb401"><pre
class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>+----+----------+---------+-----+</span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a>| id | name     | node_id | ... |</span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>+----+----------+---------+-----+</span>
<span id="cb401-4"><a href="#cb401-4" aria-hidden="true" tabindex="-1"></a>| 3  | partages | 2       | ... |</span>
<span id="cb401-5"><a href="#cb401-5" aria-hidden="true" tabindex="-1"></a>+----+----------+---------+-----+</span></code></pre></div>
<div class="sourceCode" id="cb402"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 shared_folders br %name:partages /folder</span></code></pre></div>
<div class="sourceCode" id="cb403"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 packages send @json:<span class="st">&#39;{&quot;title&quot;:&quot;hello&quot;,&quot;recipients&quot;:[{&quot;name&quot;:&quot;_recipient_here_&quot;}]}&#39;</span> <span class="at">--shared-folder</span><span class="op">=</span>%name:partages /folder/file</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> The shared folder can be identified by its
numerical <code>id</code> or by name using percent selector:
<code>%&lt;field&gt;:&lt;value&gt;</code>.
e.g. <code>--shared-folder=3</code></p>
</blockquote>
<h2 data-number="9.14" id="faspex-5-receive-all-packages-cargo"><span
class="header-section-number">9.14</span> Faspex 5: receive all packages
(cargo)</h2>
<p>To receive all packages, only once, through persistency of already
received packages:</p>
<div class="sourceCode" id="cb404"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 packages receive ALL <span class="at">--once-only</span><span class="op">=</span>yes</span></code></pre></div>
<p>To initialize, and skip all current package so that next time
<code>ALL</code> is used, only newer packages are downloaded:</p>
<div class="sourceCode" id="cb405"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 packages receive INIT <span class="at">--once-only</span><span class="op">=</span>yes</span></code></pre></div>
<h2 data-number="9.15" id="faspex-5-faspex-4-style-postprocessing"><span
class="header-section-number">9.15</span> Faspex 5: Faspex 4-style
postprocessing</h2>
<p><code>ascli</code> provides command <code>postprocessing</code> in
plugin <code>faspex5</code> to emulate Faspex 4 postprocessing. It
implements Faspex 5 web hooks, and calls a local script with the same
environment as Faspex 4.</p>
<p>It is invoked like this:</p>
<div class="sourceCode" id="cb406"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex5 postprocessing @json:<span class="st">&#39;{&quot;url&quot;:&quot;http://localhost:8080/processing&quot;}&#39;</span></span></code></pre></div>
<p>The following parameters are supported:</p>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 7%" />
<col style="width: 21%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="header">
<th>parameter</th>
<th>type</th>
<th>default</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>url</td>
<td>string</td>
<td><a href="http://localhost:8080"
class="uri">http://localhost:8080</a></td>
<td>Defines the base url on which requests are listened</td>
</tr>
<tr class="even">
<td>certificate</td>
<td>hash</td>
<td>nil</td>
<td>used to define certificate if https is used</td>
</tr>
<tr class="odd">
<td>certificate.key</td>
<td>string</td>
<td>nil</td>
<td>path to private key file</td>
</tr>
<tr class="even">
<td>certificate.cert</td>
<td>string</td>
<td>nil</td>
<td>path to certificate</td>
</tr>
<tr class="odd">
<td>certificate.chain</td>
<td>string</td>
<td>nil</td>
<td>path to intermediary certificates</td>
</tr>
<tr class="even">
<td>processing</td>
<td>hash</td>
<td>nil</td>
<td>behavior of post processing</td>
</tr>
<tr class="odd">
<td>processing.script_folder</td>
<td>string</td>
<td>.</td>
<td>prefix added to script path</td>
</tr>
<tr class="even">
<td>processing.fail_on_error</td>
<td>bool</td>
<td>false</td>
<td>if true and process exit with non zero, then fail</td>
</tr>
<tr class="odd">
<td>processing.timeout_seconds</td>
<td>integer</td>
<td>60</td>
<td>processing script is killed if takes more time</td>
</tr>
</tbody>
</table>
<p>Parameter <code>url</code> defines:</p>
<ul>
<li>if http or https is used</li>
<li>the local port</li>
<li>the “domain”, i.e. main path of url</li>
</ul>
<p>When a request is received the following happens:</p>
<ul>
<li>the processor get the path of the url called</li>
<li>it removes the “domain</li>
<li>it prepends it with the value of <code>script_folder</code></li>
<li>it executes the script</li>
<li>upon success, a success code is returned</li>
</ul>
<p>In Faspex 5, configure like this:</p>
<p><code>Webhook endpoint URI</code> :
<code>http://localhost:8080/processing/script1.sh</code></p>
<p>Then, the postprocessing script executed will be
<code>script1.sh</code>.</p>
<p>Environment variables at set to the values provided by the web hook
which are the same as Faspex 4 postprocessing.</p>
<h1 data-number="10" id="plugin-faspex-ibm-aspera-faspex-v4"><span
class="header-section-number">10</span> <a id="faspex"></a>Plugin:
<code>faspex</code>: IBM Aspera Faspex v4</h1>
<p>Notes:</p>
<ul>
<li>The command <code>v4</code> requires the use of APIv4, refer to the
Faspex Admin manual on how to activate.</li>
<li>For full details on Faspex API, refer to: <a
href="https://developer.ibm.com/apis/catalog/?search=faspex">Reference
on Developer Site</a></li>
</ul>
<h2 data-number="10.1" id="listing-packages"><span
class="header-section-number">10.1</span> Listing Packages</h2>
<p>Command: <code>faspex package list</code></p>
<h3 data-number="10.1.1" id="option-box"><span
class="header-section-number">10.1.1</span> Option <code>box</code></h3>
<p>By default it looks in box <code>inbox</code>, but the following
boxes are also supported: <code>archive</code> and <code>sent</code>,
selected with option <code>box</code>.</p>
<h3 data-number="10.1.2" id="option-recipient"><span
class="header-section-number">10.1.2</span> Option
<code>recipient</code></h3>
<p>A user can receive a package because the recipient is:</p>
<ul>
<li>the user himself (default)</li>
<li>the user is member of a dropbox/workgroup: filter using option
<code>recipient</code> set with value
<code>*&lt;name of dropbox/workgroup&gt;</code></li>
</ul>
<h3 data-number="10.1.3" id="option-query"><span
class="header-section-number">10.1.3</span> Option
<code>query</code></h3>
<p>As inboxes may be large, it is possible to use the following query
parameters:</p>
<ul>
<li><code>count</code> : (native) number items in one API call
(default=0, equivalent to 10)</li>
<li><code>page</code> : (native) id of page in call (default=0)</li>
<li><code>startIndex</code> : (native) index of item to start,
default=0, oldest index=0</li>
<li><code>max</code> : maximum number of items</li>
<li><code>pmax</code> : maximum number of pages</li>
</ul>
<p>(SQL query is
<code>LIMIT &lt;startIndex&gt;, &lt;count&gt;</code>)</p>
<p>The API is listed in <a
href="https://developer.ibm.com/apis/catalog/?search=faspex">Faspex 4
API Reference</a> under “Services (API v.3)”.</p>
<p>If no parameter <code>max</code> or <code>pmax</code> is provided,
then all packages will be listed in the inbox, which result in paged API
calls (using parameter: <code>count</code> and <code>page</code>). By
default <code>count</code> is <code>0</code> (<code>10</code>), it can
be increased to issue less HTTP calls.</p>
<h3 data-number="10.1.4" id="example-list-packages-in-dropbox"><span
class="header-section-number">10.1.4</span> Example: list packages in
dropbox</h3>
<div class="sourceCode" id="cb407"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package list <span class="at">--box</span><span class="op">=</span>inbox <span class="at">--recipient</span><span class="op">=</span><span class="st">&#39;*my_dropbox&#39;</span> <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;max&quot;:20,&quot;pmax&quot;:2,&quot;count&quot;:20}&#39;</span></span></code></pre></div>
<p>List a maximum of 20 items grouped by pages of 20, with maximum 2
pages in received box (inbox) when received in dropbox
<code>*my_dropbox</code>.</p>
<h2 data-number="10.2" id="receiving-a-package"><span
class="header-section-number">10.2</span> Receiving a Package</h2>
<p>The command is <code>package recv</code>, possible methods are:</p>
<ul>
<li>provide a package id with option <code>id</code></li>
<li>provide a public link with option <code>link</code></li>
<li>provide a <code>faspe:</code> URI with option <code>link</code></li>
</ul>
<div class="sourceCode" id="cb408"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package recv 12345</span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package recv <span class="at">--link</span><span class="op">=</span>faspe://...</span></code></pre></div>
<p>If the package is in a specific
<strong>dropbox</strong>/<strong>workgroup</strong>, add option
<code>recipient</code> for both the <code>list</code> and
<code>recv</code> commands.</p>
<div class="sourceCode" id="cb409"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package list <span class="at">--recipient</span><span class="op">=</span><span class="st">&#39;*dropbox_name&#39;</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package recv 125 <span class="at">--recipient</span><span class="op">=</span><span class="st">&#39;*dropbox_name&#39;</span></span></code></pre></div>
<p>if <code>id</code> is set to <code>ALL</code>, then all packages are
downloaded, and if option <code>once_only</code>is used, then a
persistency file is created to keep track of already downloaded
packages.</p>
<h2 data-number="10.3" id="sending-a-package"><span
class="header-section-number">10.3</span> Sending a Package</h2>
<p>The command is <code>faspex package send</code>. Package information
(title, note, metadata, options) is provided in option
<code>delivery_info</code>. The contents of <code>delivery_info</code>
is directly the contents of the <code>send</code> v3 <a
href="https://developer.ibm.com/apis/catalog/aspera--aspera-faspex-client-sdk/API%20v.3:%20Send%20Packages">API
of Faspex 4</a>.</p>
<p>Example:</p>
<div class="sourceCode" id="cb410"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package send <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;my title&quot;,&quot;recipients&quot;:[&quot;someuser@example.com&quot;]}&#39;</span> <span class="at">--url</span><span class="op">=</span>https://faspex.corp.com/aspera/faspex <span class="at">--username</span><span class="op">=</span>foo <span class="at">--password</span><span class="op">=</span>bar /tmp/file1 /home/bar/file2</span></code></pre></div>
<p>If the recipient is a dropbox or workgroup: provide the name of the
dropbox or workgroup preceded with <code>*</code> in the
<code>recipients</code> field of the <code>delivery_info</code> option:
<code>"recipients":["*MyDropboxName"]</code></p>
<p>Additional optional parameters in <code>delivery_info</code>:</p>
<ul>
<li>Package Note: : <code>"note":"note this and that"</code></li>
<li>Package Metadata:
<code>"metadata":{"Meta1":"Val1","Meta2":"Val2"}</code></li>
</ul>
<p>It is possible to send from a remote source using option
<code>remote_source</code>, providing either the numerical id, or the
name of the remote source using percent selector:
<code>%name:&lt;name&gt;</code>.</p>
<p>Remote source can be browsed if option <code>storage</code> is
provided. <code>storage</code> is an extended value of type
<code>Hash</code>. The key is the storage name, as listed in
<code>source list</code> command. The value is a Hash with the following
keys:</p>
<ul>
<li><code>node</code> is a Hash with keys: url, username, password</li>
<li><code>path</code> is the subpath inside the node, as configured in
Faspex</li>
</ul>
<h2 data-number="10.4" id="email-notification-on-transfer"><span
class="header-section-number">10.4</span> Email notification on
transfer</h2>
<p>Like for any transfer, a notification can be sent by email using
parameters: <code>notif_to</code> and <code>notif_template</code> .</p>
<p>Example:</p>
<div class="sourceCode" id="cb411"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex package send <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;test pkg 1&quot;,&quot;recipients&quot;:[&quot;aspera.user1@gmail.com&quot;]}&#39;</span> ~/Documents/Samples/200KB.1 <span class="at">--notif-to</span><span class="op">=</span>aspera.user1@gmail.com <span class="at">--notif-template</span><span class="op">=</span>@ruby:<span class="st">&#39;%Q{From: &lt;%=from_name%&gt; &lt;&lt;%=from_email%&gt;&gt;\nTo: &lt;&lt;%=to%&gt;&gt;\nSubject: Package sent: &lt;%=ts[&quot;tags&quot;][&quot;aspera&quot;][&quot;faspex&quot;][&quot;metadata&quot;][&quot;_pkg_name&quot;]%&gt; files received\n\nTo user: &lt;%=ts[&quot;tags&quot;][&quot;aspera&quot;][&quot;faspex&quot;][&quot;recipients&quot;].first[&quot;email&quot;]%&gt;}&#39;</span></span></code></pre></div>
<p>In this example the notification template is directly provided on
command line. Package information placed in the message are directly
taken from the tags in transfer spec. The template can be placed in a
file using modifier: <code>@file:</code></p>
<h2 data-number="10.5" id="operation-on-dropboxes"><span
class="header-section-number">10.5</span> Operation on dropboxes</h2>
<p>Example:</p>
<div class="sourceCode" id="cb412"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex v4 dropbox create @json:<span class="st">&#39;{&quot;dropbox&quot;:{&quot;e_wg_name&quot;:&quot;test1&quot;,&quot;e_wg_desc&quot;:&quot;test1&quot;}}&#39;</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex v4 dropbox list</span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex v4 dropbox delete 36</span></code></pre></div>
<h2 data-number="10.6" id="remote-sources"><span
class="header-section-number">10.6</span> Remote sources</h2>
<p>Faspex lacks an API to list the contents of a remote source
(available in web UI). To workaround this, the node API is used, for
this it is required to add a section “:storage” that links a storage
name to a node config and sub path.</p>
<p>Example:</p>
<div class="sourceCode" id="cb413"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_faspex_conf</span><span class="kw">:</span></span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">url</span><span class="kw">:</span><span class="at"> https://10.25.0.3/aspera/faspex</span></span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">username</span><span class="kw">:</span><span class="at"> admin</span></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> MyUserPassword</span></span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">storage</span><span class="kw">:</span></span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">my_storage</span><span class="kw">:</span></span>
<span id="cb413-7"><a href="#cb413-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">node</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;@preset:my_faspex_node&quot;</span></span>
<span id="cb413-8"><a href="#cb413-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /mydir</span></span>
<span id="cb413-9"><a href="#cb413-9" aria-hidden="true" tabindex="-1"></a><span class="fu">my_faspex_node</span><span class="kw">:</span></span>
<span id="cb413-10"><a href="#cb413-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">url</span><span class="kw">:</span><span class="at"> https://10.25.0.3:9092</span></span>
<span id="cb413-11"><a href="#cb413-11" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">username</span><span class="kw">:</span><span class="at"> node_faspex</span></span>
<span id="cb413-12"><a href="#cb413-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">password</span><span class="kw">:</span><span class="at"> MyNodePassword</span></span></code></pre></div>
<p>In this example, a faspex storage named <code>my_storage</code>
exists in Faspex, and is located under the docroot in
<code>/mydir</code> (this must be the same as configured in Faspex). The
node configuration name is <code>my_faspex_node</code> here.</p>
<blockquote>
<p><strong>Note:</strong> the v4 API provides an API for nodes and
shares.</p>
</blockquote>
<h2 data-number="10.7" id="automated-package-download-cargo"><span
class="header-section-number">10.7</span> Automated package download
(cargo)</h2>
<p>It is possible to tell <code>ascli</code> to download newly received
packages, much like the official cargo client, or drive. Refer to the <a
href="#aoccargo">same section</a> in the Aspera on Cloud plugin:</p>
<div class="sourceCode" id="cb414"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> faspex packages recv ALL <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--lock-port</span><span class="op">=</span>12345</span></code></pre></div>
<h2 data-number="10.8" id="faspex-4-sample-commands"><span
class="header-section-number">10.8</span> Faspex 4 sample commands</h2>
<div class="sourceCode" id="cb415"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> address_book</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> dropbox list <span class="at">--recipient</span><span class="op">=</span><span class="st">&quot;*my_faspex_dbx&quot;</span></span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> health</span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> login_methods</span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> me</span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package list <span class="at">--box</span><span class="op">=</span>sent <span class="at">--fields</span><span class="op">=</span>package_id <span class="at">--format</span><span class="op">=</span>csv <span class="at">--display</span><span class="op">=</span>data <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;max&quot;:1}&#39;</span></span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package list <span class="at">--fields</span><span class="op">=</span>package_id <span class="at">--format</span><span class="op">=</span>csv <span class="at">--display</span><span class="op">=</span>data <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;max&quot;:1}&#39;</span></span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package list <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;max&quot;:5}&#39;</span></span>
<span id="cb415-9"><a href="#cb415-9" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package list <span class="at">--recipient</span><span class="op">=</span><span class="st">&quot;*my_faspex_dbx&quot;</span> <span class="at">--format</span><span class="op">=</span>csv <span class="at">--fields</span><span class="op">=</span>package_id <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;max&quot;:1}&#39;</span></span>
<span id="cb415-10"><a href="#cb415-10" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package list <span class="at">--recipient</span><span class="op">=</span><span class="st">&quot;*my_faspex_wkg&quot;</span> <span class="at">--format</span><span class="op">=</span>csv <span class="at">--fields</span><span class="op">=</span>package_id <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;max&quot;:1}&#39;</span></span>
<span id="cb415-11"><a href="#cb415-11" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package recv <span class="st">&quot;my_package_id&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb415-12"><a href="#cb415-12" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package recv <span class="st">&quot;my_package_id&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--box</span><span class="op">=</span>sent</span>
<span id="cb415-13"><a href="#cb415-13" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package recv <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--link</span><span class="op">=</span>https://app.example.com/recv_from_user_path</span>
<span id="cb415-14"><a href="#cb415-14" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package recv ALL <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--query</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;max&quot;:10}&#39;</span></span>
<span id="cb415-15"><a href="#cb415-15" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package recv my_pkgid <span class="at">--recipient</span><span class="op">=</span><span class="st">&quot;*my_faspex_dbx&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb415-16"><a href="#cb415-16" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package recv my_pkgid <span class="at">--recipient</span><span class="op">=</span><span class="st">&quot;*my_faspex_wkg&quot;</span> <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb415-17"><a href="#cb415-17" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package send <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;*my_faspex_dbx&quot;]}&#39;</span> testfile.bin</span>
<span id="cb415-18"><a href="#cb415-18" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package send <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;*my_faspex_wkg&quot;]}&#39;</span> testfile.bin</span>
<span id="cb415-19"><a href="#cb415-19" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package send <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;Important files delivery&quot;,&quot;recipients&quot;:[&quot;my_email_internal&quot;,&quot;my_username&quot;]}&#39;</span> testfile.bin</span>
<span id="cb415-20"><a href="#cb415-20" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package send <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;TIMESTAMP package remote&quot;,&quot;recipients&quot;:[&quot;my_email_internal&quot;]}&#39;</span> <span class="at">--remote_source</span><span class="op">=</span>%name:my_faspex_src sample_source.txt</span>
<span id="cb415-21"><a href="#cb415-21" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package send <span class="at">--link</span><span class="op">=</span>https://app.example.com/send_to_dropbox_path <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;Important files delivery&quot;}&#39;</span> testfile.bin</span>
<span id="cb415-22"><a href="#cb415-22" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> package send <span class="at">--link</span><span class="op">=</span>https://app.example.com/send_to_user_path <span class="at">--delivery-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;title&quot;:&quot;Important files delivery&quot;}&#39;</span> testfile.bin</span>
<span id="cb415-23"><a href="#cb415-23" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> source info %name:my_faspex_src <span class="at">--storage</span><span class="op">=</span>@preset:faspex4_storage</span>
<span id="cb415-24"><a href="#cb415-24" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> source list</span>
<span id="cb415-25"><a href="#cb415-25" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> source node %name:my_faspex_src br / <span class="at">--storage</span><span class="op">=</span>@preset:faspex4_storage</span>
<span id="cb415-26"><a href="#cb415-26" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> v4 dmembership list</span>
<span id="cb415-27"><a href="#cb415-27" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> v4 dropbox list</span>
<span id="cb415-28"><a href="#cb415-28" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> v4 metadata_profile list</span>
<span id="cb415-29"><a href="#cb415-29" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> v4 user list</span>
<span id="cb415-30"><a href="#cb415-30" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> v4 wmembership list</span>
<span id="cb415-31"><a href="#cb415-31" aria-hidden="true" tabindex="-1"></a><span class="ex">faspex</span> v4 workgroup list</span></code></pre></div>
<h1 data-number="11" id="plugin-shares-ibm-aspera-shares-v1"><span
class="header-section-number">11</span> <a id="shares"></a>Plugin:
<code>shares</code>: IBM Aspera Shares v1</h1>
<p>Aspera Shares supports the “node API” for the file transfer part.</p>
<h2 data-number="11.1" id="shares-1-sample-commands"><span
class="header-section-number">11.1</span> Shares 1 sample commands</h2>
<div class="sourceCode" id="cb416"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin group list</span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin node list</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin share list <span class="at">--fields</span><span class="op">=</span>DEF,-status,status_message</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin share user_permissions 1 list</span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user add <span class="at">--type</span><span class="op">=</span>ldap the_name</span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user app_authorizations 1 modify @json:<span class="st">&#39;{&quot;app_login&quot;:true}&#39;</span></span>
<span id="cb416-7"><a href="#cb416-7" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user app_authorizations 1 show</span>
<span id="cb416-8"><a href="#cb416-8" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user import <span class="at">--type</span><span class="op">=</span>saml @json:<span class="st">&#39;{&quot;id&quot;:&quot;the_id&quot;,&quot;name_id&quot;:&quot;the_name&quot;}&#39;</span></span>
<span id="cb416-9"><a href="#cb416-9" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user list</span>
<span id="cb416-10"><a href="#cb416-10" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user list <span class="at">--type</span><span class="op">=</span>local</span>
<span id="cb416-11"><a href="#cb416-11" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user share_permissions 1 list</span>
<span id="cb416-12"><a href="#cb416-12" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> admin user share_permissions 1 show 1</span>
<span id="cb416-13"><a href="#cb416-13" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> files browse /</span>
<span id="cb416-14"><a href="#cb416-14" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> files delete my_shares_upload/testfile.bin</span>
<span id="cb416-15"><a href="#cb416-15" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> files download <span class="at">--to-folder</span><span class="op">=</span>. my_shares_upload/testfile.bin</span>
<span id="cb416-16"><a href="#cb416-16" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> files download <span class="at">--to-folder</span><span class="op">=</span>. my_shares_upload/testfile.bin <span class="at">--transfer</span><span class="op">=</span>httpgw <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;url&quot;:&quot;https://my_http_gw_fqdn_port/aspera/http-gwy&quot;}&#39;</span></span>
<span id="cb416-17"><a href="#cb416-17" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> files upload <span class="at">--to-folder</span><span class="op">=</span>my_shares_upload <span class="st">&#39;faux:///testfile?1m&#39;</span> <span class="at">--transfer</span><span class="op">=</span>httpgw <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;url&quot;:&quot;https://my_http_gw_fqdn_port/aspera/http-gwy&quot;,&quot;synchronous&quot;:true,&quot;api_version&quot;:&quot;v1&quot;,&quot;upload_chunk_size&quot;:100000}&#39;</span></span>
<span id="cb416-18"><a href="#cb416-18" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> files upload <span class="at">--to-folder</span><span class="op">=</span>my_shares_upload testfile.bin</span>
<span id="cb416-19"><a href="#cb416-19" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> files upload <span class="at">--to-folder</span><span class="op">=</span>my_shares_upload testfile.bin <span class="at">--transfer</span><span class="op">=</span>httpgw <span class="at">--transfer-info</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;url&quot;:&quot;https://my_http_gw_fqdn_port/aspera/http-gwy&quot;}&#39;</span></span>
<span id="cb416-20"><a href="#cb416-20" aria-hidden="true" tabindex="-1"></a><span class="ex">shares</span> health</span></code></pre></div>
<h1 data-number="12" id="plugin-console-ibm-aspera-console"><span
class="header-section-number">12</span> <a id="console"></a>Plugin:
<code>console</code>: IBM Aspera Console</h1>
<h2 data-number="12.1" id="console-sample-commands"><span
class="header-section-number">12.1</span> Console sample commands</h2>
<div class="sourceCode" id="cb417"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="ex">console</span> health</span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="ex">console</span> transfer current list</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a><span class="ex">console</span> transfer smart list</span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a><span class="ex">console</span> transfer smart sub my_console_smart_id @json:<span class="st">&#39;{&quot;source&quot;:{&quot;paths&quot;:[&quot;my_console_smart_file&quot;]},&quot;source_type&quot;:&quot;user_selected&quot;}&#39;</span></span></code></pre></div>
<h1 data-number="13"
id="plugin-orchestratoribm-aspera-orchestrator"><span
class="header-section-number">13</span> <a id="orchestrator"></a>Plugin:
<code>orchestrator</code>:IBM Aspera Orchestrator</h1>
<h2 data-number="13.1" id="orchestrator-sample-commands"><span
class="header-section-number">13.1</span> Orchestrator sample
commands</h2>
<div class="sourceCode" id="cb418"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> health</span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> info</span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> plugins</span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> processes</span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow details my_orch_workflow_id</span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow export my_orch_workflow_id</span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow inputs my_orch_workflow_id</span>
<span id="cb418-8"><a href="#cb418-8" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow list</span>
<span id="cb418-9"><a href="#cb418-9" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow start my_orch_workflow_id @json:<span class="st">&#39;{&quot;Param&quot;:&quot;world !&quot;}&#39;</span></span>
<span id="cb418-10"><a href="#cb418-10" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow start my_orch_workflow_id @json:<span class="st">&#39;{&quot;Param&quot;:&quot;world !&quot;}&#39;</span> <span class="at">--result</span><span class="op">=</span>ResultStep:Complete_status_message</span>
<span id="cb418-11"><a href="#cb418-11" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow status ALL</span>
<span id="cb418-12"><a href="#cb418-12" aria-hidden="true" tabindex="-1"></a><span class="ex">orchestrator</span> workflow status my_orch_workflow_id</span></code></pre></div>
<h1 data-number="14" id="plugin-cos-ibm-cloud-object-storage"><span
class="header-section-number">14</span> <a id="cos"></a>Plugin:
<code>cos</code>: IBM Cloud Object Storage</h1>
<p>The IBM Cloud Object Storage provides the possibility to execute
transfers using FASP. It uses the same transfer service as Aspera on
Cloud, called Aspera Transfer Service (ATS). Available ATS regions: <a
href="https://status.aspera.io">https://status.aspera.io</a></p>
<p>There are two possibilities to provide credentials. If you already
have the endpoint, apikey and CRN, use the first method. If you don’t
have credentials but have access to the IBM Cloud console, then use the
second method.</p>
<h2 data-number="14.1"
id="using-endpoint-apikey-and-resource-instance-id-crn"><span
class="header-section-number">14.1</span> Using endpoint, apikey and
Resource Instance ID (CRN)</h2>
<p>If you have those parameters already, then following options shall be
provided:</p>
<ul>
<li><code>bucket</code> bucket name</li>
<li><code>endpoint</code> storage endpoint url,
e.g. <code>https://s3.hkg02.cloud-object-storage.appdomain.cloud</code></li>
<li><code>apikey</code> API Key</li>
<li><code>crn</code> resource instance id</li>
</ul>
<p>For example, let us create a default configuration:</p>
<div class="sourceCode" id="cb419"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset update mycos <span class="at">--bucket</span><span class="op">=</span>mybucket <span class="at">--endpoint</span><span class="op">=</span>https://s3.us-east.cloud-object-storage.appdomain.cloud <span class="at">--apikey</span><span class="op">=</span>abcdefgh <span class="at">--crn</span><span class="op">=</span>crn:v1:bluemix:public:iam-identity::a/xxxxxxx</span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset set default cos mycos</span></code></pre></div>
<p>Then, jump to the transfer example.</p>
<h2 data-number="14.2" id="using-service-credential-file"><span
class="header-section-number">14.2</span> Using service credential
file</h2>
<p>If you are the COS administrator and don’t have yet the credential:
Service credentials are directly created using the IBM cloud Console
(web UI). Navigate to:</p>
<ul>
<li>→ Navigation Menu</li>
<li>→ <a href="https://cloud.ibm.com/resources">Resource List</a></li>
<li>→ <a href="https://cloud.ibm.com/objectstorage">Storage</a></li>
<li>→ Select your storage instance</li>
<li>→ Service Credentials</li>
<li>→ New credentials (Leave default role: Writer, no special
options)</li>
<li>→ Copy to clipboard</li>
</ul>
<p>Then save the copied value to a file, e.g. :
<code>$HOME/cos_service_creds.json</code></p>
<p>or using the IBM Cloud CLI:</p>
<div class="sourceCode" id="cb420"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ibmcloud</span> resource service-keys</span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ibmcloud</span> resource service-key _service_key_name_here_ <span class="at">--output</span> JSON<span class="kw">|</span><span class="ex">jq</span> <span class="st">&#39;.[0].credentials&#39;</span><span class="op">&gt;</span><span class="va">$HOME</span>/service_creds.json</span></code></pre></div>
<p>(if you don’t have <code>jq</code> installed, extract the structure
as follows)</p>
<p>It consists in the following structure:</p>
<div class="sourceCode" id="cb421"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;apikey&quot;</span><span class="fu">:</span> <span class="st">&quot;my_api_key_here&quot;</span><span class="fu">,</span></span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;cos_hmac_keys&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;access_key_id&quot;</span><span class="fu">:</span> <span class="st">&quot;my_access_key_here&quot;</span><span class="fu">,</span></span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;secret_access_key&quot;</span><span class="fu">:</span> <span class="st">&quot;my_secret_here&quot;</span></span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;endpoints&quot;</span><span class="fu">:</span> <span class="st">&quot;https://control.cloud-object-storage.cloud.ibm.com/v2/endpoints&quot;</span><span class="fu">,</span></span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;iam_apikey_description&quot;</span><span class="fu">:</span> <span class="st">&quot;my_description_here&quot;</span><span class="fu">,</span></span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;iam_apikey_name&quot;</span><span class="fu">:</span> <span class="st">&quot;my_key_name_here&quot;</span><span class="fu">,</span></span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;iam_role_crn&quot;</span><span class="fu">:</span> <span class="st">&quot;crn:v1:bluemix:public:iam::::serviceRole:Writer&quot;</span><span class="fu">,</span></span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;iam_serviceid_crn&quot;</span><span class="fu">:</span> <span class="st">&quot;crn:v1:bluemix:public:iam-identity::a/xxxxxxx.....&quot;</span><span class="fu">,</span></span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;resource_instance_id&quot;</span><span class="fu">:</span> <span class="st">&quot;crn:v1:bluemix:public:cloud-object-storage:global:a/xxxxxxx.....&quot;</span></span>
<span id="cb421-13"><a href="#cb421-13" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The field <code>resource_instance_id</code> is for option
<code>crn</code></p>
<p>The field <code>apikey</code> is for option <code>apikey</code></p>
<p>(If needed: endpoints for regions can be found by querying the
<code>endpoints</code> URL.)</p>
<p>The required options for this method are:</p>
<ul>
<li><code>bucket</code> bucket name</li>
<li><code>region</code> bucket region, e.g. eu-de</li>
<li><code>service_credentials</code> see below</li>
</ul>
<p>For example, let us create a default configuration:</p>
<div class="sourceCode" id="cb422"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset update mycos <span class="at">--bucket</span><span class="op">=</span>laurent <span class="at">--service-credentials</span><span class="op">=</span>@val:@json:@file:~/service_creds.json <span class="at">--region</span><span class="op">=</span>us-south</span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf preset set default cos mycos</span></code></pre></div>
<h2 data-number="14.3" id="operations-transfers"><span
class="header-section-number">14.3</span> Operations, transfers</h2>
<p>Let’s assume you created a default configuration from once of the two
previous steps (else specify the access options on command lines).</p>
<p>A subset of <code>node</code> plugin operations are supported,
basically node API:</p>
<div class="sourceCode" id="cb423"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> cos node info</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> cos node upload <span class="st">&#39;faux:///sample1G?1g&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> we generate a dummy file <code>sample1G</code>
of size 2GB using the <code>faux</code> PVCL (man <code>ascp</code> and
section above), but you can of course send a real file by specifying a
real file instead.</p>
</blockquote>
<h2 data-number="14.4" id="cos-sample-commands"><span
class="header-section-number">14.4</span> COS sample commands</h2>
<div class="sourceCode" id="cb424"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cos</span> <span class="at">--bucket</span><span class="op">=</span>my_icos_bucket_name <span class="at">--endpoint</span><span class="op">=</span>my_icos_bucket_endpoint <span class="at">--apikey</span><span class="op">=</span>my_icos_bucket_apikey <span class="at">--crn</span><span class="op">=</span>my_icos_resource_instance_id node info</span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cos</span> <span class="at">--bucket</span><span class="op">=</span>my_icos_bucket_name <span class="at">--region</span><span class="op">=</span>my_icos_bucket_region <span class="at">--service-credentials</span><span class="op">=</span>@json:@file:service_creds.json node info</span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a><span class="ex">cos</span> node access_key show self</span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a><span class="ex">cos</span> node download testfile.bin <span class="at">--to-folder</span><span class="op">=</span>.</span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cos</span> node info</span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a><span class="ex">cos</span> node upload testfile.bin</span></code></pre></div>
<h1 data-number="15" id="ibm-aspera-sync"><span
class="header-section-number">15</span> <a id="async"></a>IBM Aspera
Sync</h1>
<p>An interface for the <code>async</code> utility is provided in the
following plugins:</p>
<ul>
<li>server sync</li>
<li>node sync</li>
<li>aoc files sync (uses node)</li>
<li>shares files sync (uses node)</li>
</ul>
<p>The main advantage over the <code>async</code> command line when
using <code>server</code> is the possibility to use a configuration
file, using standard options of <code>ascli</code>.</p>
<p>In this case, some of the <code>sync</code> parameters are filled by
the related plugin using transfer spec parameters (e.g. including
token).</p>
<blockquote>
<p><strong>Note:</strong> All <code>sync</code> commands require an
<code>async</code> enabled license and availability of the
<code>async</code> executable (and <code>asyncadmin</code>).</p>
</blockquote>
<p>Two JSON syntax are supported for option <code>sync_info</code>.</p>
<h2 data-number="15.1" id="async-json-api-format"><span
class="header-section-number">15.1</span> async JSON: API format</h2>
<p>It is the same payload as specified on the option <code>--conf</code>
of <code>async</code> or in node API <code>/asyncs</code>. This is the
preferred syntax and allows a single session definition. But there is no
progress output nor error messages.</p>
<p>Documentation on Async node API can be found on <a
href="https://developer.ibm.com/apis/catalog?search=%22aspera%20sync%20api%22">IBM
Developer Portal</a>.</p>
<h2 data-number="15.2" id="async-json-options-mapping"><span
class="header-section-number">15.2</span> async JSON: options
mapping</h2>
<p><code>ascli</code> defines a JSON equivalent to regular
<code>async</code>options. It is based on a JSON representation of
<code>async</code> command line options. It allows definition of
multiple sync sessions in a single command, although usually only one
sync session is defined.</p>
<h1 data-number="16" id="plugin-preview-preview-generator-for-aoc"><span
class="header-section-number">16</span> <a id="preview"></a>Plugin:
<code>preview</code>: Preview generator for AoC</h1>
<p>The <code>preview</code> generates thumbnails (office, images, video)
and video previews on storage for use primarily in the Aspera on Cloud
application. It uses the <strong>node API</strong> of Aspera HSTS and
requires use of Access Keys and it’s <strong>storage root</strong>.
Several parameters can be used to tune several aspects:</p>
<ul>
<li>Methods for detection of new files needing generation</li>
<li>Methods for generation of video preview</li>
<li>Parameters for video handling</li>
</ul>
<h2 data-number="16.1" id="aspera-server-configuration"><span
class="header-section-number">16.1</span> Aspera Server
configuration</h2>
<p>Specify the previews folder as shown in:</p>
<p><a
href="https://ibmaspera.com/help/admin/organization/installing_the_preview_maker"
class="uri">https://ibmaspera.com/help/admin/organization/installing_the_preview_maker</a></p>
<p>By default, the <code>preview</code> plugin expects previews to be
generated in a folder named <code>previews</code> located in the storage
root. On the transfer server execute:</p>
<div class="sourceCode" id="cb425"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="va">PATH</span><span class="op">=</span>/opt/aspera/bin:<span class="va">$PATH</span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="ex">asconfigurator</span> <span class="at">-x</span> <span class="st">&quot;server;preview_dir,previews&quot;</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a><span class="ex">asnodeadmin</span> <span class="at">--reload</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> the configuration <code>preview_dir</code> is
<em>relative</em> to the storage root, no need leading or trailing
<code>/</code>. In general just set the value to
<code>previews</code></p>
</blockquote>
<p>If another folder is configured on the HSTS, then specify it to
<code>ascli</code> using the option <code>previews_folder</code>.</p>
<p>The HSTS node API limits any preview file to a parameter:
<code>max_request_file_create_size_kb</code> (1 KB is 1024 bytes). This
size is internally capped to <code>1&lt;&lt;24</code> Bytes (16777216) ,
i.e. 16384 KBytes.</p>
<p>To change this parameter in <code>aspera.conf</code>, use
<code>asconfigurator</code>. To display the value, use
<code>asuserdata</code>:</p>
<div class="sourceCode" id="cb426"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="ex">asuserdata</span> <span class="at">-a</span> <span class="kw">|</span> <span class="fu">grep</span> max_request_file_create_size_kb</span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>  <span class="ex">max_request_file_create_size_kb:</span> <span class="st">&quot;1024&quot;</span></span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-5"><a href="#cb426-5" aria-hidden="true" tabindex="-1"></a><span class="ex">asconfigurator</span> <span class="at">-x</span> <span class="st">&quot;server; max_request_file_create_size_kb,16384&quot;</span></span></code></pre></div>
<p>If you use a value different than 16777216, then specify it using
option <code>max_size</code>.</p>
<blockquote>
<p><strong>Note:</strong> the HSTS parameter
(<code>max_request_file_create_size_kb</code>) is in
<strong>kiloBytes</strong> while the generator parameter is in
<strong>Bytes</strong> (factor of 1024).</p>
</blockquote>
<h2 data-number="16.2" id="external-tools-linux"><span
class="header-section-number">16.2</span> <a id="prev_ext"></a>External
tools: Linux</h2>
<p><code>ascli</code> requires the following external tools available in
the <code>PATH</code>:</p>
<ul>
<li>ImageMagick : <code>convert</code> <code>composite</code></li>
<li>OptiPNG : <code>optipng</code></li>
<li>FFmpeg : <code>ffmpeg</code> <code>ffprobe</code></li>
<li>Libreoffice : <code>libreoffice</code></li>
</ul>
<p>Here shown on Redhat/CentOS.</p>
<p>Other OSes should work as well, but are note tested.</p>
<p>To check if all tools are found properly, execute:</p>
<div class="sourceCode" id="cb427"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> preview check</span></code></pre></div>
<h3 data-number="16.2.1" id="image-imagemagick-and-optipng"><span
class="header-section-number">16.2.1</span> Image: ImageMagick and
optipng</h3>
<div class="sourceCode" id="cb428"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> install <span class="at">-y</span> ImageMagick optipng</span></code></pre></div>
<p>You may also install <code>ghostscript</code> which adds fonts to
ImageMagick. Available fonts, used to generate png for text, can be
listed with <code>magick identify -list font</code>. Prefer ImageMagick
version &gt;=7.</p>
<p>More info on ImageMagick at <a href="https://imagemagick.org/"
class="uri">https://imagemagick.org/</a></p>
<h3 data-number="16.2.2" id="video-ffmpeg"><span
class="header-section-number">16.2.2</span> Video: FFmpeg</h3>
<p>The easiest method is to download and install the latest released
version of ffmpeg with static libraries from <a
href="https://johnvansickle.com/ffmpeg/">https://johnvansickle.com/ffmpeg/</a></p>
<div class="sourceCode" id="cb429"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> https://johnvansickle.com/ffmpeg/releases/ffmpeg-release-amd64-static.tar.xz<span class="kw">|(</span><span class="fu">mkdir</span> <span class="at">-p</span> /opt <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> /opt <span class="kw">&amp;&amp;</span> <span class="fu">rm</span> <span class="at">-f</span> ffmpeg /usr/bin/<span class="dt">{ffmpeg</span><span class="op">,</span><span class="dt">ffprobe}</span> <span class="kw">&amp;&amp;</span> <span class="fu">rm</span> <span class="at">-fr</span> ffmpeg-<span class="pp">*</span>-amd64-static <span class="kw">&amp;&amp;</span> <span class="fu">tar</span> xJvf <span class="at">-</span> <span class="kw">&amp;&amp;</span> <span class="fu">ln</span> <span class="at">-s</span> ffmpeg-<span class="pp">*</span> ffmpeg <span class="kw">&amp;&amp;</span> <span class="fu">ln</span> <span class="at">-s</span> /opt/ffmpeg/<span class="dt">{ffmpeg</span><span class="op">,</span><span class="dt">ffprobe}</span> /usr/bin<span class="kw">)</span></span></code></pre></div>
<h3 data-number="16.2.3" id="office-unoconv-and-libreoffice"><span
class="header-section-number">16.2.3</span> Office: Unoconv and
Libreoffice</h3>
<p>If you don’t want to have preview for office documents or if it is
too complex you can skip office document preview generation by using
option: <code>--skip-types=office</code></p>
<p>The generation of preview in based on the use of <code>unoconv</code>
and <code>libreoffice</code></p>
<ul>
<li>CentOS 8</li>
</ul>
<div class="sourceCode" id="cb430"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> install unoconv</span></code></pre></div>
<ul>
<li>Amazon Linux</li>
</ul>
<div class="sourceCode" id="cb431"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="ex">amazon-linux-extras</span> enable libreoffice</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a><span class="ex">yum</span> clean metadata</span>
<span id="cb431-3"><a href="#cb431-3" aria-hidden="true" tabindex="-1"></a><span class="ex">yum</span> install libreoffice-core libreoffice-calc libreoffice-opensymbol-fonts libreoffice-ure libreoffice-writer libreoffice-pyuno libreoffice-impress</span>
<span id="cb431-4"><a href="#cb431-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://raw.githubusercontent.com/unoconv/unoconv/master/unoconv</span>
<span id="cb431-5"><a href="#cb431-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> unoconv /usr/bin</span>
<span id="cb431-6"><a href="#cb431-6" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> a+x /usr/bin/unoconv</span></code></pre></div>
<h2 data-number="16.3" id="configuration"><span
class="header-section-number">16.3</span> Configuration</h2>
<p>The preview generator should be executed as a non-user. When using
object storage, any user can be used, but when using local storage it is
usually better to use the user <code>xfer</code>, as uploaded files are
under this identity: this ensures proper access rights. (we will assume
this)</p>
<p>Like any <code>ascli</code> commands, parameters can be passed on
command line or using a configuration <a href="#lprt">option preset</a>.
The configuration file must be created with the same user used to run so
that it is properly used on runtime.</p>
<p>The <code>xfer</code> user has a special protected shell:
<code>aspshell</code>, so in order to update the configuration, and when
changing identity, specify an alternate shell. E.g.:</p>
<div class="sourceCode" id="cb432"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">su</span> <span class="at">-s</span> /bin/bash <span class="at">-</span> xfer</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update mypreviewconf <span class="at">--url</span><span class="op">=</span>https://localhost:9092 <span class="at">--username</span><span class="op">=</span>my_access_key <span class="at">--password</span><span class="op">=</span>my_secret <span class="at">--skip-types</span><span class="op">=</span>office <span class="at">--lock-port</span><span class="op">=</span>12346</span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default preview mypreviewconf</span></code></pre></div>
<p>Here we assume that Office file generation is disabled, else remove
this option. <code>lock_port</code> prevents concurrent execution of
generation when using a scheduler.</p>
<p>One can check if the access key is well configured using:</p>
<div class="sourceCode" id="cb433"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> <span class="at">-Ppreviewconf</span> node browse /</span></code></pre></div>
<p>This shall list the contents of the storage root of the access
key.</p>
<h2 data-number="16.4" id="options-for-generated-files"><span
class="header-section-number">16.4</span> Options for generated
files</h2>
<p>When generating preview files, some options are provided by default.
Some values for the options can be modified on command line. For video
preview, the whole set of options can be overridden with option
<code>reencode_ffmpeg</code>: it is a Hash with two keys:
<code>in</code> and <code>out</code>, each is an array of strings with
the native options to <code>ffmpeg</code>.</p>
<h2 data-number="16.5" id="execution"><span
class="header-section-number">16.5</span> Execution</h2>
<p><code>ascli</code> intentionally supports only a <strong>one
shot</strong> mode (no infinite loop) in order to avoid having a hanging
process or using too many resources (calling REST api too quickly during
the scan or event method). It needs to be run on a regular basis to
create or update preview files. For that use your best reliable
scheduler, see <a href="#scheduler">Scheduler</a>.</p>
<p>Typically, for <strong>Access key</strong> access, the
system/transfer is <code>xfer</code>. So, in order to be consistent have
generate the appropriate access rights, the generation process should be
run as user <code>xfer</code>.</p>
<p>Lets do a one shot test, using the configuration previously
created:</p>
<div class="sourceCode" id="cb434"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">su</span> <span class="at">-s</span> /bin/bash <span class="at">-</span> xfer</span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> preview scan <span class="at">--overwrite</span><span class="op">=</span>always</span></code></pre></div>
<p>When the preview generator is first executed it will create a file:
<code>.aspera_access_key</code> in the previews folder which contains
the access key used. On subsequent run it reads this file and check that
previews are generated for the same access key, else it fails. This is
to prevent clash of different access keys using the same root.</p>
<h2 data-number="16.6"
id="configuration-for-execution-in-scheduler"><span
class="header-section-number">16.6</span> Configuration for Execution in
scheduler</h2>
<p>Details are provided in section <a
href="#scheduler">Scheduler</a>.</p>
<p>Shorter commands can be specified if a configuration preset was
created as shown previously.</p>
<p>For example the timeout value can be differentiated depending on the
option: event versus scan:</p>
<div class="sourceCode" id="cb435"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="cf">case</span> <span class="st">&quot;</span><span class="va">$*</span><span class="st">&quot;</span> <span class="kw">in</span> <span class="pp">*</span><span class="ss">trev</span><span class="pp">*</span><span class="kw">)</span> <span class="va">tmout</span><span class="op">=</span>10m <span class="cf">;;</span> <span class="pp">*</span><span class="kw">)</span> <span class="va">tmout</span><span class="op">=</span>30m <span class="cf">;;</span> <span class="cf">esac</span></span></code></pre></div>
<h2 data-number="16.7"
id="candidate-detection-for-creation-or-update-or-deletion"><span
class="header-section-number">16.7</span> Candidate detection for
creation or update (or deletion)</h2>
<p><code>ascli</code> generates preview files using those commands:</p>
<ul>
<li><code>trevents</code> : only recently uploaded files will be tested
(transfer events)</li>
<li><code>events</code> : only recently uploaded files will be tested
(file events: not working)</li>
<li><code>scan</code> : recursively scan all files under the access
key's “storage root”</li>
<li><code>test</code> : test using a local file</li>
</ul>
<p>Once candidate are selected, once candidates are selected, a preview
is always generated if it does not exist already, else if a preview
already exist, it will be generated using one of three values for the
<code>overwrite</code> option:</p>
<ul>
<li><code>always</code> : preview is always generated, even if it
already exists and is newer than original</li>
<li><code>never</code> : preview is generated only if it does not exist
already</li>
<li><code>mtime</code> : preview is generated only if the original file
is newer than the existing</li>
</ul>
<p>Deletion of preview for deleted source files: not implemented yet
(TODO).</p>
<p>If the <code>scan</code> or <code>events</code> detection method is
used, then the option : <code>skip_folders</code> can be used to skip
some folders. It expects a list of path relative to the storage root
(docroot) starting with slash, use the <code>@json:</code> notation,
example:</p>
<div class="sourceCode" id="cb436"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> preview scan <span class="at">--skip-folders</span><span class="op">=</span>@json:<span class="st">&#39;[&quot;/not_here&quot;]&#39;</span></span></code></pre></div>
<p>The option <code>folder_reset_cache</code> forces the node service to
refresh folder contents using various methods.</p>
<p>When scanning the option <code>query</code> has the same behavior as
for the <code>node access_keys do self find</code> command.</p>
<p>Refer to that section for details.</p>
<h2 data-number="16.8" id="preview-file-types"><span
class="header-section-number">16.8</span> Preview File types</h2>
<p>Two types of preview can be generated:</p>
<ul>
<li><code>png</code>: thumbnail</li>
<li><code>mp4</code>: video preview (only for video)</li>
</ul>
<p>Use option <code>skip_format</code> to skip generation of a
format.</p>
<h2 data-number="16.9" id="supported-input-files-types"><span
class="header-section-number">16.9</span> Supported input Files
types</h2>
<p>The preview generator supports rendering of those file
categories:</p>
<ul>
<li>image</li>
<li>pdf</li>
<li>plaintext</li>
<li>office</li>
<li>video</li>
</ul>
<p>To avoid generation for some categories, specify a list using option
<code>skip_types</code>.</p>
<p>Each category has a specific rendering method to produce the png
thumbnail.</p>
<p>The mp4 video preview file is only for category
<code>video</code></p>
<p>File type is primarily based on file extension detected by the node
API and translated info a mime type returned by the node API.</p>
<h2 data-number="16.10" id="mimemagic"><span
class="header-section-number">16.10</span> mimemagic</h2>
<p>By default, the Mime type used for conversion is the one returned by
the node API, based on file name extension.</p>
<p>It is also possible to detect the mime type using option
<code>mimemagic</code>. To use it, set option <code>mimemagic</code> to
<code>yes</code>: <code>--mimemagic=yes</code>.</p>
<p>This requires to manually install the mimemagic gem:
<code>gem install mimemagic</code>.</p>
<p>In this case the <code>preview</code> command will first analyze the
file content using mimemagic, and if no match, will try by
extension.</p>
<p>If the <code>mimemagic</code> gem complains about missing mime info
file:</p>
<ul>
<li><p>any OS:</p>
<ul>
<li>Examine the error message</li>
<li>Download the file: <a
href="https://gitlab.freedesktop.org/xdg/shared-mime-info/-/raw/master/data/freedesktop.org.xml.in">freedesktop.org.xml.in</a></li>
<li>move and rename this file to one of the locations expected by
mimemagic as specified in the error message</li>
</ul></li>
<li><p>Windows:</p>
<ul>
<li>Download the file: <a
href="https://gitlab.freedesktop.org/xdg/shared-mime-info/-/raw/master/data/freedesktop.org.xml.in">freedesktop.org.xml.in</a></li>
<li>Place this file in the root of Ruby (or elsewhere):
<code>C:\RubyVV-x64\freedesktop.org.xml.in</code></li>
<li>Set a global variable using
<code>SystemPropertiesAdvanced.exe</code> or using <code>cmd</code>
(replace <code>VV</code> with version) to the exact path of this
file:</li>
</ul>
<div class="sourceCode" id="cb437"><pre
class="sourceCode cmd"><code class="sourceCode dosbat"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>SETX FREEDESKTOP_MIME_TYPES_PATH C:\RubyVV-x64\freedesktop.org.xml.in</span></code></pre></div>
<ul>
<li>Close the <code>cmd</code> and restart a new one if needed to get
refreshed env vars</li>
</ul></li>
<li><p>Linux RHEL 8+:</p></li>
</ul>
<div class="sourceCode" id="cb438"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dnf</span> install shared-mime-info</span></code></pre></div>
<ul>
<li>macOS:</li>
</ul>
<div class="sourceCode" id="cb439"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="ex">brew</span> install shared-mime-info</span></code></pre></div>
<h2 data-number="16.11"
id="generation-read-source-files-and-write-preview"><span
class="header-section-number">16.11</span> Generation: Read source files
and write preview</h2>
<p>Standard open source tools are used to create thumbnails and video
previews. Those tools require that original files are accessible in the
local file system and also write generated files on the local file
system. <code>ascli</code> provides 2 ways to read and write files with
the option: <code>file_access</code></p>
<p>If the preview generator is run on a system that has direct access to
the file system, then the value <code>local</code> can be used. In this
case, no transfer happen, source files are directly read from the
storage, and preview files are directly written to the storage.</p>
<p>If the preview generator does not have access to files on the file
system (it is remote, no mount, or is an object storage), then the
original file is first downloaded, then the result is uploaded, use
method <code>remote</code>.</p>
<h2 data-number="16.12" id="preview-sample-commands"><span
class="header-section-number">16.12</span> Preview sample commands</h2>
<div class="sourceCode" id="cb440"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> check <span class="at">--skip-types</span><span class="op">=</span>office</span>
<span id="cb440-2"><a href="#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> scan <span class="at">--scan-id</span><span class="op">=</span>1 <span class="at">--skip-types</span><span class="op">=</span>office <span class="at">--log-level</span><span class="op">=</span>info <span class="at">--file-access</span><span class="op">=</span>remote <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;target_rate_kbps&quot;:1000000}&#39;</span></span>
<span id="cb440-3"><a href="#cb440-3" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> scan <span class="at">--skip-types</span><span class="op">=</span>office <span class="at">--log-level</span><span class="op">=</span>info</span>
<span id="cb440-4"><a href="#cb440-4" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test mp4 my_file_mxf <span class="at">--video-conversion</span><span class="op">=</span>blend <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-5"><a href="#cb440-5" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test mp4 my_file_mxf <span class="at">--video-conversion</span><span class="op">=</span>clips <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-6"><a href="#cb440-6" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test mp4 my_file_mxf <span class="at">--video-conversion</span><span class="op">=</span>reencode <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-7"><a href="#cb440-7" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test png my_file_dcm <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-8"><a href="#cb440-8" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test png my_file_docx <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-9"><a href="#cb440-9" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test png my_file_mxf <span class="at">--video-png-conv</span><span class="op">=</span>animated <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-10"><a href="#cb440-10" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test png my_file_mxf <span class="at">--video-png-conv</span><span class="op">=</span>fixed <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-11"><a href="#cb440-11" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> test <span class="at">--case</span><span class="op">=</span>test png my_file_pdf <span class="at">--log-level</span><span class="op">=</span>debug</span>
<span id="cb440-12"><a href="#cb440-12" aria-hidden="true" tabindex="-1"></a><span class="ex">preview</span> trevents <span class="at">--once-only</span><span class="op">=</span>yes <span class="at">--skip-types</span><span class="op">=</span>office <span class="at">--log-level</span><span class="op">=</span>info</span></code></pre></div>
<h1 data-number="17" id="smtp-for-email-notifications"><span
class="header-section-number">17</span> SMTP for email
notifications</h1>
<p><code>ascli</code> can send email, for that setup SMTP configuration.
This is done with option <code>smtp</code>.</p>
<p>The <code>smtp</code> option is a Hash (extended value) with the
following fields:</p>
<!-- markdownlint-disable MD034 -->
<table style="width:100%;">
<colgroup>
<col style="width: 14%" />
<col style="width: 21%" />
<col style="width: 28%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="header">
<th>field</th>
<th>default</th>
<th>example</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>server</code></td>
<td>-</td>
<td>smtp.gmail.com</td>
<td>SMTP server address</td>
</tr>
<tr class="even">
<td><code>tls</code></td>
<td>true</td>
<td>true</td>
<td>enable STARTTLS (port 587)</td>
</tr>
<tr class="odd">
<td><code>ssl</code></td>
<td>false</td>
<td>false</td>
<td>enable TLS (port 465)</td>
</tr>
<tr class="even">
<td><code>port</code></td>
<td>587 or 465 or 25</td>
<td>587</td>
<td>port for service</td>
</tr>
<tr class="odd">
<td><code>domain</code></td>
<td>domain of server</td>
<td>gmail.com</td>
<td>email domain of user</td>
</tr>
<tr class="even">
<td><code>username</code></td>
<td>-</td>
<td>john@example.com</td>
<td>user to authenticate on SMTP server, leave empty for open auth.</td>
</tr>
<tr class="odd">
<td><code>password</code></td>
<td>-</td>
<td>my_password_here</td>
<td>password for above username</td>
</tr>
<tr class="even">
<td><code>from_email</code></td>
<td>username if defined</td>
<td>johnny@example.com</td>
<td>address used if receiver replies</td>
</tr>
<tr class="odd">
<td><code>from_name</code></td>
<td>same as email</td>
<td>John Wayne</td>
<td>display name of sender</td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD034 -->
<h2 data-number="17.1" id="example-of-configuration"><span
class="header-section-number">17.1</span> Example of configuration</h2>
<div class="sourceCode" id="cb441"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set smtp_google server smtp.google.com</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set smtp_google username john@gmail.com</span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set smtp_google password my_password_here</span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb442"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset init smtp_google @json:<span class="st">&#39;{&quot;server&quot;:&quot;smtp.google.com&quot;,&quot;username&quot;:&quot;john@gmail.com&quot;,&quot;password&quot;:&quot;my_password_here&quot;}&#39;</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb443"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset update smtp_google <span class="at">--server</span><span class="op">=</span>smtp.google.com <span class="at">--username</span><span class="op">=</span>john@gmail.com <span class="at">--password</span><span class="op">=</span>my_password_here</span></code></pre></div>
<p>Set this configuration as global default, for instance:</p>
<div class="sourceCode" id="cb444"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set cli_default smtp @val:@preset:smtp_google</span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config preset set default config cli_default</span></code></pre></div>
<h2 data-number="17.2" id="email-templates"><span
class="header-section-number">17.2</span> Email templates</h2>
<p>Sent emails are built using a template that uses the <a
href="https://www.tutorialspoint.com/ruby/eruby.htm">ERB</a> syntax.</p>
<p>The template is the full SMTP message, including headers.</p>
<p>The following variables are defined by default:</p>
<ul>
<li><code>from_name</code></li>
<li><code>from_email</code></li>
<li><code>to</code></li>
</ul>
<p>Other variables are defined depending on context.</p>
<h2 data-number="17.3" id="test"><span
class="header-section-number">17.3</span> Test</h2>
<p>Check settings with <code>smtp_settings</code> command. Send test
email with <code>email_test</code>.</p>
<div class="sourceCode" id="cb445"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config <span class="at">--smtp</span><span class="op">=</span>@preset:smtp_google smtp</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> config <span class="at">--smtp</span><span class="op">=</span>@preset:smtp_google email <span class="at">--notif-to</span><span class="op">=</span>sample.dest@example.com</span></code></pre></div>
<h2 data-number="17.4" id="notifications-for-transfer-status"><span
class="header-section-number">17.4</span> Notifications for transfer
status</h2>
<p>An e-mail notification can be sent upon transfer success and failure
(one email per transfer job, one job being possibly multi session, and
possibly after retry).</p>
<p>To activate, use option <code>notif_to</code>.</p>
<p>A default e-mail template is used, but it can be overridden with
option <code>notif_template</code>.</p>
<p>The environment provided contains the following additional
variables:</p>
<ul>
<li>subject</li>
<li>body</li>
<li>global_transfer_status</li>
<li>ts</li>
</ul>
<p>Example of template:</p>
<pre class="text"><code>From: &lt;%=from_name%&gt; &lt;&lt;%=from_email%&gt;&gt;
To: &lt;&lt;%=to%&gt;&gt;
Subject: &lt;%=subject%&gt;

Transfer is: &lt;%=global_transfer_status%&gt;</code></pre>
<h1 data-number="18" id="tool-asession"><span
class="header-section-number">18</span> Tool: <code>asession</code></h1>
<p>This gem comes with a second executable tool providing a simplified
standardized interface to start a FASP session:
<code>asession</code>.</p>
<p>It aims at simplifying the startup of a FASP session from a
programmatic stand point as formatting a <a
href="#transferspec"><em>transfer-spec</em></a> is:</p>
<ul>
<li>common to Aspera Node API (HTTP POST /ops/transfer)</li>
<li>common to Aspera Connect API (browser javascript startTransfer)</li>
<li>easy to generate by using any third party language specific JSON
library</li>
</ul>
<p>Hopefully, IBM integrates this directly in <code>ascp</code>, and
this tool is made redundant.</p>
<p>This makes it easy to integrate with any language provided that one
can spawn a sub process, write to its STDIN, read from STDOUT, generate
and parse JSON.</p>
<p><code>ascli</code> expect one single argument: a <a
href="#transferspec"><em>transfer-spec</em></a>.</p>
<p>If no argument is provided, it assumes a value of:
<code>@json:@stdin:</code>, i.e. a JSON formatted <a
href="#transferspec"><em>transfer-spec</em></a> on stdin.</p>
<blockquote>
<p><strong>Note:</strong> If JSON is the format, specify
<code>@json:</code> to tell <code>ascli</code> to decode the Hash using
JSON syntax.</p>
</blockquote>
<p>During execution, it generates all low level events, one per line, in
JSON format on stdout.</p>
<p>There are special “extended” <a
href="#transferspec"><em>transfer-spec</em></a> parameters supported by
<code>asession</code>:</p>
<ul>
<li><code>EX_loglevel</code> to change log level of
<code>ascli</code></li>
<li><code>EX_file_list_folder</code> to set the folder used to store
(exclusively, because of garbage collection) generated file lists. By
default it is
<code>[system tmp folder]/[username]_asession_filelists</code></li>
</ul>
<blockquote>
<p><strong>Note:</strong> In addition, many “EX_” <a
href="#transferspec"><em>transfer-spec</em></a> parameters are supported
for the <a href="#agt_direct"><code>direct</code></a> transfer agent
(used by <code>asession</code>), refer to section <a
href="#transferspec"><em>transfer-spec</em></a>.</p>
</blockquote>
<h2 data-number="18.1" id="comparison-of-interfaces"><span
class="header-section-number">18.1</span> Comparison of interfaces</h2>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 16%" />
<col style="width: 13%" />
<col style="width: 22%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="header">
<th>feature/tool</th>
<th>asession</th>
<th><code>ascp</code></th>
<th>FaspManager</th>
<th>Transfer SDK</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>language integration</td>
<td>any</td>
<td>any</td>
<td>C/C++<br/>C#/.net<br/>Go<br/>Python<br/>java<br/></td>
<td>many</td>
</tr>
<tr class="even">
<td>required additional components to <code>ascp</code></td>
<td>Ruby<br/>Aspera</td>
<td>-</td>
<td>library<br/>(headers)</td>
<td>daemon</td>
</tr>
<tr class="odd">
<td>startup</td>
<td>JSON on stdin<br/>(standard
APIs:<br/>JSON.generate<br/>Process.spawn)</td>
<td>command line arguments</td>
<td>API</td>
<td>daemon</td>
</tr>
<tr class="even">
<td>events</td>
<td>JSON on stdout</td>
<td>none by default<br/>or need to open management port<br/>and
proprietary text syntax</td>
<td>callback</td>
<td>callback</td>
</tr>
<tr class="odd">
<td>platforms</td>
<td>any with Ruby and <code>ascp</code></td>
<td>any with <code>ascp</code> (and SDK if compiled)</td>
<td>any with <code>ascp</code></td>
<td>any with <code>ascp</code> and transfer daemon</td>
</tr>
</tbody>
</table>
<h2 data-number="18.2" id="simple-session"><span
class="header-section-number">18.2</span> Simple session</h2>
<p>Create a file <code>session.json</code> with:</p>
<div class="sourceCode" id="cb447"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;remote_host&quot;</span><span class="fu">:</span><span class="st">&quot;demo.asperasoft.com&quot;</span><span class="fu">,</span><span class="dt">&quot;remote_user&quot;</span><span class="fu">:</span><span class="st">&quot;asperaweb&quot;</span><span class="fu">,</span><span class="dt">&quot;ssh_port&quot;</span><span class="fu">:</span><span class="dv">33001</span><span class="fu">,</span><span class="dt">&quot;remote_password&quot;</span><span class="fu">:</span><span class="st">&quot;my_password_here&quot;</span><span class="fu">,</span><span class="dt">&quot;direction&quot;</span><span class="fu">:</span><span class="st">&quot;receive&quot;</span><span class="fu">,</span><span class="dt">&quot;destination_root&quot;</span><span class="fu">:</span><span class="st">&quot;./test.dir&quot;</span><span class="fu">,</span><span class="dt">&quot;paths&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;source&quot;</span><span class="fu">:</span><span class="st">&quot;/aspera-test-dir-tiny/200KB.1&quot;</span><span class="fu">}</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;resume_level&quot;</span><span class="fu">:</span><span class="st">&quot;none&quot;</span><span class="fu">}</span></span></code></pre></div>
<p>Then start the session:</p>
<div class="sourceCode" id="cb448"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="ex">asession</span> <span class="op">&lt;</span> session.json</span></code></pre></div>
<h2 data-number="18.3"
id="asynchronous-commands-and-persistent-session"><span
class="header-section-number">18.3</span> Asynchronous commands and
Persistent session</h2>
<p><code>asession</code> also supports asynchronous commands (on the
management port). Instead of the traditional text protocol as described
in <code>ascp</code> manual, the format for commands is: one single line
per command, formatted in JSON, where parameters shall be “snake” style,
for example: <code>LongParameter</code> -&gt;
<code>long_parameter</code></p>
<p>This is particularly useful for a persistent session ( with the <a
href="#transferspec"><em>transfer-spec</em></a> parameter:
<code>"keepalive":true</code> )</p>
<div class="sourceCode" id="cb449"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="er">asession</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;remote_host&quot;</span><span class="fu">:</span><span class="st">&quot;demo.asperasoft.com&quot;</span><span class="fu">,</span><span class="dt">&quot;ssh_port&quot;</span><span class="fu">:</span><span class="dv">33001</span><span class="fu">,</span><span class="dt">&quot;remote_user&quot;</span><span class="fu">:</span><span class="st">&quot;asperaweb&quot;</span><span class="fu">,</span><span class="dt">&quot;remote_password&quot;</span><span class="fu">:</span><span class="st">&quot;my_password_here&quot;</span><span class="fu">,</span><span class="dt">&quot;direction&quot;</span><span class="fu">:</span><span class="st">&quot;receive&quot;</span><span class="fu">,</span><span class="dt">&quot;destination_root&quot;</span><span class="fu">:</span><span class="st">&quot;.&quot;</span><span class="fu">,</span><span class="dt">&quot;keepalive&quot;</span><span class="fu">:</span><span class="kw">true</span><span class="fu">,</span><span class="dt">&quot;resume_level&quot;</span><span class="fu">:</span><span class="st">&quot;none&quot;</span><span class="fu">}</span></span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;START&quot;</span><span class="fu">,</span><span class="dt">&quot;source&quot;</span><span class="fu">:</span><span class="st">&quot;/aspera-test-dir-tiny/200KB.2&quot;</span><span class="fu">}</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;DONE&quot;</span><span class="fu">}</span></span></code></pre></div>
<p>(events from FASP are not shown in above example. They would appear
after each command)</p>
<h2 data-number="18.4" id="example-of-language-wrapper"><span
class="header-section-number">18.4</span> Example of language
wrapper</h2>
<p>Nodejs: <a
href="https://www.npmjs.com/package/aspera">https://www.npmjs.com/package/aspera</a></p>
<h2 data-number="18.5" id="help"><span
class="header-section-number">18.5</span> Help</h2>
<div class="sourceCode" id="cb450"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="ex">asession</span> <span class="at">-h</span></span>
<span id="cb450-2"><a href="#cb450-2" aria-hidden="true" tabindex="-1"></a><span class="ex">USAGE</span></span>
<span id="cb450-3"><a href="#cb450-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">asession</span></span>
<span id="cb450-4"><a href="#cb450-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">asession</span> <span class="at">-h</span><span class="kw">|</span><span class="ex">--help</span></span>
<span id="cb450-5"><a href="#cb450-5" aria-hidden="true" tabindex="-1"></a>    <span class="ex">asession</span> <span class="op">&lt;</span>transfer spec extended value<span class="op">&gt;</span></span>
<span id="cb450-6"><a href="#cb450-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb450-7"><a href="#cb450-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">If</span> no argument is provided, default will be used: @json:@stdin</span>
<span id="cb450-8"><a href="#cb450-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">-h,</span> <span class="at">--help</span> display this message</span>
<span id="cb450-9"><a href="#cb450-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;</span>transfer <span class="ex">spec</span> extended value<span class="op">&gt;</span> a JSON value for transfer_spec, using the prefix: @json:</span>
<span id="cb450-10"><a href="#cb450-10" aria-hidden="true" tabindex="-1"></a>    <span class="ex">The</span> value can be either:</span>
<span id="cb450-11"><a href="#cb450-11" aria-hidden="true" tabindex="-1"></a>       <span class="ex">the</span> JSON description itself, e.g. @json:<span class="st">&#39;{&quot;xx&quot;:&quot;yy&quot;,...}&#39;</span></span>
<span id="cb450-12"><a href="#cb450-12" aria-hidden="true" tabindex="-1"></a>       <span class="ex">@json:@stdin,</span> if the JSON is provided from stdin</span>
<span id="cb450-13"><a href="#cb450-13" aria-hidden="true" tabindex="-1"></a>       <span class="ex">@json:@file:</span><span class="op">&lt;</span>path<span class="op">&gt;</span>, if the JSON is provided from a file</span>
<span id="cb450-14"><a href="#cb450-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Asynchronous</span> commands can be provided on STDIN, examples:</span>
<span id="cb450-15"><a href="#cb450-15" aria-hidden="true" tabindex="-1"></a>       <span class="dt">{</span><span class="st">&quot;type&quot;</span><span class="dt">:</span><span class="st">&quot;START&quot;</span><span class="op">,</span><span class="st">&quot;source&quot;</span><span class="dt">:</span><span class="st">&quot;/aspera-test-dir-tiny/200KB.2&quot;</span><span class="dt">}</span></span>
<span id="cb450-16"><a href="#cb450-16" aria-hidden="true" tabindex="-1"></a>       <span class="dt">{</span><span class="st">&quot;type&quot;</span><span class="dt">:</span><span class="st">&quot;START&quot;</span><span class="op">,</span><span class="st">&quot;source&quot;</span><span class="dt">:</span><span class="st">&quot;xx&quot;</span><span class="op">,</span><span class="st">&quot;destination&quot;</span><span class="dt">:</span><span class="st">&quot;yy&quot;</span><span class="dt">}</span></span>
<span id="cb450-17"><a href="#cb450-17" aria-hidden="true" tabindex="-1"></a>       <span class="ex">{</span><span class="st">&quot;type&quot;</span><span class="ex">:</span><span class="st">&quot;DONE&quot;</span><span class="ex">}</span></span>
<span id="cb450-18"><a href="#cb450-18" aria-hidden="true" tabindex="-1"></a><span class="ex">Note:</span> debug information can be placed on STDERR, using the <span class="st">&quot;EX_loglevel&quot;</span> parameter in transfer spec <span class="er">(</span><span class="va">debug</span><span class="op">=</span>0<span class="kw">)</span></span>
<span id="cb450-19"><a href="#cb450-19" aria-hidden="true" tabindex="-1"></a><span class="ex">EXAMPLES</span></span>
<span id="cb450-20"><a href="#cb450-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">asession</span> @json:<span class="st">&#39;{&quot;remote_host&quot;:&quot;demo.asperasoft.com&quot;,&quot;remote_user&quot;:&quot;asperaweb&quot;,&quot;ssh_port&quot;:33001,&quot;remote_password&quot;:&quot;demoaspera&quot;,&quot;direction&quot;:&quot;receive&quot;,&quot;destination_root&quot;:&quot;./test.dir&quot;,&quot;paths&quot;:[{&quot;source&quot;:&quot;/aspera-test-dir-tiny/200KB.1&quot;}]}&#39;</span></span>
<span id="cb450-21"><a href="#cb450-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">&#39;{&quot;remote_host&quot;:...}&#39;</span><span class="kw">|</span><span class="ex">asession</span> @json:@stdin</span></code></pre></div>
<h1 data-number="19" id="hot-folder"><span
class="header-section-number">19</span> Hot folder</h1>
<h2 data-number="19.1" id="requirements"><span
class="header-section-number">19.1</span> Requirements</h2>
<p><code>ascli</code> maybe used as a simple hot folder engine. A hot
folder being defined as a tool that:</p>
<ul>
<li>locally (or remotely) detects new files in a top folder</li>
<li>send detected files to a remote (respectively, local)
repository</li>
<li>only sends new files, do not re-send already sent files</li>
<li>optionally: sends only files that are not still “growing”</li>
<li>optionally: after transfer of files, deletes or moves to an
archive</li>
</ul>
<p>In addition: the detection should be made “continuously” or on
specific time/date.</p>
<h2 data-number="19.2" id="setup-procedure"><span
class="header-section-number">19.2</span> Setup procedure</h2>
<p>The general idea is to rely on :</p>
<ul>
<li>existing <code>ascp</code> features for detection and transfer</li>
<li>take advantage of <code>ascli</code> configuration capabilities and
server side knowledge</li>
<li>the OS scheduler for reliability and continuous operation</li>
</ul>
<h3 data-number="19.2.1" id="ascp-features"><span
class="header-section-number">19.2.1</span> <code>ascp</code>
features</h3>
<p>Interesting <code>ascp</code> features are found in its arguments:
(see <code>ascp</code> manual):</p>
<ul>
<li><code>ascp</code> already takes care of sending only
<strong>new</strong> files: option <code>-k 1,2,3</code>
(<code>resume_policy</code>)</li>
<li><code>ascp</code> has some options to remove or move files after
transfer: <code>--remove-after-transfer</code>,
<code>--move-after-transfer</code>,
<code>--remove-empty-directories</code>
(<code>remove_after_transfer</code>, <code>move_after_transfer</code>,
<code>remove_empty_directories</code>)</li>
<li><code>ascp</code> has an option to send only files not modified
since the last X seconds: <code>--exclude-newer-than</code>,
<code>--exclude-older-than</code>
(<code>exclude_newer_than</code>,<code>exclude_older_than</code>)</li>
<li><code>--src-base</code> (<code>src_base</code>) if top level folder
name shall not be created on destination</li>
</ul>
<blockquote>
<p><strong>Note:</strong> <code>ascli</code> takes transfer parameters
exclusively as a <a href="#transferspec"><em>transfer-spec</em></a>,
with <code>ts</code> option.</p>
<p><strong>Note:</strong> Most, but not all, native <code>ascp</code>
arguments are available as standard <a
href="#transferspec"><em>transfer-spec</em></a> parameters.</p>
<p><strong>Note:</strong> Only for the <a
href="#agt_direct"><code>direct</code></a> transfer agent (not others,
like connect or node), native <code>ascp</code> arguments can be
provided with parameter <code>ascp_args</code> of option
<code>transfer_info</code> .</p>
</blockquote>
<h3 data-number="19.2.2" id="server-side-and-configuration"><span
class="header-section-number">19.2.2</span> server side and
configuration</h3>
<p>Virtually any transfer on a “repository” on a regular basis might
emulate a hot folder.</p>
<blockquote>
<p><strong>Note:</strong> file detection is not based on events
(inotify, etc…), but on a simple folder scan on source side.</p>
<p><strong>Note:</strong> parameters may be saved in a <a
href="#lprt">option preset</a> and used with <code>-P</code>.</p>
</blockquote>
<h3 data-number="19.2.3" id="scheduling"><span
class="header-section-number">19.2.3</span> Scheduling</h3>
<p>Once <code>ascli</code> parameters are defined, run the command using
the OS native scheduler, e.g. every minutes, or 5 minutes, etc… Refer to
section <a href="#scheduler">Scheduler</a>. (on use of option
<code>lock_port</code>)</p>
<h2 data-number="19.3" id="example-upload-hot-folder"><span
class="header-section-number">19.3</span> Example: upload hot
folder</h2>
<div class="sourceCode" id="cb451"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload source_hot <span class="at">--to-folder</span><span class="op">=</span>/Upload/target_hot <span class="at">--lock-port</span><span class="op">=</span>12345 <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;remove_after_transfer&quot;:true,&quot;remove_empty_directories&quot;:true,&quot;exclude_newer_than:-8,&quot;src_base&quot;:&quot;source_hot&quot;}&#39;</span></span></code></pre></div>
<p>The local folder (here, relative path: <code>source_hot</code>) is
sent (upload) to an aspera server. Source files are deleted after
transfer. Growing files will be sent only once they don’t grow anymore
(based on an 8-second cool-off period). If a transfer takes more than
the execution period, then the subsequent execution is skipped
(<code>lock_port</code>) preventing multiple concurrent runs.</p>
<h2 data-number="19.4"
id="example-unidirectional-synchronization-upload-to-server"><span
class="header-section-number">19.4</span> Example: unidirectional
synchronization (upload) to server</h2>
<div class="sourceCode" id="cb452"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server upload source_sync <span class="at">--to-folder</span><span class="op">=</span>/Upload/target_sync <span class="at">--lock-port</span><span class="op">=</span>12345 <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;resume_policy&quot;:&quot;sparse_csum&quot;,&quot;exclude_newer_than&quot;:-8,&quot;src_base&quot;:&quot;source_sync&quot;}&#39;</span></span></code></pre></div>
<p>This can also be used with other folder-based applications: Aspera on
Cloud, Shares, Node:</p>
<h2 data-number="19.5"
id="example-unidirectional-synchronization-download-from-aspera-on-cloud-files"><span
class="header-section-number">19.5</span> Example: unidirectional
synchronization (download) from Aspera on Cloud Files</h2>
<div class="sourceCode" id="cb453"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> aoc files download . <span class="at">--to-folder</span><span class="op">=</span>. <span class="at">--lock-port</span><span class="op">=</span>12345 <span class="at">--progress</span><span class="op">=</span>none <span class="at">--display</span><span class="op">=</span>data <span class="at">--ts</span><span class="op">=</span>@json:<span class="st">&#39;{&quot;resume_policy&quot;:&quot;sparse_csum&quot;,&quot;target_rate_kbps&quot;:50000,&quot;exclude_newer_than&quot;:-8,&quot;delete_before_transfer&quot;:true}&#39;</span></span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> option <code>delete_before_transfer</code>
will delete files locally, if they are not present on remote side.</p>
<p><strong>Note:</strong> options <code>progress</code> and
<code>display</code> limit output for headless operation (e.g. cron
job)</p>
</blockquote>
<h1 data-number="20" id="health-check-and-nagios"><span
class="header-section-number">20</span> Health check and Nagios</h1>
<p>Most plugin provide a <code>health</code> command that will check the
health status of the application. Example:</p>
<div class="sourceCode" id="cb454"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> console health</span></code></pre></div>
<pre class="output"><code>+--------+-------------+------------+
| status | component   | message    |
+--------+-------------+------------+
| ok     | console api | accessible |
+--------+-------------+------------+</code></pre>
<p>Typically, the health check uses the REST API of the application with
the following exception: the <code>server</code> plugin allows checking
health by:</p>
<ul>
<li>issuing a transfer to the server</li>
<li>checking web app status with <code>asctl all:status</code></li>
<li>checking daemons process status</li>
</ul>
<p><code>ascli</code> can be called by Nagios to check the health status
of an Aspera server. The output can be made compatible to Nagios with
option <code>--format=nagios</code> :</p>
<div class="sourceCode" id="cb456"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server health transfer <span class="at">--to-folder</span><span class="op">=</span>/Upload <span class="at">--format</span><span class="op">=</span>nagios <span class="at">--progress</span><span class="op">=</span>none</span></code></pre></div>
<pre class="output"><code>OK - [transfer:ok]</code></pre>
<div class="sourceCode" id="cb458"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> server health asctl status <span class="at">--cmd_prefix</span><span class="op">=</span><span class="st">&#39;sudo &#39;</span> <span class="at">--format</span><span class="op">=</span>nagios</span></code></pre></div>
<pre class="output"><code>OK - [NP:running, MySQL:running, Mongrels:running, Background:running, DS:running, DB:running, Email:running, Apache:running]</code></pre>
<h1 data-number="21" id="ruby-module-aspera"><span
class="header-section-number">21</span> Ruby Module:
<code>Aspera</code></h1>
<p>Main components:</p>
<ul>
<li><code>Aspera</code> generic classes for REST and OAuth</li>
<li><code>Aspera::Fasp</code>: starting and monitoring transfers. It can
be considered as a FASPManager class for Ruby.</li>
<li><code>Aspera::Cli</code>: <code>ascli</code>.</li>
</ul>
<p>Working examples can be found in repo: <a
href="https://github.com/laurent-martin/aspera-api-examples"
class="uri">https://github.com/laurent-martin/aspera-api-examples</a> in
Ruby examples.</p>
<h1 data-number="22" id="changes-release-notes"><span
class="header-section-number">22</span> Changes (Release notes)</h1>
<p>See <a href="CHANGELOG.md">CHANGELOG.md</a></p>
<h1 data-number="23" id="history"><span
class="header-section-number">23</span> History</h1>
<p>When I joined Aspera, there was only one CLI: <code>ascp</code>,
which is the implementation of the FASP protocol, but there was no CLI
to access the various existing products (Server, Faspex, Shares). Once,
Serban (founder) provided a shell script able to create a Faspex Package
using Faspex REST API. Since all products relate to file transfers using
FASP (<code>ascp</code>), I thought it would be interesting to have a
unified CLI for transfers using FASP. Also, because there was already
the <code>ascp</code> tool, I thought of an extended tool :
<code>eascp.pl</code> which was accepting all <code>ascp</code> options
for transfer but was also able to transfer to Faspex and Shares
(destination was a kind of URI for the applications).</p>
<p>There were a few pitfalls:</p>
<ul>
<li><code>ascli</code> was written in the aging <code>perl</code>
language while most Aspera web application products (but the Transfer
Server) are written in <code>ruby</code>.</li>
<li><code>ascli</code> was only for transfers, but not able to call
other products APIs</li>
</ul>
<p>So, it evolved into <code>ascli</code>:</p>
<ul>
<li>portable: works on platforms supporting <code>ruby</code> (and
<code>ascp</code>)</li>
<li>easy to install with the <code>gem</code> utility</li>
<li>supports transfers with multiple <a href="#agents">Transfer
Agents</a>, that's why transfer parameters moved from <code>ascp</code>
command line to <a href="#transferspec"><em>transfer-spec</em></a> (more
reliable , more standard)</li>
<li><code>ruby</code> is consistent with other Aspera products</li>
</ul>
<p>Over the time, a supported command line tool <code>aspera</code> was
developed in C++, it was later on deprecated. It had the advantage of
being relatively easy to installed, as a single executable (well, still
using <code>ascp</code>), but it was too limited IMHO, and lacked a lot
of the features of this CLI.</p>
<p>Enjoy a coffee on me:</p>
<div class="sourceCode" id="cb460"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf coffee</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="ex">ascli</span> conf coffee <span class="at">--ui</span><span class="op">=</span>text</span></code></pre></div>
<h1 data-number="24" id="common-problems"><span
class="header-section-number">24</span> Common problems</h1>
<h2 data-number="24.1"
id="error-remote-host-is-not-who-we-expected"><span
class="header-section-number">24.1</span> Error: “Remote host is not who
we expected”</h2>
<p>Cause: <code>ascp</code> &gt;= 4.x checks fingerprint of highest
server host key, including ECDSA. <code>ascp</code> &lt; 4.0 (3.9.6 and
earlier) support only to RSA level (and ignore ECDSA presented by
server). <code>aspera.conf</code> supports a single fingerprint.</p>
<p>Workaround on client side: To ignore the certificate (SSH
fingerprint) add option on client side (this option can also be added
permanently to the config file):</p>
<div class="sourceCode" id="cb461"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="ex">--ts=@json:</span><span class="st">&#39;{&quot;sshfp&quot;:null}&#39;</span></span></code></pre></div>
<p>Workaround on server side: Either remove the fingerprint from
<code>aspera.conf</code>, or keep only RSA host keys in
<code>sshd_config</code>.</p>
<p>References: ES-1944 in release notes of 4.1 and to <a
href="https://www.ibm.com/docs/en/ahts/4.2?topic=upgrades-configuring-ssh-server">HSTS
admin manual section “Configuring Transfer Server Authentication With a
Host-Key Fingerprint”</a>.</p>
<h2 data-number="24.2" id="error-cant-find-header-files-for-ruby"><span
class="header-section-number">24.2</span> Error “can’t find header files
for ruby”</h2>
<p>Some Ruby gems dependencies require compilation of native parts (C).
This also requires Ruby header files. If Ruby was installed as a Linux
Packages, then also install Ruby development package:
<code>ruby-dev</code> ir <code>ruby-devel</code>, depending on
distribution.</p>
<h2 data-number="24.3" id="ed255519-key-not-supported"><span
class="header-section-number">24.3</span> ED255519 key not
supported</h2>
<p>ED25519 keys are deactivated since version 0.9.24 so this type of key
will just be ignored.</p>
<p>Without this deactivation, if such key was present the following
error was generated:</p>
<pre class="output"><code>OpenSSH keys only supported if ED25519 is available</code></pre>
<p>Which meant that you do not have Ruby support for ED25519 SSH keys.
You may either install the suggested Gems, or remove your ed25519 key
from your <code>.ssh</code> folder to solve the issue.</p>
